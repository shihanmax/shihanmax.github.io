---
title:  "XGBoostç†è§£"
layout: post
date: 2021-03-28 12:52:03
categories: NLP
tags:  ["Machine Learning", "Boosting"]
syntaxHighlighter: yes
Mathjax: true
---

XGBoostï¼ˆeXtreme Gradient Boostingï¼‰æ˜¯GBDTçš„ä¸€ç§é«˜æ•ˆçš„å·¥ç¨‹å®ç°ï¼Œåœ¨æ•°æ®ç«èµ›ä¸­åº”ç”¨ååˆ†å¹¿æ³›ã€‚

ä¸‹æ–‡ä»å†³ç­–æ ‘çš„å®šä¹‰å¼€å§‹ï¼Œä»‹ç»å†³ç­–æ ‘çš„åˆ†è£‚æŒ‡æ ‡ã€å†³ç­–æ ‘åœ¨boostingç®—æ³•ä¸­çš„åº”ç”¨BDTã€å¼•å…¥æ®‹å·®ä¿¡æ¯çš„Gradient boostingç®—æ³•ç­‰ï¼Œæœ€åï¼Œä»‹ç»é›†æˆäº†å¤šç§é«˜æ•ˆç®—æ³•çš„XGBoostçš„å·¥ç¨‹å®ç°ã€‚

## ä¸€ã€å†³ç­–æ ‘

å†³ç­–æ ‘æ˜¯ä¸€ç§æè¿°å¯¹å®ä¾‹è¿›è¡Œåˆ†ç±»çš„å±æ€§ç»“æ„ï¼Œç”±èŠ‚ç‚¹å’Œæœ‰å‘è¾¹ç»„æˆï¼Œå…¶ä¸­ï¼ŒèŠ‚ç‚¹åˆ†ä¸ºå†…éƒ¨èŠ‚ç‚¹å’Œå¶å­ç»“ç‚¹ï¼Œå†…éƒ¨èŠ‚ç‚¹è¡¨ç¤ºç‰¹å¾æˆ–å±æ€§ï¼Œå¶å­ç»“ç‚¹è¡¨ç¤ºä¸€ä¸ªç±»ã€‚

ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œå¯¹æ ·æœ¬çš„æŸä¸€ä¸ªç‰¹å¾è¿›è¡Œæµ‹è¯•ï¼Œæ ¹æ®ç»“æœï¼Œå°†æ ·æœ¬åˆ’åˆ†åˆ°å…¶è‹¥å¹²ä¸ªå­èŠ‚ç‚¹ä¸­ï¼Œå…¶ä¸­æ¯ä¸ªå­èŠ‚ç‚¹å‡å¯¹åº”è¯¥ç‰¹å¾çš„ä¸€ä¸ªå–å€¼ï¼›é’ˆå¯¹æ¯ä¸€ä¸ªå­èŠ‚ç‚¹ï¼Œç»§ç»­é€‰å–ä¸€ä¸ªç‰¹å¾é‡å¤æ‰§è¡Œä¸Šè¿°è¿‡ç¨‹ï¼Œç›´åˆ°å°†å®ä¾‹åˆ’åˆ†åˆ°å¶èŠ‚ç‚¹æ‰€å¯¹åº”çš„ç±»åˆ«å½“ä¸­ã€‚

åœ¨ä¸Šè¿°æè¿°è¿‡ç¨‹ä¸­ï¼Œæœ‰ä¸€ä¸ªé‡è¦çš„ç‚¹æ˜¯ï¼Œå¦‚ä½•é€‰æ‹©ä¸€ä¸ªæœ€å¥½çš„ç‰¹å¾ï¼Œå¹¶ä½¿ç”¨å…¶è¿›è¡Œæ ·æœ¬çš„åˆ’åˆ†ï¼Ÿ

ç›´è§‚ä¸Šè€ƒè™‘ï¼Œå¦‚æœåˆ’åˆ†åçš„å­é›†æ‹¥æœ‰æ›´é«˜çš„â€œçº¯åº¦â€ï¼Œåˆ™è¡¨ç¤ºè¯¥ç‰¹å¾æ˜¯ä¸€ä¸ªå¥½çš„ç‰¹å¾ã€‚æ‰€è°“çº¯åº¦æ˜¯æŒ‡ï¼Œåˆ’åˆ†åçš„å­æ ·æœ¬é›†åˆæ‰€å¯¹åº”çš„ç±»åˆ«åº”å°½å¯èƒ½ä¸€è‡´ï¼Œæç«¯è€ƒè™‘ï¼Œå‡è®¾æˆ‘ä»¬é€‰æ‹©äº†ä¸€ä¸ªç‰¹å¾ï¼Œåœ¨ä½¿ç”¨æ­¤ç‰¹å¾è¿›è¡Œåˆ’åˆ†åï¼Œæ‰€æœ‰çš„å­é›†åˆä¸­ï¼Œæ ·æœ¬çš„ç±»åˆ«å‡ ä¹ä¸€è‡´ï¼Œåˆ™å¯ä»¥è®¤ä¸ºè¿™ä¸ªç‰¹å¾æ˜¯ä¸€ä¸ªéå¸¸å¼ºçš„ç‰¹å¾ã€‚

åœ¨å†³ç­–æ ‘å®ç°è¿‡ç¨‹ä¸­ï¼Œä¸€èˆ¬ä½¿ç”¨ä¸‰ä¸ªæŒ‡æ ‡è¡¡é‡åˆ†ç±»çº¯åº¦ï¼šä¿¡æ¯å¢ç›Šã€ä¿¡æ¯å¢ç›Šæ¯”ã€åŸºå°¼æŒ‡æ•°ã€‚é¦–å…ˆå›é¡¾ä¸€ä¸‹ä¿¡æ¯è®ºä¸­å‡ ä¸ªåŸºç¡€çš„æ¦‚å¿µï¼š

**ç†µï¼ˆEntropyï¼‰**

è®¾$X$æ˜¯éšæœºå˜é‡ï¼Œ$P(X=x_i)=p_i,i=1,2,...,n$ï¼Œåˆ™$X$çš„ç†µå®šä¹‰ä¸ºï¼š

$$H(X)=-\sum_\limits{i=1}^{n}{p_i}\log{p_i}$$

å¯ä»¥çœ‹å‡ºï¼Œ$X$çš„ç†µçš„å–å€¼ä»…ä¸$X$çš„åˆ†å¸ƒæœ‰å…³ï¼Œä¸$X$çš„å–å€¼æ— å…³ï¼Œæ‰€ä»¥è¿™é‡Œ$H(X)$ä¹Ÿå¯ä»¥å†™ä½œ$H(p)$ã€‚ä¸Šå¼ä¸­çš„å¯¹æ•°ä»¥$2$ä¸ºåº•æ—¶ï¼Œç†µçš„å•ä½ä¸º$bit$ï¼›ä»¥$e$ä¸ºåº•æ—¶å¯¹åº”çš„å•ä½ä¸º$nat$ã€‚

ç†µå¯ä»¥ç”¨æ¥è¡¡é‡éšæœºå˜é‡çš„ä¸ç¡®å®šæ€§ã€‚

 

**æ¡ä»¶ç†µ**

æ¡ä»¶ç†µ$H(Y\mid X)=\sum_\limits{i=1}^{n}{p_i}H(Y\mid X=x_i)$ï¼Œå…¶ä¸­ï¼Œ$p_i=P(X=x_i),i=1,2,...,n$ã€‚

æ¡ä»¶ç†µ$H(Y\mid X)$è¡¨ç¤ºï¼Œåœ¨å·²çŸ¥éšæœºå˜é‡$X$æ—¶ï¼Œéšæœºå˜é‡$Y$çš„ä¸ç¡®å®šæ€§ã€‚



**ä¿¡æ¯å¢ç›Šï¼ˆäº’ä¿¡æ¯ï¼‰**

ä¿¡æ¯å¢ç›Šå®šä¹‰ä¸ºï¼š$MI(Y,X)=H(Y)-H(Y\mid X)$ï¼Œè¡¨ç¤ºâ€œå¾—çŸ¥$X$çš„ä¿¡æ¯ï¼Œè€Œä½¿$X$çš„**ä¸ç¡®å®šæ€§**å‡å°‘çš„ç¨‹åº¦â€ã€‚

åœ¨å†³ç­–æ ‘çš„ç‰¹å¾é€‰æ‹©è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨ç‰¹å¾$A$å¯¹æ•°æ®é›†$D$è¿›è¡Œåˆ†å‰²ï¼Œæ‰€å¸¦æ¥çš„ä¿¡æ¯å¢ç›Šå¯ä»¥è¡¨ç¤ºä¸ºï¼š$g(D,A)=MI(D,A)=H(D)-H(D\mid A)$



**ä¿¡æ¯å¢ç›Šæ¯”**

æœ‰ä»¥ä¸Šå®šä¹‰å¯çŸ¥ï¼Œé€šè¿‡è®¡ç®—ä¿¡æ¯å¢ç›Šæ¥è¿›è¡Œæ•°æ®åˆ†å‰²æ—¶ï¼Œä¼šåå‘å–å€¼è¾ƒå¤šçš„ç‰¹å¾çš„é—®é¢˜ï¼Œé’ˆå¯¹æ­¤é—®é¢˜ï¼Œä½¿ç”¨ä¿¡æ¯å¢ç›Šæ¯”æ¥è¿›è¡Œä¿®æ­£ï¼š

$g_{R}(D,A)=\frac{g(D,A)}{H_{A}(D)}$ï¼Œå…¶ä¸­$H_A(D)=-\sum_\limits{i=1}^{n}{\frac{\mid D_i\mid}{\mid D\mid}}\log{\frac{\mid D_i\mid}{\mid D\mid}}$ï¼Œå³è®¡ç®—æ•°æ®é›†$D$çš„ç†µæ—¶ï¼Œç‰¹å¾$A$çš„è´¡çŒ®ã€‚



**åŸºå°¼æŒ‡æ•°Gini Index**

åœ¨åˆ†ç±»é—®é¢˜ä¸­ï¼Œå‡è®¾æœ‰$k$ä¸ªç±»åˆ«ï¼Œæ ·æœ¬å±ç¬¬$k$ç±»çš„æ¦‚ç‡ä¸º$p_k$ï¼Œåˆ™æ¦‚ç‡åˆ†å¸ƒçš„åŸºå°¼æŒ‡æ•°å®šä¹‰ä¸ºï¼š

$$Gini(p)=\sum_\limits{k=1}^{K}p_k(1-p_k)=1-\sum_\limits{k=1}^{K}p_k^2$$

åˆ™æ•°æ®é›†$D$çš„åŸºå°¼æŒ‡æ•°ä¸ºï¼š

$$Gini(D)=1-\sum_\limits{k=1}^{K}\frac{\mid C_k\mid}{\mid D \mid}$$

å…¶ä¸­ï¼Œ$C_k$è¡¨ç¤ºç¬¬$k$ç±»æ ·æœ¬å­é›†çš„å¤§å°ã€‚

å‡è®¾æœ‰ç‰¹å¾Aï¼Œæ ¹æ®ç‰¹å¾$A$æ˜¯å¦æ»¡è¶³ç‰¹å®šæ¡ä»¶ï¼Œå°†æ•°æ®é›†åˆ’åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š$D_1,D_2$ï¼Œåˆ™å¯ä»¥å®šä¹‰ï¼šç»™å®šç‰¹å¾$A$çš„æ¡ä»¶ä¸‹ï¼Œæ ·æœ¬é›†åˆ$D$çš„åŸºå°¼æŒ‡æ•°$Gini(D,A)$ï¼ˆå³ç»™å®šç‰¹å¾$A$åï¼Œæ ·æœ¬é›†åˆ$D$çš„ä¸ç¡®å®šæ€§å‡å°‘çš„ç¨‹åº¦ï¼‰ï¼š

$$Gini(D,A)=\frac{\mid D_1\mid}{\mid D \mid}Gini(D_1)+\frac{\mid D_2\mid}{\mid D \mid}Gini(D_2)$$

åœ¨å†³ç­–æ ‘çš„æ„å»ºé˜¶æ®µï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥åœ¨è¿›è¡Œæœ€ä¼˜ç‰¹å¾é€‰æ‹©æ—¶ï¼Œéå†æ‰€æœ‰çš„ç‰¹å¾ï¼Œç„¶åè®¡ç®—å‡ºå…¶çº¯åº¦æŒ‡æ ‡ï¼ˆä¿¡æ¯å¢ç›Šã€ä¿¡æ¯å¢ç›Šæ¯”ã€åŸºå°¼æŒ‡æ•°ï¼‰ï¼Œç„¶åé€‰å‡ºä¸€ä¸ªæŒ‡æ ‡æœ€é«˜çš„ç‰¹å¾ï¼Œå¹¶æ ¹æ®è¯¥ç‰¹å¾çš„å–å€¼å°†æ ·æœ¬é›†åˆåˆ†è£‚ã€‚

å¸¸ç”¨çš„å†³ç­–æ ‘ç®—æ³•æœ‰ID3ç®—æ³•ã€C4.5ç®—æ³•å’ŒCARTç®—æ³•ï¼Œå…¶ä¸­ID3ç®—æ³•ä½¿ç”¨ä¿¡æ¯å¢ç›Šè¿›è¡Œç‰¹å¾é€‰æ‹©ï¼›C4.5ç®—æ³•è¿›è¡Œäº†æ”¹è¿›ï¼Œä½¿ç”¨ä¿¡æ¯å¢ç›Šæ¯”è¿›è¡Œç‰¹å¾é€‰æ‹©ï¼›å¯¹äºåˆ†ç±»æ ‘ï¼ŒCARTç®—æ³•ä½¿ç”¨åŸºå°¼æŒ‡æ•°æœ€å°åŒ–å‡†åˆ™ï¼Œå¯¹äºå›å½’æ ‘ï¼Œä½¿ç”¨å¹³æ–¹è¯¯å·®æœ€å°åŒ–å‡†åˆ™ã€‚



## äºŒã€Boosting

Boostingæ˜¯é›†æˆå­¦ä¹ æ€æƒ³çš„ä¸€ç§ï¼ˆå¦ä¸€ä¸ªæ˜¯Baggingï¼ŒæŒ‡å¹¶åˆ—åœ°è®­ç»ƒå¤šä¸ªåŸºæ¨¡å‹ï¼Œå¹¶é€šè¿‡æŠ•ç¥¨ï¼ˆåˆ†ç±»é—®é¢˜ï¼‰æˆ–å¹³å‡ï¼ˆå›å½’é—®é¢˜ï¼‰çš„æ–¹å¼è®¡ç®—å¾—åˆ°æœ€ç»ˆçš„é›†æˆç»“æœï¼‰ã€‚

ä¸Baggingçš„å¯å¹¶è¡Œä¸åŒï¼ŒBoostingç®—æ³•çš„æ‰§è¡Œæµç¨‹æ˜¯ä¸²è¡Œçš„ï¼Œå³åé¢çš„æ¨¡å‹çš„è®­ç»ƒä¾èµ–å‰é¢çš„æ¨¡å‹çš„é¢„æµ‹ç»“æœã€‚å…¸å‹çš„ç®—æ³•æœ‰Adaboostã€GBDTç­‰ã€‚ä¸‹é¢ç®€å•ä»‹ç»è¿™ä¸¤ç±»ç®—æ³•ã€‚

### 2.1 Adaboost

Adaboostç®—æ³•ï¼ˆAdaptive Boostingï¼Œè‡ªé€‚åº”å¢å¼ºï¼‰æ˜¯boostingç®—æ³•çš„ä»£è¡¨ï¼Œå…¶ç‰¹ç‚¹æ˜¯é€šè¿‡è¿­ä»£è®­ç»ƒä¸€ç³»åˆ—åŸºåˆ†ç±»å™¨ï¼Œåœ¨æ¯æ¬¡è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œæé«˜è¢«å‰ä¸€ä¸ªåˆ†ç±»å™¨åˆ†é”™çš„æ ·æœ¬çš„æƒé‡ï¼Œé™ä½è¢«å‰ä¸€ä¸ªåˆ†ç±»å™¨åˆ†å¯¹çš„æ ·æœ¬çš„æƒé‡ã€‚æœ€åï¼ŒAdaboostç®—æ³•å°†åŸºåˆ†ç±»å™¨è¿›è¡ŒåŠ æƒçº¿æ€§ç»„åˆï¼Œæ¯ä¸ªåŸºåˆ†ç±»å™¨éƒ½æœ‰ä¸€ä¸ªæƒé‡ï¼Œåˆ†ç±»è¯¯å·®è¶Šå°çš„åŸºåˆ†ç±»å™¨ï¼Œå…¶æƒé‡è¶Šé«˜ï¼Œå¦åˆ™æƒé‡è¶Šä½ã€‚

Adaboostçš„æ‰§è¡Œæµç¨‹ç®€è¿°å¦‚ä¸‹ï¼š

é¦–å…ˆï¼Œåˆå§‹åŒ–æ•°æ®é›†ä¸ºç­‰æƒé‡ã€‚æ¥ç€ï¼Œä¾æ¬¡è¿­ä»£è®­ç»ƒ$M$ä¸ªåŸºæ¨¡å‹$G_1,G_2,...,G_M$ï¼Œé’ˆå¯¹æ¨¡å‹$G_m$ï¼Œæ‰§è¡Œä»¥ä¸‹å››æ­¥ï¼š

1. ä½¿ç”¨å¸¦æƒçš„æ•°æ®è®­ç»ƒ$G_m$

2. è®¡ç®—$G_m$åœ¨æ•°æ®é›†ä¸Šçš„å¸¦æƒåˆ†ç±»è¯¯å·®ç‡

3. é€šè¿‡æ­¤è¯¯å·®ç‡è®¡ç®—åˆ†ç±»å™¨çš„æƒé‡

4. é€šè¿‡å¸¦æƒåŸºæ¨¡å‹$G_m$çš„é¢„æµ‹ç»“æœï¼Œæ›´æ–°è®­ç»ƒæ•°æ®çš„æƒé‡

åœ¨$M$ä¸ªåŸºæ¨¡å‹è®­ç»ƒå®Œæˆåï¼Œæ¯ä¸ªåŸºæ¨¡å‹å‡æœ‰ä¸€ä¸ªæƒé‡ï¼Œä½¿ç”¨è¯¥æƒé‡å¯¹ä¸€ç³»åˆ—åŸºæ¨¡å‹è¿›è¡ŒåŠ æƒç»„åˆï¼Œå³å¯å¾—åˆ°æœ€ç»ˆçš„åˆ†ç±»å™¨ã€‚



### 2.2 GBDT

GBDTå…¨ç§°æ˜¯Gradient Boost Desision Treeï¼Œå³æ¢¯åº¦æå‡å†³ç­–æ ‘ã€‚ä¸Adaboostä¸åŒçš„æ˜¯ï¼ŒGBDTçš„æ¯æ¬¡è¿­ä»£ç›®æ ‡æ˜¯å‡å°ä¹‹å‰æ¨¡å‹çš„æ®‹å·®ï¼Œåœ¨æ®‹å·®å‡å°çš„æ–¹å‘ï¼ˆè´Ÿæ¢¯åº¦æ–¹å‘ï¼‰å»ºç«‹ä¸€ä¸ªæ–°çš„æ¨¡å‹ã€‚

ä¾‹å¦‚ï¼š

>å‡è®¾æ ·æœ¬$[(1,2,3), 4]$ï¼Œå…¶ä¸­$(1,2,3)$æ˜¯æ ·æœ¬ç‰¹å¾ï¼Œ$4$æ˜¯æ ·æœ¬æ ‡ç­¾
>
>å‡è®¾æ¨¡å‹$m_i$åœ¨ä¸Šè¿°æ ·æœ¬ä¸Šçš„é¢„æµ‹ç»“æœæ˜¯$3.6$
>
>åˆ™æ¨¡å‹$m_{i+1}$çš„æ‹Ÿåˆç›®æ ‡å°±å˜ä¸ºï¼š$[(1,2,3), 0.4]$

æŒ‰ä¸Šè¿°æ–¹å¼å¾—åˆ°ä¸€ç³»åˆ—åŸºæ¨¡å‹åï¼ŒGBDTçš„é¢„æµ‹å€¼å°±æ˜¯æ ·æœ¬åœ¨æ‰€æœ‰åŸºæ¨¡å‹ä¸Šçš„ç»“æœçš„**åŠ å’Œ**ã€‚

åœ¨å›å½’ä»»åŠ¡ä¸­ï¼Œæ¯ä¸€æ¬¡è¿­ä»£ä¸­å¯¹æ¯ä¸€ä¸ªæ ·æœ¬éƒ½æœ‰ä¸€ä¸ªé¢„æµ‹å€¼ï¼ŒæŸå¤±å‡½æ•°ä½¿ç”¨MSEï¼ˆå‡æ–¹è¯¯å·®æŸå¤±ï¼‰ï¼š$l(y_i,\hat{y_i})=\frac{1}{2}(y_i-\hat{y_i})^2$ï¼Œå¯¹æŸå¤±è®¡ç®—æ¢¯åº¦å–è´Ÿï¼š$-[\frac{\partial l(y_i,\hat{y_i})}{\partial \hat{y_i}}]=(y_i-\hat{y_i})$ã€‚

ç”±ä¸Šè¿°ç»“æœå¯çŸ¥ï¼Œå½“æŸå¤±å‡½æ•°ä½¿ç”¨MSEæ—¶ï¼Œæ¯ä¸€æ¬¡æ‹Ÿåˆçš„å€¼å°±æ˜¯åŸºæ¨¡å‹çš„çœŸå®å€¼å‡é¢„æµ‹å€¼ï¼Œä¹Ÿå³â€œæ®‹å·®â€ã€‚



## ä¸‰ã€XGBoost

XGBoostçš„ä»‹ç»ä¸ºï¼šXGBoostæ˜¯ä¸€ä¸ªé«˜æ•ˆã€çµæ´»ã€å¯ç§»æ¤çš„åˆ†å¸ƒå¼æ¢¯åº¦æå‡å·¥å…·åŒ…ã€‚æ˜¯ä¸€ç§åŸºäºæ¢¯åº¦æå‡æ¡†æ¶çš„å¹¶è¡ŒåŒ–çš„æå‡æ ‘å®ç°æ–¹æ¡ˆã€‚

XGBoostçš„æ€æƒ³æ˜¯ï¼Œä¸æ–­åœ°åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­æ·»åŠ æ ‘ï¼Œåˆ©ç”¨ç‰¹å¾åˆ†è£‚æ¥ç”Ÿé•¿ä¸€æ£µæ ‘ï¼Œæ·»åŠ æ ‘çš„è¿‡ç¨‹å°±æ˜¯ä½ å’Œä¸€ä¸ªæ–°å‡½æ•°çš„è¿‡ç¨‹ï¼Œè¿™ä¸ªæ–°å‡½æ•°çš„æ‹Ÿåˆå¯¹è±¡æ˜¯ä¸Šä¸€æ¬¡é¢„æµ‹ç»“æœçš„æ®‹å·®ã€‚

$$\hat{y}=\phi(x_i)=\sum_\limits{k=1}^Kf_k(x_i)$$

è®­ç»ƒå®Œæˆåå¾—åˆ°$K$æ£µæ ‘ï¼Œé’ˆå¯¹ä¸€ä¸ªæ ·æœ¬ï¼Œè¯¥æ ·æœ¬çš„ç‰¹å¾åœ¨$K$æ£µæ ‘ä¸Šä¼šè½åˆ°$K$ä¸ªå¶å­ç»“ç‚¹ä¸Šï¼Œå¾—åˆ°$K$ä¸ªé¢„æµ‹åˆ†æ•°ï¼Œå°†è¿™äº›åˆ†æ•°ç›¸åŠ ï¼Œå°±èƒ½å¾—åˆ°è¯¥æ ·æœ¬çš„é¢„æµ‹å€¼ã€‚

### 3.1 XGBoostçš„ç›®æ ‡å‡½æ•°å’Œè¯¯å·®

å°†XGBoostçš„è¯¯å·®å¯ä»¥ç®€å†™å¦‚ä¸‹ï¼š

$$L(\phi)=\sum_\limits{i}l(\hat{y_i}-y_i)+\sum_\limits{k}\Omega(f_k)$$

æŸå¤±å‡½æ•°åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œç¬¬ä¸€éƒ¨åˆ†ä¸ºè¯¯å·®å‡½æ•°ï¼Œè¯¯å·®å‡½æ•°åæ˜ äº†å½“å‰æ¨¡å‹å¯¹æ•°æ®çš„æ‹Ÿåˆç¨‹åº¦ï¼Œå…¶ä¸­$y_i$è¡¨ç¤ºç¬¬$i$ä¸ªæ ·æœ¬çš„çœŸå®å€¼ï¼Œ$\hat{y_i}$æ˜¯æ‰€æœ‰åŸºæ¨¡å‹çš„è¾“å‡ºç´¯åŠ ï¼›ç¬¬äºŒéƒ¨åˆ†ä¸ºæ­£åˆ™åŒ–é¡¹ï¼Œæ­£åˆ™åŒ–é¡¹å®šä¹‰äº†æ¨¡å‹çš„å¤æ‚åº¦ã€‚

#### 3.1.1 è¯¯å·®å‡½æ•°

è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œç¬¬$t$è½®çš„æ¨¡å‹é¢„æµ‹å€¼$\hat{y}^{(t)}=\hat{y}^{(t-1)}+f_t(x_i)$ï¼Œè¯¯å·®å‡½æ•°å¯ä»¥è®°ä¸ºï¼š$l(y_i,\hat{y}^{(t-1)},f_t(x_i))$ï¼Œç¬¬$t$è½®è®­ç»ƒçš„ç›®æ ‡æ˜¯å­¦ä¹ å‡½æ•°$f$ï¼Œè‡³æ­¤ï¼ŒXGBoostçš„ç›®æ ‡å‡½æ•°$Obj^{(t)}$å¯ä»¥å†™ä¸ºï¼š

$$Obj^{(t)}=\sum\limits_{i=1}^n(l(y_i,\hat{y}^{(t-1)},f_t(x_i))   +  \Omega(f_t))   +constant$$

ä¸Šé¢æåˆ°ï¼Œå½“æŸå¤±å‡½æ•°$l(\cdot)$ä¸ºMSEæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æ¨å¯¼å‡ºï¼ŒæŸå¤±å‡½æ•°çš„è´Ÿæ¢¯åº¦æ–¹å‘å³æ˜¯æ®‹å·®ï¼Œé‚£ä¹ˆï¼Œå½“æŸå¤±å‡½æ•°æ˜¯å…¶ä»–å½¢å¼çš„å‡½æ•°å‘¢ï¼Ÿ

XGBoostæå‡ºï¼Œå¯¹äºå…¶ä»–å½¢å¼çš„æŸå¤±å‡½æ•°ï¼Œåˆ™ä½¿ç”¨ä¸€ä¸ªäºŒæ¬¡å‡½æ•°æ¥è¿‘ä¼¼ï¼Œè¿™é‡Œä½¿ç”¨æ³°å‹’å±•å¼€çš„æ–¹å¼ã€‚

>  å›é¡¾æ³°å‹’å®šç†ï¼š
>
> è®¾æœ‰åœ¨$a$ç‚¹æ‰€åœ¨åŒºé—´ä¸Š$n+1$é˜¶å¯å¯¼çš„å‡½æ•°$f(x)$ï¼Œåˆ™å¯¹è¿™ä¸ªåŒºé—´ä¸Šçš„ä»»æ„$x$ï¼Œéƒ½æœ‰å¦‚ä¸‹æ³°å‹’å±•å¼€å½¢å¼ï¼š
>
> $$f(x)=f(a)+\frac{f'(a)}{1!}(x-a) +    \frac{f^{(2)}(a)}{2!}(x-a)^2+\cdot \cdot \cdot +   \frac{f^{(n)}(a)}{n!}(x-a)^n + R_n(x)$$
>
> å…¶ä¸­ï¼Œ$R_n(x)$ä¸ºä½™é¡¹ï¼Œæ˜¯$(x-a)^n$çš„é«˜é˜¶æ— ç©·å°ã€‚

åœ¨XGBoostä¸­ï¼Œå¯¹æŸå¤±å‡½æ•°è¿›è¡Œäº†äºŒé˜¶æ³°å‹’å±•å¼€ï¼š

$$f(x+\Delta x) \simeq f(x)+f^{\prime}(x) \Delta x+\frac{1}{2} f^{\prime \prime}(x) \Delta x^{2}$$

å®šä¹‰$g_{i}=\partial_{\hat{y}^{(t-1)}} l\left(y_{i}, \hat{y}^{(t-1)}\right), \quad h_{i}=\partial_{\hat{y}^{(t-1)}}^{2}l\left(y_{i}, \hat{y}^{(t-1)}\right)$

å°†$l(y_i,c+f_t(x_i))$ä¸­çš„$\hat{y_i}^{(t-1)}$çœ‹ä½œäºŒé˜¶æ³°å‹’å±•å¼€å¼ä¸­çš„$x$ï¼›å°†$f_t(x_i)$çœ‹ä½œå±•å¼€å¼ä¸­çš„$\Delta x$ï¼Œåˆ™ç›®æ ‡å‡½æ•°å¯ä»¥è¿‘ä¼¼å†™ä¸ºï¼š

$$
Obj^{(t)} \simeq \sum_{i=1}^{n}\left[l\left(y_{i}, \hat{y}_{i}^{(t-1)}\right)+g_{i} f_{t}\left(x_{i}\right)+\frac{1}{2} h_{i} f_{t}^{2}\left(x_{i}\right)\right]+\Omega\left(f_{t}\right)+\text { constant }
$$

åœ¨ä¸Šå¼ä¸­ï¼Œ$l\left(y_{i}, \hat{y}_{i}^{(t-1)}\right)$ä¸ºæ ·æœ¬çš„çœŸå®æ ‡ç­¾å’Œç¬¬$t-1$æ¬¡é¢„æµ‹çš„æ®‹å·®ï¼Œæ˜¯ä¸€ä¸ªå·²çŸ¥çš„æ•°å€¼ï¼Œä¸å½±å“ç¬¬$t$è½®çš„ä¼˜åŒ–ï¼Œå¸¸æ•°é¡¹ä¹Ÿå¯ä»¥ç§»é™¤ï¼Œå› æ­¤ï¼Œç›®æ ‡å‡½æ•°å¯ä»¥é‡å†™ä¸ºï¼š

$$Obj^{(t)}=\sum_\limits{i=1}^{n}[g_{i} f_{t(x_{i})}+\frac{1}{2} h_{i} f_{t}^{2}(x_{i})]+\Omega (f_{t})$$

å…¶ä¸­ï¼Œ$g_{i}=\partial_{\hat{y}^{(t-1)}} l\left(y_{i}, \hat{y}^{(t-1)}\right), \quad h_{i}=\partial_{\hat{y}^{(t-1)}}^{2}l\left(y_{i}, \hat{y}^{(t-1)}\right)$ã€‚

å¯ä»¥çœ‹å‡ºï¼Œç›®æ ‡å‡½æ•°ä»…ä¾èµ–æ¯ä¸ªæ ·æœ¬åœ¨è¯¯å·®å‡½æ•°ä¸Šçš„ä¸€é˜¶å¯¼æ•°$g$å’ŒäºŒé˜¶å¯¼æ•°$h$ï¼Œä»è¿™é‡Œä¹Ÿå¯ä»¥çœ‹å‡ºï¼ŒXGBoostä¸GBDTåœ¨ç›®æ ‡å‡½æ•°çš„ä¸€ä¸ªå·®åˆ«ï¼šXGBoostè€ƒè™‘äº†è¯¯å·®å‡½æ•°çš„äºŒé˜¶å¯¼æ•°ã€‚

#### 3.1.2 æ­£åˆ™åŒ–é¡¹

åœ¨æ ‘æ¨¡å‹ä¸­ï¼Œæ­£åˆ™åŒ–é¡¹çš„åŠ å…¥ä¸€èˆ¬æ˜¯ä¸ºäº†æ§åˆ¶æ ‘çš„è§„æ¨¡ã€‚XGBoostç›®æ ‡å‡½æ•°çš„æ­£åˆ™åŒ–é¡¹çš„å®šä¹‰å¦‚ä¸‹ï¼š

$$\Omega(f)=\gamma T+\frac{1}{2} \lambda\Vert w\Vert^2$$

å…¶ä¸­ï¼Œ$T$è¡¨ç¤ºå¶å­ç»“ç‚¹çš„ä¸ªæ•°ï¼Œ$w$è¡¨ç¤ºå¶å­ç»“ç‚¹çš„åˆ†æ•°ï¼Œå°†äºŒè€…ä½œä¸ºæƒ©ç½šé¡¹æ—¶ï¼Œå³è¦æ±‚åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œç”Ÿæˆçš„æ ‘çš„å¶å­ç»“ç‚¹å°½å¯èƒ½å°‘ï¼Œä¸”å¶å­ç»“ç‚¹çš„æ•°å€¼ä¸ä¼šè¿‡å¤§ï¼Œä»è€Œè¾¾åˆ°é˜²æ­¢è¿‡æ‹Ÿåˆçš„ç›®çš„ã€‚

å›é¡¾ä¸Šé¢å¾—åˆ°çš„ç›®æ ‡å‡½æ•°çš„è¡¨è¾¾å¼ï¼š

$$Obj^{(t)}=\sum_\limits{i=1}^{n}[g_{i} f_{t(x_{i})}+\frac{1}{2} h_{i} f_{t}^{2}(x_{i})]+\Omega (f_{t})$$

å…¶ä¸­$f_t(x)$å¯ä»¥å†™ä¸ºï¼š

$$f_t(x)=w_{q(x)},\quad w\in\mathrm{R}^T,q:\mathrm{R}^d \rightarrow\{1,2,...,T\}$$

$w$è¡¨ç¤ºæ ‘çš„å¶å­ç»“ç‚¹çš„æƒé‡ï¼Œ$q$è¡¨ç¤ºæ ‘çš„ç»“æ„ï¼Œç»™å®šä¸€ä¸ªè¾“å…¥ï¼Œç»“æ„å‡½æ•°å°†å…¶**æ˜ å°„**åˆ°å¶å­ç»“ç‚¹çš„ç´¢å¼•ï¼Œå†é€šè¿‡æƒé‡å‘é‡$w$ï¼ˆå¯ä»¥çœ‹åˆ°æƒé‡å‘é‡çš„ç»´åº¦ä¸ºå¶å­ç»“ç‚¹çš„ä¸ªæ•°ï¼‰ï¼Œå¾—åˆ°å¯¹åº”çš„å¶å­ç»“ç‚¹çš„åˆ†æ•°ã€‚

ç”±ä»¥ä¸Šå®šä¹‰ï¼Œå¯ä»¥å°†ä¸Šè¿°ç›®æ ‡å‡½æ•°ä¿®æ”¹ä¸ºï¼š

$$\begin{aligned} Obj^{(t)}
& \simeq \sum_\limits{i=1}^n[g_i f_t(x_i)+\frac{1}{2}h_i f_t^2(x_i)] + \Omega(f_t) \\
&=\sum_{j=1}^{T}\left[\left(\sum_{i \in I_{j}} g_{i}\right) w_{j}+\frac{1}{2}\left(\sum_{i \in I_{j}} h_{i}+\lambda\right) w_{j}^{2}\right]+\gamma T
\end{aligned}$$

å…¶ä¸­$I_j$å®šä¹‰ä¸ºæ¯ä¸ªå¶å­èŠ‚ç‚¹$j$ä¸Šé¢æ ·æœ¬ç´¢å¼•çš„é›†åˆï¼š$I_{j}=\{i \mid q(x_{i})=j\}$ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸€æ­¥çš„ç›®æ ‡å‡½æ•°çš„è½¬æ¢æœ‰ä¸¤ä¸ªç´¯åŠ å½¢å¼ï¼Œç¬¬ä¸€ä¸ªæ˜¯æ ·æœ¬è§’åº¦çš„ç´¯åŠ ï¼Œç„¶åè½¬åŒ–ä¸ºå¶å­ç»“ç‚¹æ•°çš„ç´¯åŠ ã€‚å›å¿†å‰è¿°å®šä¹‰çš„æ ‘ç»“æ„æ˜ å°„$q$ï¼Œå…¶èƒ½å¤Ÿå°†æ ·æœ¬$x_i$æ˜ å°„åˆ°æ ‘çš„ä¸€ä¸ªå¶å­ç»“ç‚¹ä¸Šã€‚

åœ¨ä¸Šè¿°ç›®æ ‡å‡½æ•°ä¸Šï¼Œå®šä¹‰$G_j=\sum_\limits{i \in I_{j}} g_{i}$ï¼Œ$H_j=\sum_\limits{i \in I_{j}} h_{i}$ï¼Œå°†ç›®æ ‡å‡½æ•°ç®€å†™ä¸ºï¼š

$$Obj^{(t)}=\sum_\limits{j=1}^T[G_jw_j+\frac{1}{2}(H_j+\lambda)w_j^2]+\gamma T$$



Sorry, this post is under ğŸš§.










## å‚è€ƒ

1. ç»Ÿè®¡å­¦ä¹ æ–¹æ³•
2. https://blog.csdn.net/v_JULY_v/article/details/81410574





