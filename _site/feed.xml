<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Shihanmax</title>
    <description>Shihanmax's blog
</description>
    <link>http://localhost:4000//</link>
    <atom:link href="http://localhost:4000//feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Mon, 29 Mar 2021 17:15:39 +0800</pubDate>
    <lastBuildDate>Mon, 29 Mar 2021 17:15:39 +0800</lastBuildDate>
    <generator>Jekyll v3.9.0</generator>
    
      <item>
        <title>XGBoostç†è§£</title>
        <description>&lt;p&gt;&lt;strong&gt;æœ¬æ–‡æ­£åœ¨æ•´ç†ä¸­â€¦ğŸš§&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;XGBoostï¼ˆeXtreme Gradient Boostingï¼‰æ˜¯GBDTçš„ä¸€ç§é«˜æ•ˆçš„å·¥ç¨‹å®ç°ï¼Œåœ¨æ•°æ®ç«èµ›ä¸­åº”ç”¨ååˆ†å¹¿æ³›ã€‚&lt;/p&gt;

&lt;p&gt;ä¸‹æ–‡ä»å†³ç­–æ ‘çš„å®šä¹‰å¼€å§‹ï¼Œä»‹ç»å†³ç­–æ ‘çš„åˆ†è£‚æŒ‡æ ‡ã€å†³ç­–æ ‘åœ¨boostingç®—æ³•ä¸­çš„åº”ç”¨BDTã€å¼•å…¥æ®‹å·®ä¿¡æ¯çš„Gradient boostingç®—æ³•ç­‰ï¼Œæœ€åï¼Œä»‹ç»é›†æˆäº†å¤šç§é«˜æ•ˆç®—æ³•çš„XGBoostçš„å·¥ç¨‹å®ç°ã€‚&lt;/p&gt;

&lt;h2 id=&quot;ä¸€å†³ç­–æ ‘&quot;&gt;ä¸€ã€å†³ç­–æ ‘&lt;/h2&gt;

&lt;p&gt;å†³ç­–æ ‘æ˜¯ä¸€ç§æè¿°å¯¹å®ä¾‹è¿›è¡Œåˆ†ç±»çš„å±æ€§ç»“æ„ï¼Œç”±èŠ‚ç‚¹å’Œæœ‰å‘è¾¹ç»„æˆï¼Œå…¶ä¸­ï¼ŒèŠ‚ç‚¹åˆ†ä¸ºå†…éƒ¨èŠ‚ç‚¹å’Œå¶å­ç»“ç‚¹ï¼Œå†…éƒ¨èŠ‚ç‚¹è¡¨ç¤ºç‰¹å¾æˆ–å±æ€§ï¼Œå¶å­ç»“ç‚¹è¡¨ç¤ºä¸€ä¸ªç±»ã€‚&lt;/p&gt;

&lt;p&gt;ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œå¯¹æ ·æœ¬çš„æŸä¸€ä¸ªç‰¹å¾è¿›è¡Œæµ‹è¯•ï¼Œæ ¹æ®ç»“æœï¼Œå°†æ ·æœ¬åˆ’åˆ†åˆ°å…¶è‹¥å¹²ä¸ªå­èŠ‚ç‚¹ä¸­ï¼Œå…¶ä¸­æ¯ä¸ªå­èŠ‚ç‚¹å‡å¯¹åº”è¯¥ç‰¹å¾çš„ä¸€ä¸ªå–å€¼ï¼›é’ˆå¯¹æ¯ä¸€ä¸ªå­èŠ‚ç‚¹ï¼Œç»§ç»­é€‰å–ä¸€ä¸ªç‰¹å¾é‡å¤æ‰§è¡Œä¸Šè¿°è¿‡ç¨‹ï¼Œç›´åˆ°å°†å®ä¾‹åˆ’åˆ†åˆ°å¶èŠ‚ç‚¹æ‰€å¯¹åº”çš„ç±»åˆ«å½“ä¸­ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨ä¸Šè¿°æè¿°è¿‡ç¨‹ä¸­ï¼Œæœ‰ä¸€ä¸ªé‡è¦çš„ç‚¹æ˜¯ï¼Œå¦‚ä½•é€‰æ‹©ä¸€ä¸ªæœ€å¥½çš„ç‰¹å¾ï¼Œå¹¶ä½¿ç”¨å…¶è¿›è¡Œæ ·æœ¬çš„åˆ’åˆ†ï¼Ÿ&lt;/p&gt;

&lt;p&gt;ç›´è§‚ä¸Šè€ƒè™‘ï¼Œå¦‚æœåˆ’åˆ†åçš„å­é›†æ‹¥æœ‰æ›´é«˜çš„â€œçº¯åº¦â€ï¼Œåˆ™è¡¨ç¤ºè¯¥ç‰¹å¾æ˜¯ä¸€ä¸ªå¥½çš„ç‰¹å¾ã€‚æ‰€è°“çº¯åº¦æ˜¯æŒ‡ï¼Œåˆ’åˆ†åçš„å­æ ·æœ¬é›†åˆæ‰€å¯¹åº”çš„ç±»åˆ«åº”å°½å¯èƒ½ä¸€è‡´ï¼Œæç«¯è€ƒè™‘ï¼Œå‡è®¾æˆ‘ä»¬é€‰æ‹©äº†ä¸€ä¸ªç‰¹å¾ï¼Œåœ¨ä½¿ç”¨æ­¤ç‰¹å¾è¿›è¡Œåˆ’åˆ†åï¼Œæ‰€æœ‰çš„å­é›†åˆä¸­ï¼Œæ ·æœ¬çš„ç±»åˆ«å‡ ä¹ä¸€è‡´ï¼Œåˆ™å¯ä»¥è®¤ä¸ºè¿™ä¸ªç‰¹å¾æ˜¯ä¸€ä¸ªéå¸¸å¼ºçš„ç‰¹å¾ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨å†³ç­–æ ‘å®ç°è¿‡ç¨‹ä¸­ï¼Œä¸€èˆ¬ä½¿ç”¨ä¸‰ä¸ªæŒ‡æ ‡è¡¡é‡åˆ†ç±»çº¯åº¦ï¼šä¿¡æ¯å¢ç›Šã€ä¿¡æ¯å¢ç›Šæ¯”ã€åŸºå°¼æŒ‡æ•°ã€‚é¦–å…ˆå›é¡¾ä¸€ä¸‹ä¿¡æ¯è®ºä¸­å‡ ä¸ªåŸºç¡€çš„æ¦‚å¿µï¼š&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ç†µï¼ˆEntropyï¼‰&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;è®¾$X$æ˜¯éšæœºå˜é‡ï¼Œ$P(X=x_i)=p_i,i=1,2,â€¦,n$ï¼Œåˆ™$X$çš„ç†µå®šä¹‰ä¸ºï¼š&lt;/p&gt;

\[H(X)=-\sum_\limits{i=1}^{n}{p_i}\log{p_i}\]

&lt;p&gt;å¯ä»¥çœ‹å‡ºï¼Œ$X$çš„ç†µçš„å–å€¼ä»…ä¸$X$çš„åˆ†å¸ƒæœ‰å…³ï¼Œä¸$X$çš„å–å€¼æ— å…³ï¼Œæ‰€ä»¥è¿™é‡Œ$H(X)$ä¹Ÿå¯ä»¥å†™ä½œ$H(p)$ã€‚ä¸Šå¼ä¸­çš„å¯¹æ•°ä»¥$2$ä¸ºåº•æ—¶ï¼Œç†µçš„å•ä½ä¸º$bit$ï¼›ä»¥$e$ä¸ºåº•æ—¶å¯¹åº”çš„å•ä½ä¸º$nat$ã€‚&lt;/p&gt;

&lt;p&gt;ç†µå¯ä»¥ç”¨æ¥è¡¡é‡éšæœºå˜é‡çš„ä¸ç¡®å®šæ€§ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;æ¡ä»¶ç†µ&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;æ¡ä»¶ç†µ$H(Y\mid X)=\sum_\limits{i=1}^{n}{p_i}H(Y\mid X=x_i)$ï¼Œå…¶ä¸­ï¼Œ$p_i=P(X=x_i),i=1,2,â€¦,n$ã€‚&lt;/p&gt;

&lt;p&gt;æ¡ä»¶ç†µ$H(Y\mid X)$è¡¨ç¤ºï¼Œåœ¨å·²çŸ¥éšæœºå˜é‡$X$æ—¶ï¼Œéšæœºå˜é‡$Y$çš„ä¸ç¡®å®šæ€§ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ä¿¡æ¯å¢ç›Šï¼ˆäº’ä¿¡æ¯ï¼‰&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ä¿¡æ¯å¢ç›Šå®šä¹‰ä¸ºï¼š$MI(Y,X)=H(Y)-H(Y\mid X)$ï¼Œè¡¨ç¤ºâ€œå¾—çŸ¥$X$çš„ä¿¡æ¯ï¼Œè€Œä½¿$X$çš„&lt;strong&gt;ä¸ç¡®å®šæ€§&lt;/strong&gt;å‡å°‘çš„ç¨‹åº¦â€ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨å†³ç­–æ ‘çš„ç‰¹å¾é€‰æ‹©è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨ç‰¹å¾$A$å¯¹æ•°æ®é›†$D$è¿›è¡Œåˆ†å‰²ï¼Œæ‰€å¸¦æ¥çš„ä¿¡æ¯å¢ç›Šå¯ä»¥è¡¨ç¤ºä¸ºï¼š$g(D,A)=MI(D,A)=H(D)-H(D\mid A)$&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ä¿¡æ¯å¢ç›Šæ¯”&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;æœ‰ä»¥ä¸Šå®šä¹‰å¯çŸ¥ï¼Œé€šè¿‡è®¡ç®—ä¿¡æ¯å¢ç›Šæ¥è¿›è¡Œæ•°æ®åˆ†å‰²æ—¶ï¼Œä¼šåå‘å–å€¼è¾ƒå¤šçš„ç‰¹å¾çš„é—®é¢˜ï¼Œé’ˆå¯¹æ­¤é—®é¢˜ï¼Œä½¿ç”¨ä¿¡æ¯å¢ç›Šæ¯”æ¥è¿›è¡Œä¿®æ­£ï¼š&lt;/p&gt;

&lt;p&gt;$g_{R}(D,A)=\frac{g(D,A)}{H_{A}(D)}$ï¼Œå…¶ä¸­$H_A(D)=-\sum_\limits{i=1}^{n}{\frac{\mid D_i\mid}{\mid D\mid}}\log{\frac{\mid D_i\mid}{\mid D\mid}}$ï¼Œå³è®¡ç®—æ•°æ®é›†$D$çš„ç†µæ—¶ï¼Œç‰¹å¾$A$çš„è´¡çŒ®ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;åŸºå°¼æŒ‡æ•°Gini Index&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;åœ¨åˆ†ç±»é—®é¢˜ä¸­ï¼Œå‡è®¾æœ‰$k$ä¸ªç±»åˆ«ï¼Œæ ·æœ¬å±ç¬¬$k$ç±»çš„æ¦‚ç‡ä¸º$p_k$ï¼Œåˆ™æ¦‚ç‡åˆ†å¸ƒçš„åŸºå°¼æŒ‡æ•°å®šä¹‰ä¸ºï¼š&lt;/p&gt;

\[Gini(p)=\sum_\limits{k=1}^{K}p_k(1-p_k)=1-\sum_\limits{k=1}^{K}p_k^2\]

&lt;p&gt;åˆ™æ•°æ®é›†$D$çš„åŸºå°¼æŒ‡æ•°ä¸ºï¼š&lt;/p&gt;

\[Gini(D)=1-\sum_\limits{k=1}^{K}\frac{\mid C_k\mid}{\mid D \mid}\]

&lt;p&gt;å…¶ä¸­ï¼Œ$C_k$è¡¨ç¤ºç¬¬$k$ç±»æ ·æœ¬å­é›†çš„å¤§å°ã€‚&lt;/p&gt;

&lt;p&gt;å‡è®¾æœ‰ç‰¹å¾Aï¼Œæ ¹æ®ç‰¹å¾$A$æ˜¯å¦æ»¡è¶³ç‰¹å®šæ¡ä»¶ï¼Œå°†æ•°æ®é›†åˆ’åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š$D_1,D_2$ï¼Œåˆ™å¯ä»¥å®šä¹‰ï¼šç»™å®šç‰¹å¾$A$çš„æ¡ä»¶ä¸‹ï¼Œæ ·æœ¬é›†åˆ$D$çš„åŸºå°¼æŒ‡æ•°$Gini(D,A)$ï¼ˆå³ç»™å®šç‰¹å¾$A$åï¼Œæ ·æœ¬é›†åˆ$D$çš„ä¸ç¡®å®šæ€§å‡å°‘çš„ç¨‹åº¦ï¼‰ï¼š&lt;/p&gt;

\[Gini(D,A)=\frac{\mid D_1\mid}{\mid D \mid}Gini(D_1)+\frac{\mid D_2\mid}{\mid D \mid}Gini(D_2)\]

&lt;p&gt;åœ¨å†³ç­–æ ‘çš„æ„å»ºé˜¶æ®µï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥åœ¨è¿›è¡Œæœ€ä¼˜ç‰¹å¾é€‰æ‹©æ—¶ï¼Œéå†æ‰€æœ‰çš„ç‰¹å¾ï¼Œç„¶åè®¡ç®—å‡ºå…¶çº¯åº¦æŒ‡æ ‡ï¼ˆä¿¡æ¯å¢ç›Šã€ä¿¡æ¯å¢ç›Šæ¯”ã€åŸºå°¼æŒ‡æ•°ï¼‰ï¼Œç„¶åé€‰å‡ºä¸€ä¸ªæŒ‡æ ‡æœ€é«˜çš„ç‰¹å¾ï¼Œå¹¶æ ¹æ®è¯¥ç‰¹å¾çš„å–å€¼å°†æ ·æœ¬é›†åˆåˆ†è£‚ã€‚&lt;/p&gt;

&lt;p&gt;å¸¸ç”¨çš„å†³ç­–æ ‘ç®—æ³•æœ‰ID3ç®—æ³•ã€C4.5ç®—æ³•å’ŒCARTç®—æ³•ï¼Œå…¶ä¸­ID3ç®—æ³•ä½¿ç”¨ä¿¡æ¯å¢ç›Šè¿›è¡Œç‰¹å¾é€‰æ‹©ï¼›C4.5ç®—æ³•è¿›è¡Œäº†æ”¹è¿›ï¼Œä½¿ç”¨ä¿¡æ¯å¢ç›Šæ¯”è¿›è¡Œç‰¹å¾é€‰æ‹©ï¼›å¯¹äºåˆ†ç±»æ ‘ï¼ŒCARTç®—æ³•ä½¿ç”¨åŸºå°¼æŒ‡æ•°æœ€å°åŒ–å‡†åˆ™ï¼Œå¯¹äºå›å½’æ ‘ï¼Œä½¿ç”¨å¹³æ–¹è¯¯å·®æœ€å°åŒ–å‡†åˆ™ã€‚&lt;/p&gt;

&lt;h2 id=&quot;äºŒboosting&quot;&gt;äºŒã€Boosting&lt;/h2&gt;

&lt;p&gt;Boostingæ˜¯é›†æˆå­¦ä¹ æ€æƒ³çš„ä¸€ç§ï¼ˆå¦ä¸€ä¸ªæ˜¯Baggingï¼ŒæŒ‡å¹¶åˆ—åœ°è®­ç»ƒå¤šä¸ªåŸºæ¨¡å‹ï¼Œå¹¶é€šè¿‡æŠ•ç¥¨ï¼ˆåˆ†ç±»é—®é¢˜ï¼‰æˆ–å¹³å‡ï¼ˆå›å½’é—®é¢˜ï¼‰çš„æ–¹å¼è®¡ç®—å¾—åˆ°æœ€ç»ˆçš„é›†æˆç»“æœï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;ä¸Baggingçš„å¯å¹¶è¡Œä¸åŒï¼ŒBoostingç®—æ³•çš„æ‰§è¡Œæµç¨‹æ˜¯ä¸²è¡Œçš„ï¼Œå³åé¢çš„æ¨¡å‹çš„è®­ç»ƒä¾èµ–å‰é¢çš„æ¨¡å‹çš„é¢„æµ‹ç»“æœã€‚å…¸å‹çš„ç®—æ³•æœ‰Adaboostã€GBDTç­‰ã€‚ä¸‹é¢ç®€å•ä»‹ç»è¿™ä¸¤ç±»ç®—æ³•ã€‚&lt;/p&gt;

&lt;h3 id=&quot;21-adaboost&quot;&gt;2.1 Adaboost&lt;/h3&gt;

&lt;p&gt;Adaboostç®—æ³•ï¼ˆAdaptive Boostingï¼Œè‡ªé€‚åº”å¢å¼ºï¼‰æ˜¯boostingç®—æ³•çš„ä»£è¡¨ï¼Œå…¶ç‰¹ç‚¹æ˜¯é€šè¿‡è¿­ä»£è®­ç»ƒä¸€ç³»åˆ—åŸºåˆ†ç±»å™¨ï¼Œåœ¨æ¯æ¬¡è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œæé«˜è¢«å‰ä¸€ä¸ªåˆ†ç±»å™¨åˆ†é”™çš„æ ·æœ¬çš„æƒé‡ï¼Œé™ä½è¢«å‰ä¸€ä¸ªåˆ†ç±»å™¨åˆ†å¯¹çš„æ ·æœ¬çš„æƒé‡ã€‚æœ€åï¼ŒAdaboostç®—æ³•å°†åŸºåˆ†ç±»å™¨è¿›è¡ŒåŠ æƒçº¿æ€§ç»„åˆï¼Œæ¯ä¸ªåŸºåˆ†ç±»å™¨éƒ½æœ‰ä¸€ä¸ªæƒé‡ï¼Œåˆ†ç±»è¯¯å·®è¶Šå°çš„åŸºåˆ†ç±»å™¨ï¼Œå…¶æƒé‡è¶Šé«˜ï¼Œå¦åˆ™æƒé‡è¶Šä½ã€‚&lt;/p&gt;

&lt;p&gt;Adaboostçš„æ‰§è¡Œæµç¨‹ç®€è¿°å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;é¦–å…ˆï¼Œåˆå§‹åŒ–æ•°æ®é›†ä¸ºç­‰æƒé‡ã€‚æ¥ç€ï¼Œä¾æ¬¡è¿­ä»£è®­ç»ƒ$M$ä¸ªåŸºæ¨¡å‹$G_1,G_2,â€¦,G_M$ï¼Œé’ˆå¯¹æ¨¡å‹$G_m$ï¼Œæ‰§è¡Œä»¥ä¸‹å››æ­¥ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;ä½¿ç”¨å¸¦æƒçš„æ•°æ®è®­ç»ƒ$G_m$&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;è®¡ç®—$G_m$åœ¨æ•°æ®é›†ä¸Šçš„å¸¦æƒåˆ†ç±»è¯¯å·®ç‡&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;é€šè¿‡æ­¤è¯¯å·®ç‡è®¡ç®—åˆ†ç±»å™¨çš„æƒé‡&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;é€šè¿‡å¸¦æƒåŸºæ¨¡å‹$G_m$çš„é¢„æµ‹ç»“æœï¼Œæ›´æ–°è®­ç»ƒæ•°æ®çš„æƒé‡&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;åœ¨$M$ä¸ªåŸºæ¨¡å‹è®­ç»ƒå®Œæˆåï¼Œæ¯ä¸ªåŸºæ¨¡å‹å‡æœ‰ä¸€ä¸ªæƒé‡ï¼Œä½¿ç”¨è¯¥æƒé‡å¯¹ä¸€ç³»åˆ—åŸºæ¨¡å‹è¿›è¡ŒåŠ æƒç»„åˆï¼Œå³å¯å¾—åˆ°æœ€ç»ˆçš„åˆ†ç±»å™¨ã€‚&lt;/p&gt;

&lt;h3 id=&quot;22-gbdt&quot;&gt;2.2 GBDT&lt;/h3&gt;

&lt;p&gt;GBDTå…¨ç§°æ˜¯Gradient Boost Desision Treeï¼Œå³æ¢¯åº¦æå‡å†³ç­–æ ‘ã€‚ä¸Adaboostä¸åŒçš„æ˜¯ï¼ŒGBDTçš„æ¯æ¬¡è¿­ä»£ç›®æ ‡æ˜¯å‡å°ä¹‹å‰æ¨¡å‹çš„æ®‹å·®ï¼Œåœ¨æ®‹å·®å‡å°çš„æ–¹å‘ï¼ˆè´Ÿæ¢¯åº¦æ–¹å‘ï¼‰å»ºç«‹ä¸€ä¸ªæ–°çš„æ¨¡å‹ã€‚&lt;/p&gt;

&lt;p&gt;ä¾‹å¦‚ï¼š&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;å‡è®¾æ ·æœ¬$[(1,2,3), 4]$ï¼Œå…¶ä¸­$(1,2,3)$æ˜¯æ ·æœ¬ç‰¹å¾ï¼Œ$4$æ˜¯æ ·æœ¬æ ‡ç­¾&lt;/p&gt;

  &lt;p&gt;å‡è®¾æ¨¡å‹$m_i$åœ¨ä¸Šè¿°æ ·æœ¬ä¸Šçš„é¢„æµ‹ç»“æœæ˜¯$3.6$&lt;/p&gt;

  &lt;p&gt;åˆ™æ¨¡å‹$m_{i+1}$çš„æ‹Ÿåˆç›®æ ‡å°±å˜ä¸ºï¼š$[(1,2,3), 0.4]$&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;æŒ‰ä¸Šè¿°æ–¹å¼å¾—åˆ°ä¸€ç³»åˆ—åŸºæ¨¡å‹åï¼ŒGBDTçš„é¢„æµ‹å€¼å°±æ˜¯æ ·æœ¬åœ¨æ‰€æœ‰åŸºæ¨¡å‹ä¸Šçš„ç»“æœçš„&lt;strong&gt;åŠ å’Œ&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨å›å½’ä»»åŠ¡ä¸­ï¼Œæ¯ä¸€æ¬¡è¿­ä»£ä¸­å¯¹æ¯ä¸€ä¸ªæ ·æœ¬éƒ½æœ‰ä¸€ä¸ªé¢„æµ‹å€¼ï¼ŒæŸå¤±å‡½æ•°ä½¿ç”¨MSEï¼ˆå‡æ–¹è¯¯å·®æŸå¤±ï¼‰ï¼š$l(y_i,\hat{y_i})=\frac{1}{2}(y_i-\hat{y_i})^2$ï¼Œå¯¹æŸå¤±è®¡ç®—æ¢¯åº¦å–è´Ÿï¼š$-[\frac{\partial l(y_i,\hat{y_i})}{\partial \hat{y_i}}]=(y_i-\hat{y_i})$ã€‚&lt;/p&gt;

&lt;p&gt;ç”±ä¸Šè¿°ç»“æœå¯çŸ¥ï¼Œå½“æŸå¤±å‡½æ•°ä½¿ç”¨MSEæ—¶ï¼Œæ¯ä¸€æ¬¡æ‹Ÿåˆçš„å€¼å°±æ˜¯åŸºæ¨¡å‹çš„çœŸå®å€¼å‡é¢„æµ‹å€¼ï¼Œä¹Ÿå³â€œæ®‹å·®â€ã€‚&lt;/p&gt;

&lt;h2 id=&quot;ä¸‰xgboost&quot;&gt;ä¸‰ã€XGBoost&lt;/h2&gt;

&lt;p&gt;XGBoostæ˜¯ä¸€ä¸ªé«˜æ•ˆã€çµæ´»ã€å¯ç§»æ¤çš„åˆ†å¸ƒå¼æ¢¯åº¦æå‡å·¥å…·åŒ…ã€‚æ˜¯ä¸€ç§åŸºäºæ¢¯åº¦æå‡æ¡†æ¶çš„å¹¶è¡ŒåŒ–çš„æå‡æ ‘å®ç°æ–¹æ¡ˆã€‚&lt;/p&gt;

&lt;p&gt;XGBoostçš„æ€æƒ³æ˜¯ï¼Œä¸æ–­åœ°åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­æ·»åŠ æ ‘ï¼Œåˆ©ç”¨ç‰¹å¾åˆ†è£‚æ¥ç”Ÿé•¿ä¸€æ£µæ ‘ï¼Œæ·»åŠ æ ‘çš„è¿‡ç¨‹å°±æ˜¯æ‹Ÿåˆä¸€ä¸ªæ–°å‡½æ•°çš„è¿‡ç¨‹ï¼Œè¿™ä¸ªæ–°å‡½æ•°çš„æ‹Ÿåˆå¯¹è±¡æ˜¯ä¸Šä¸€æ¬¡é¢„æµ‹ç»“æœçš„æ®‹å·®ã€‚&lt;/p&gt;

\[\hat{y}=\phi(x_i)=\sum_\limits{k=1}^Kf_k(x_i)\]

&lt;p&gt;è®­ç»ƒå®Œæˆåå¾—åˆ°$K$æ£µæ ‘ï¼Œé’ˆå¯¹ä¸€ä¸ªæ ·æœ¬ï¼Œè¯¥æ ·æœ¬çš„ç‰¹å¾åœ¨$K$æ£µæ ‘ä¸Šä¼šè½åˆ°$K$ä¸ªå¶å­ç»“ç‚¹ä¸Šï¼Œå¾—åˆ°$K$ä¸ªé¢„æµ‹åˆ†æ•°ï¼Œå°†è¿™äº›åˆ†æ•°ç›¸åŠ ï¼Œå°±èƒ½å¾—åˆ°è¯¥æ ·æœ¬çš„é¢„æµ‹å€¼ã€‚&lt;/p&gt;

&lt;h3 id=&quot;31-xgboostçš„ç›®æ ‡å‡½æ•°å’Œè¯¯å·®&quot;&gt;3.1 XGBoostçš„ç›®æ ‡å‡½æ•°å’Œè¯¯å·®&lt;/h3&gt;

&lt;p&gt;å°†XGBoostçš„è¯¯å·®å¯ä»¥ç®€å†™å¦‚ä¸‹ï¼š&lt;/p&gt;

\[L(\phi)=\sum_\limits{i}l(\hat{y_i}-y_i)+\sum_\limits{t}\Omega(f_t)\]

&lt;p&gt;æŸå¤±å‡½æ•°åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œç¬¬ä¸€éƒ¨åˆ†ä¸ºè¯¯å·®å‡½æ•°ï¼Œè¯¯å·®å‡½æ•°åæ˜ äº†å½“å‰æ¨¡å‹å¯¹æ•°æ®çš„æ‹Ÿåˆç¨‹åº¦ï¼Œå…¶ä¸­$y_i$è¡¨ç¤ºç¬¬$i$ä¸ªæ ·æœ¬çš„çœŸå®å€¼ï¼Œ$\hat{y_i}$æ˜¯æ‰€æœ‰åŸºæ¨¡å‹çš„è¾“å‡ºç´¯åŠ ï¼›ç¬¬äºŒéƒ¨åˆ†ä¸ºæ­£åˆ™åŒ–é¡¹ï¼Œæ­£åˆ™åŒ–é¡¹å®šä¹‰äº†æ¨¡å‹çš„å¤æ‚åº¦ã€‚&lt;/p&gt;

&lt;h4 id=&quot;311-è¯¯å·®å‡½æ•°&quot;&gt;3.1.1 è¯¯å·®å‡½æ•°&lt;/h4&gt;

&lt;p&gt;è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œç¬¬$t$è½®çš„æ¨¡å‹é¢„æµ‹å€¼$\hat{y}^{(t)}=\hat{y}^{(t-1)}+\epsilon f_t(x_i)$ï¼Œå…¶ä¸­$\epsilon$ä¸ºç¼©å‡å› å­ï¼ˆshrinkageï¼‰ï¼Œæ˜¯ä¸ºäº†é˜²æ­¢è¿‡æ‹Ÿåˆè€Œè®¾ç½®çš„ï¼Œä¸€èˆ¬å–$0.1$ï¼ˆä¸ºç®€å•èµ·è§ï¼Œä»¥ä¸‹æ¨å¯¼ç•¥å»$\epsilon$ï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;è¯¯å·®å‡½æ•°å¯ä»¥è®°ä¸ºï¼š$l(y_i,\hat{y}^{(t-1)},f_t(x_i))$ï¼Œç¬¬$t$è½®è®­ç»ƒçš„ç›®æ ‡æ˜¯å­¦ä¹ å‡½æ•°$f_t$ï¼Œè‡³æ­¤ï¼ŒXGBoostçš„ç›®æ ‡å‡½æ•°$Obj^{(t)}$å¯ä»¥å†™ä¸ºï¼š&lt;/p&gt;

\[Obj^{(t)}=\sum\limits_{i=1}^n(l(y_i,\hat{y}^{(t-1)},f_t(x_i))   +  \Omega(f_t))   +constant\]

&lt;p&gt;ä¸Šé¢æåˆ°ï¼Œå½“æŸå¤±å‡½æ•°$l(\cdot)$ä¸ºMSEæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æ¨å¯¼å‡ºï¼ŒæŸå¤±å‡½æ•°çš„è´Ÿæ¢¯åº¦æ–¹å‘å³æ˜¯æ®‹å·®ï¼Œé‚£ä¹ˆï¼Œå½“æŸå¤±å‡½æ•°æ˜¯å…¶ä»–å½¢å¼çš„å‡½æ•°å‘¢ï¼Ÿ&lt;/p&gt;

&lt;p&gt;XGBoostæå‡ºï¼Œå¯¹äºå…¶ä»–å½¢å¼çš„æŸå¤±å‡½æ•°ï¼Œåˆ™ä½¿ç”¨ä¸€ä¸ªäºŒæ¬¡å‡½æ•°æ¥è¿‘ä¼¼ï¼Œè¿™é‡Œä½¿ç”¨æ³°å‹’å±•å¼€çš„æ–¹å¼ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;å›é¡¾æ³°å‹’å®šç†ï¼š&lt;/p&gt;

  &lt;p&gt;è®¾æœ‰åœ¨$a$ç‚¹æ‰€åœ¨åŒºé—´ä¸Š$n+1$é˜¶å¯å¯¼çš„å‡½æ•°$f(x)$ï¼Œåˆ™å¯¹è¿™ä¸ªåŒºé—´ä¸Šçš„ä»»æ„$x$ï¼Œéƒ½æœ‰å¦‚ä¸‹æ³°å‹’å±•å¼€å½¢å¼ï¼š&lt;/p&gt;

\[f(x)=f(a)+\frac{f'(a)}{1!}(x-a) +    \frac{f^{(2)}(a)}{2!}(x-a)^2+\cdot \cdot \cdot +   \frac{f^{(n)}(a)}{n!}(x-a)^n + R_n(x)\]

  &lt;p&gt;å…¶ä¸­ï¼Œ$R_n(x)$ä¸ºä½™é¡¹ï¼Œæ˜¯$(x-a)^n$çš„é«˜é˜¶æ— ç©·å°ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;åœ¨XGBoostä¸­ï¼Œå¯¹æŸå¤±å‡½æ•°è¿›è¡Œäº†äºŒé˜¶æ³°å‹’å±•å¼€ï¼š&lt;/p&gt;

\[f(x+\Delta x) \simeq f(x)+f^{\prime}(x) \Delta x+\frac{1}{2} f^{\prime \prime}(x) \Delta x^{2}\]

&lt;p&gt;å®šä¹‰$g_{i}=\partial_{\hat{y}^{(t-1)}} l\left(y_{i}, \hat{y}^{(t-1)}\right), \quad h_{i}=\partial_{\hat{y}^{(t-1)}}^{2}l\left(y_{i}, \hat{y}^{(t-1)}\right)$&lt;/p&gt;

&lt;p&gt;å°†$l(y_i,c+f_t(x_i))$ä¸­çš„$\hat{y_i}^{(t-1)}$çœ‹ä½œäºŒé˜¶æ³°å‹’å±•å¼€å¼ä¸­çš„$x$ï¼›å°†$f_t(x_i)$çœ‹ä½œå±•å¼€å¼ä¸­çš„$\Delta x$ï¼Œåˆ™ç›®æ ‡å‡½æ•°å¯ä»¥è¿‘ä¼¼å†™ä¸ºï¼š&lt;/p&gt;

\[Obj^{(t)} \simeq \sum_{i=1}^{n}\left[l\left(y_{i}, \hat{y}_{i}^{(t-1)}\right)+g_{i} f_{t}\left(x_{i}\right)+\frac{1}{2} h_{i} f_{t}^{2}\left(x_{i}\right)\right]+\Omega\left(f_{t}\right)+\text { constant }\]

&lt;p&gt;åœ¨ä¸Šå¼ä¸­ï¼Œ$l\left(y_{i}, \hat{y}_{i}^{(t-1)}\right)$ä¸ºæ ·æœ¬çš„çœŸå®æ ‡ç­¾å’Œç¬¬$t-1$æ¬¡é¢„æµ‹çš„æ®‹å·®ï¼Œæ˜¯ä¸€ä¸ªå·²çŸ¥çš„æ•°å€¼ï¼Œä¸å½±å“ç¬¬$t$è½®çš„ä¼˜åŒ–ï¼Œå¸¸æ•°é¡¹ä¹Ÿå¯ä»¥ç§»é™¤ï¼Œå› æ­¤ï¼Œç›®æ ‡å‡½æ•°å¯ä»¥é‡å†™ä¸ºï¼š&lt;/p&gt;

\[Obj^{(t)}=\sum_\limits{i=1}^{n}[g_{i} f_{t(x_{i})}+\frac{1}{2} h_{i} f_{t}^{2}(x_{i})]+\Omega (f_{t})\]

&lt;p&gt;å…¶ä¸­ï¼Œ$g_{i}=\partial_{\hat{y}^{(t-1)}} l\left(y_{i}, \hat{y}^{(t-1)}\right), \quad h_{i}=\partial_{\hat{y}^{(t-1)}}^{2}l\left(y_{i}, \hat{y}^{(t-1)}\right)$ã€‚&lt;/p&gt;

&lt;p&gt;å¯ä»¥çœ‹å‡ºï¼Œç›®æ ‡å‡½æ•°ä»…ä¾èµ–æ¯ä¸ªæ ·æœ¬åœ¨è¯¯å·®å‡½æ•°ä¸Šçš„ä¸€é˜¶å¯¼æ•°$g$å’ŒäºŒé˜¶å¯¼æ•°$h$ï¼Œè¿™é‡Œä¹Ÿæç¤ºäº†XGBoostä¸GBDTåœ¨ç›®æ ‡å‡½æ•°çš„ä¸€ä¸ªå·®åˆ«ï¼šXGBoostè€ƒè™‘äº†è¯¯å·®å‡½æ•°çš„äºŒé˜¶å¯¼æ•°ã€‚&lt;/p&gt;

&lt;h4 id=&quot;312-æ­£åˆ™åŒ–é¡¹&quot;&gt;3.1.2 æ­£åˆ™åŒ–é¡¹&lt;/h4&gt;

&lt;p&gt;åœ¨æ ‘æ¨¡å‹ä¸­ï¼Œæ­£åˆ™åŒ–é¡¹çš„åŠ å…¥ä¸€èˆ¬æ˜¯ä¸ºäº†æ§åˆ¶æ ‘çš„è§„æ¨¡ã€‚XGBoostç›®æ ‡å‡½æ•°çš„æ­£åˆ™åŒ–é¡¹çš„å®šä¹‰å¦‚ä¸‹ï¼š&lt;/p&gt;

\[\Omega(f)=\gamma T+\frac{1}{2} \lambda\Vert w\Vert^2\]

&lt;p&gt;å…¶ä¸­ï¼Œ$T$è¡¨ç¤ºå¶å­ç»“ç‚¹çš„ä¸ªæ•°ï¼Œ$w$è¡¨ç¤ºå¶å­ç»“ç‚¹çš„åˆ†æ•°ï¼Œå°†äºŒè€…ä½œä¸ºæƒ©ç½šé¡¹æ—¶ï¼Œå³è¦æ±‚åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œç”Ÿæˆçš„æ ‘çš„å¶å­ç»“ç‚¹å°½å¯èƒ½å°‘ï¼Œä¸”å¶å­ç»“ç‚¹çš„æ•°å€¼ä¸ä¼šè¿‡å¤§ï¼Œä»è€Œè¾¾åˆ°é˜²æ­¢è¿‡æ‹Ÿåˆçš„ç›®çš„ã€‚&lt;/p&gt;

&lt;h4 id=&quot;313-xgboostçš„ç›®æ ‡å‡½æ•°&quot;&gt;3.1.3 XGBoostçš„ç›®æ ‡å‡½æ•°&lt;/h4&gt;

&lt;p&gt;å›é¡¾ä¸Šé¢å¾—åˆ°çš„ç›®æ ‡å‡½æ•°çš„è¡¨è¾¾å¼ï¼š&lt;/p&gt;

\[Obj^{(t)}=\sum_\limits{i=1}^{n}[g_{i} f_{t(x_{i})}+\frac{1}{2} h_{i} f_{t}^{2}(x_{i})]+\Omega (f_{t})\]

&lt;p&gt;å…¶ä¸­$f_t(x)$å¯ä»¥å†™ä¸ºï¼š&lt;/p&gt;

\[f_t(x)=w_{q(x)},\quad w\in\mathrm{R}^T,q:\mathrm{R}^d \rightarrow\{1,2,...,T\}\]

&lt;p&gt;$w$è¡¨ç¤ºæ ‘çš„å¶å­ç»“ç‚¹çš„æƒé‡ï¼Œ$q$è¡¨ç¤ºæ ‘çš„ç»“æ„ï¼Œç»™å®šä¸€ä¸ªè¾“å…¥ï¼Œç»“æ„å‡½æ•°å°†å…¶&lt;strong&gt;æ˜ å°„&lt;/strong&gt;åˆ°å¶å­ç»“ç‚¹çš„ç´¢å¼•ï¼Œå†é€šè¿‡æƒé‡å‘é‡$w$ï¼ˆå¯ä»¥çœ‹åˆ°æƒé‡å‘é‡çš„ç»´åº¦ä¸ºå¶å­ç»“ç‚¹çš„ä¸ªæ•°ï¼‰ï¼Œå¾—åˆ°å¯¹åº”çš„å¶å­ç»“ç‚¹çš„åˆ†æ•°ã€‚&lt;/p&gt;

&lt;p&gt;ç”±ä»¥ä¸Šå®šä¹‰ï¼Œå¯ä»¥å°†ä¸Šè¿°ç›®æ ‡å‡½æ•°ä¿®æ”¹ä¸ºï¼š&lt;/p&gt;

\[\begin{aligned} Obj^{(t)}
&amp;amp; \simeq \sum_\limits{i=1}^n[g_i f_t(x_i)+\frac{1}{2}h_i f_t^2(x_i)] + \Omega(f_t) \\
&amp;amp;=\sum_{j=1}^{T}\left[\left(\sum_{i \in I_{j}} g_{i}\right) w_{j}+\frac{1}{2}\left(\sum_{i \in I_{j}} h_{i}+\lambda\right) w_{j}^{2}\right]+\gamma T
\end{aligned}\]

&lt;p&gt;å…¶ä¸­$I_j$å®šä¹‰ä¸ºæ¯ä¸ªå¶å­èŠ‚ç‚¹$j$ä¸Šé¢æ ·æœ¬ç´¢å¼•çš„é›†åˆï¼š$I_{j}={i \mid q(x_{i})=j}$ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸€æ­¥çš„ç›®æ ‡å‡½æ•°çš„è½¬æ¢æœ‰ä¸¤ç§ç´¯åŠ å½¢å¼ï¼Œç¬¬ä¸€ä¸ªæ˜¯æ ·æœ¬è§’åº¦çš„ç´¯åŠ ï¼Œé€šè¿‡å¼•å…¥$f_t(x)=w_{q(x)}$åï¼Œè½¬åŒ–ä¸ºå¶å­ç»“ç‚¹ä¸ªæ•°çš„ç´¯åŠ ã€‚ï¼ˆå›å¿†å‰è¿°å®šä¹‰çš„æ ‘ç»“æ„æ˜ å°„$q$ï¼Œå…¶èƒ½å¤Ÿå°†æ ·æœ¬$x_i$æ˜ å°„åˆ°æ ‘çš„ä¸€ä¸ªå¶å­ç»“ç‚¹ä¸Šã€‚ï¼‰&lt;/p&gt;

&lt;p&gt;åœ¨ä¸Šè¿°ç›®æ ‡å‡½æ•°ä¸Šï¼Œå®šä¹‰$G_j=\sum_\limits{i \in I_{j}} g_{i}$ï¼Œ$H_j=\sum_\limits{i \in I_{j}} h_{i}$ï¼Œå°†ç›®æ ‡å‡½æ•°ç®€å†™ä¸ºï¼š&lt;/p&gt;

\[Obj^{(t)}=\sum_\limits{j=1}^T[G_jw_j+\frac{1}{2}(H_j+\lambda)w_j^2]+\gamma T\]

&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªäºŒæ¬¡å‡½æ•°çš„æœ€ä¼˜åŒ–é—®é¢˜ï¼Œè¦è®¡ç®—$w_j$ï¼Œå¯ä»¥å°†ç›®æ ‡å‡½æ•°å¯¹$w_j$æ±‚åå¯¼åå¦ä¸º$0$ï¼Œå¯å¾—ï¼š&lt;/p&gt;

\[w_j^*=-\frac{G_j}{H_j+\lambda}\]

&lt;p&gt;å°†æœ€ä¼˜$w_j$ä»£å›ç›®æ ‡å‡½æ•°è¡¨è¾¾å¼ï¼Œæœ‰ï¼š&lt;/p&gt;

\[Obj=-\frac{1}{2} \sum_\limits{j=1}^{T} \frac{G_{j}^{2}}{H_{j}+\lambda}+\gamma T\]

&lt;h3 id=&quot;32-xgboostèŠ‚ç‚¹åˆ†è£‚&quot;&gt;3.2 XGBoostèŠ‚ç‚¹åˆ†è£‚&lt;/h3&gt;

&lt;p&gt;å‰é¢æˆ‘ä»¬å®šä¹‰äº†XGBoostçš„ç›®æ ‡å‡½æ•°$Obj$ï¼Œå®ƒæè¿°äº†åœ¨ç»™å®šæ ‘ç»“æ„çš„æƒ…å†µä¸‹ï¼Œç›®æ ‡å‡½æ•°æ‰€èƒ½å‡å°‘çš„æœ€å¤§å¹…åº¦ã€‚æˆ‘ä»¬å¯ä»¥å°†å…¶ç§°ä¸ºâ€œç»“æ„åˆ†æ•°ï¼ˆstructure scoreï¼‰â€ï¼ŒåŸºäºæ­¤ï¼Œæ¥ä¸‹æ¥è®¨è®ºä¸€ä¸‹XGBooståœ¨å»ºæ ‘è¿‡ç¨‹ä¸­çš„ä¸€äº›ç»†èŠ‚ã€‚&lt;/p&gt;

&lt;h4 id=&quot;321-xgboostèŠ‚ç‚¹åˆ†è£‚æ–¹å¼&quot;&gt;3.2.1 XGBoostèŠ‚ç‚¹åˆ†è£‚æ–¹å¼&lt;/h4&gt;

&lt;p&gt;åœ¨æ ‘æ¨¡å‹ä¸­ï¼Œä¸€æ£µæ ‘æ˜¯ç”±èŠ‚ç‚¹ä¸€åˆ†ä¸ºäºŒã€ç”Ÿæˆçš„å­èŠ‚ç‚¹ç»§ç»­åˆ†è£‚åé€æ¸å½¢æˆçš„ã€‚é‚£ä¹ˆXGBoostä¸­èŠ‚ç‚¹çš„åˆ†è£‚æ–¹å¼æœ‰å“ªäº›å‘¢ï¼Ÿ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;1ï¼‰è´ªå¿ƒåœ°æšä¸¾æ‰€æœ‰æ ‘çš„ç»“æ„&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ç”±äºä¸Šæ–‡å¯çŸ¥ï¼Œåœ¨ç¡®å®šäº†ä¸€ä¸ªæ ‘çš„ç»“æ„åï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥è®¡ç®—å‡ºè¯¥ç»“æ„ä¸‹&lt;strong&gt;æœ€å¥½çš„&lt;/strong&gt;åˆ†æ•°ã€‚é‚£ä¹ˆä¸€ä¸ªç›´è§‚çš„æƒ³æ³•æ˜¯ï¼Œæšä¸¾ä¸åŒçš„æ ‘ç»“æ„ï¼Œæ ¹æ®æ‰“åˆ†å‡½æ•°ç¡®å®šä¸€ä¸ªå…·æœ‰æœ€ä¼˜ç»“æ„çš„æ ‘ï¼Œå¹¶å°†å…¶åŠ å…¥æ¨¡å‹å½“ä¸­ã€‚ä½†è¿™ä¸ªè¿‡ç¨‹çš„å¯èƒ½æ€§å‡ ä¹æ˜¯æ— ç©·å¤šç§ï¼Œæˆ‘ä»¬å¯ä»¥ä»¥è´ªå¿ƒçš„æ–¹å¼æ¥æ„å»ºï¼Œæ¯”å¦‚ï¼Œä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œéå†æ‰€æœ‰çš„ç‰¹å¾ï¼Œé’ˆå¯¹æ¯ä¸€ä¸ªç‰¹å¾ï¼Œ**å…ˆå¯¹è¯¥ç‰¹å¾æŒ‰ç…§å–å€¼æ’åº **ï¼Œç„¶åè¿›è¡Œçº¿æ€§æ‰«æï¼Œè·å¾—æœ€å¥½çš„åˆ†å‰²ç‚¹ï¼Œè®¡ç®—ç”±è¿™ä¸ªç‰¹å¾åŠ å…¥æ‰€å¸¦æ¥çš„å¢ç›Šï¼ˆGainï¼‰ï¼Œç„¶åé€‰å–å¢ç›Šæœ€å¤§çš„ç‰¹å¾ä½œä¸ºå½“å‰èŠ‚ç‚¹çš„æœ€ç»ˆåˆ†è£‚ç‰¹å¾ã€‚å¢ç›Šçš„è®¡ç®—æ–¹å¼ä¸ºï¼š&lt;/p&gt;

\[\text { Gain }=\frac{1}{2}\left[\frac{G_{L}^{2}}{H_{L}+\lambda}+\frac{G_{R}^{2}}{H_{R}+\lambda}-\frac{\left(G_{L}+G_{R}\right)^{2}}{H_{L}+H_{R}+\lambda}\right]-\gamma\]

&lt;p&gt;è¡¨ç¤ºåˆ†ç±»åå·¦å­æ ‘çš„ç›®æ ‡å‡½æ•°åŠ ä¸Šå³å­æ ‘çš„ç›®æ ‡å‡½æ•°å‡å»ä¸åˆ†å‰²æ—¶çš„åˆ†æ•°ï¼Œå†å‡å»åŠ å…¥æ–°çš„å¶å­ç»“ç‚¹æ‰€å¸¦æ¥çš„costã€‚&lt;/p&gt;

&lt;p&gt;ä¸Šè¿°æè¿°ä¸­æœ‰ä¸¤ç‚¹éœ€è¦æ³¨æ„ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;å¯¹äºä¸€ä¸ªç‰¹å¾ï¼ŒæŒ‰ç…§å…¶å–å€¼è¿›è¡Œæ’åºï¼Œçº¿æ€§æ‰«æè®¡ç®—å¢ç›Š&lt;/p&gt;

    &lt;p&gt;è¿™é‡Œä¸¾ä¸€ä¸ªä¾‹å­ï¼Œå‡è®¾å¯¹å¹´é¾„è¿™ä¸ªç‰¹å¾ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ç…§å¹´é¾„çš„å¤§å°å¯¹æ ·æœ¬è¿›è¡Œæ’åºã€‚å‡è®¾æœ‰äº”ä¸ªäºº$A,B,C,D,E$ï¼Œåˆ™åˆ’åˆ†æ–¹å¼æœ‰ä»¥ä¸‹å››ç§ï¼ˆä½¿ç”¨â€œ$\mid$â€ç¬¦å·è¡¨ç¤ºåˆ’åˆ†ï¼‰ï¼š&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;$A\mid B,C,D,E$&lt;/li&gt;
      &lt;li&gt;$A,B\mid C,D,E$&lt;/li&gt;
      &lt;li&gt;$A,B,C\mid  D,E$&lt;/li&gt;
      &lt;li&gt;$A,B,C,D\mid E$&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;æ¯ä¸€ç§åˆ’åˆ†å‡å°†æ ·æœ¬åˆ†æˆä¸¤ä¸ªå­é›†ï¼Œé’ˆå¯¹æ¯ä¸ªå­é›†ï¼ŒæŒ‰ç…§å¢ç›Šçš„è®¡ç®—æ–¹å¼ï¼Œè®¡ç®—å‡ºå¯¹åº”çš„åˆ†æ•°å³å¯ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;å¼•å…¥åˆ†å‰²ä¸ä¸€å®šä½¿æƒ…å†µå˜å¾—æ›´å¥½&lt;/p&gt;

    &lt;p&gt;åœ¨ä¸€äº›æƒ…å†µä¸‹ï¼Œå¯èƒ½å‡ºç°åˆ†å‰²åçš„å¢ç›Šå¤ªå°çš„æƒ…å†µï¼Œè¿™ç§åˆ†å‰²ä¼šå¢å¤§æ¨¡å‹çš„å¤æ‚åº¦ï¼Œå¾—ä¸å¿å¤±ï¼Œé’ˆå¯¹è¿™ç§æƒ…å†µï¼ŒXGBoostå¢åŠ äº†æœ‰å…³å¶å­ç»“ç‚¹çš„æƒ©ç½šé¡¹$\gamma$ï¼Œå³å½“åˆ†å‰²æ‰€å¸¦æ¥çš„æ”¶ç›Šå°äº$\gamma$æ—¶ï¼Œå–æ¶ˆæ­¤æ¬¡åˆ†å‰²ï¼Œè¿™é‡Œç›¸å½“äºå¯¹æ ‘åšäº†é¢„å‰ªæã€‚&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;strong&gt;2ï¼‰è¿‘ä¼¼ç®—æ³•&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;å½“æ•°æ®å¤ªå¤§ï¼Œæ— æ³•è¿›è¡Œç›´æ¥è®¡ç®—æ—¶ï¼Œé‡‡ç”¨è¿‘ä¼¼ç®—æ³•ã€TODOã€‘&lt;/p&gt;

&lt;h4 id=&quot;322-åœæ­¢åˆ†è£‚æ¡ä»¶&quot;&gt;3.2.2 åœæ­¢åˆ†è£‚æ¡ä»¶&lt;/h4&gt;

&lt;p&gt;åœæ­¢åˆ†è£‚æ¡ä»¶å®šä¹‰äº†è¿­ä»£ç®—æ³•çš„ç»ˆæ­¢æ¡ä»¶ï¼Œä¸€èˆ¬åœ°ï¼ŒXGBoostè®¾ç½®çš„åœæ­¢åˆ†è£‚æ¡ä»¶æœ‰å¦‚ä¸‹å‡ ç§ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;å½“å¼•å…¥çš„åˆ†è£‚å¸¦æ¥çš„å¢ç›Šå°äºç»™å®šé˜ˆå€¼çš„æ—¶å€™ï¼Œå–æ¶ˆæ­¤æ¬¡åˆ†è£‚ï¼Œè¿™é‡Œç›¸å½“äºé¢„å‰ªæ&lt;/li&gt;
  &lt;li&gt;è®¾ç½®ä¸€ä¸ªæ ‘çš„æœ€å¤§æ·±åº¦å‚æ•°max_depthï¼Œå½“åˆ†è£‚è¿›è¡Œåˆ°æ­¤æ·±åº¦æ—¶åˆ™åœæ­¢åˆ†è£‚ï¼Œé˜²æ­¢è¿‡æ‹Ÿåˆ&lt;/li&gt;
  &lt;li&gt;å½“æ ·æœ¬æƒé‡å°äºç»™å®šé˜ˆå€¼æ—¶ï¼Œåœæ­¢å»ºæ ‘ï¼Œè®¾ç½®ä¸€ä¸ªå‚æ•°min_child_weightï¼Œå½“ä¸€ä¸ªå¶å­ç»“ç‚¹åŒ…å«çš„æ ·æœ¬æ•°é‡è¿‡å°‘æ—¶ï¼Œåœæ­¢åˆ†è£‚&lt;/li&gt;
  &lt;li&gt;æ ‘çš„æœ€å¤§æ•°é‡&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;å‚è€ƒ&quot;&gt;å‚è€ƒ&lt;/h2&gt;

&lt;ol&gt;
  &lt;li&gt;ç»Ÿè®¡å­¦ä¹ æ–¹æ³•&lt;/li&gt;
  &lt;li&gt;https://blog.csdn.net/v_JULY_v/article/details/81410574&lt;/li&gt;
&lt;/ol&gt;

</description>
        <pubDate>Sun, 28 Mar 2021 20:52:03 +0800</pubDate>
        <link>http://localhost:4000//2021/03/XGBoost%E7%90%86%E8%A7%A3</link>
        <guid isPermaLink="true">http://localhost:4000//2021/03/XGBoost%E7%90%86%E8%A7%A3</guid>
        
        <category>Machine Learning</category>
        
        <category>Boosting</category>
        
        
        <category>NLP</category>
        
      </item>
    
      <item>
        <title>é›†æˆå­¦ä¹ å°ç»“</title>
        <description>&lt;p&gt;é›†æˆå­¦ä¹ ä¸»è¦æœ‰ä¸¤ä¸ªæ€è·¯ï¼ŒBaggingå’ŒBoostingã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Bagging&lt;/p&gt;

    &lt;p&gt;ç‹¬ç«‹è®­ç»ƒï¼ˆå¯å¹¶è¡Œï¼‰å¤šä¸ªåŸºåˆ†ç±»å™¨ï¼Œä½¿ç”¨æŠ•ç¥¨æ³•æˆ–è€…å¹³å‡æ³•é›†æˆæ‰€æœ‰åŸºåˆ†ç±»å™¨çš„ç»“æœã€‚&lt;/p&gt;

    &lt;p&gt;baggingçš„ç›®æ ‡æ˜¯ä¸ºäº†å‡å°æ–¹å·®ã€‚&lt;/p&gt;

    &lt;p&gt;å…¸å‹ç®—æ³•ï¼šRandomForest&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Boosting&lt;/p&gt;

    &lt;p&gt;ä¸ºæ¯ä¸ªæ ·æœ¬èµ‹ä¸€ä¸ªç›¸åŒçš„æƒé‡ï¼Œåœ¨ä¸€æ¬¡è¿­ä»£ä¸­ï¼Œä¸€ä¸ªåŸºæ¨¡å‹å¯¹æ ·æœ¬çš„ä¼°è®¡æœ‰å¯¹æœ‰é”™ï¼Œå¯¹äºåˆ†é”™çš„æ ·æœ¬ï¼Œå¢åŠ å…¶æƒé‡ï¼Œåˆ†å¯¹çš„æ ·æœ¬ï¼Œåˆ™å‡å°‘å…¶æƒé‡ã€‚åœ¨è¿›è¡ŒNæ¬¡è¿­ä»£åï¼Œå¾—åˆ°Nä¸ªç®€å•çš„åˆ†ç±»å™¨ï¼ˆbasic learnerï¼‰ï¼Œå°†è¿™äº›åˆ†ç±»å™¨é€šè¿‡æƒé‡è¿›è¡Œç»„åˆï¼Œå³æ˜¯boostingæ¨¡å‹ï¼ˆæ–¹æ³• ï¼‰ã€‚&lt;/p&gt;

    &lt;p&gt;å…¸å‹ç®—æ³•ï¼šAdaboostã€GBDTã€XGBoostã€LightGBMã€CatBoost&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä¸‹æ–‡å¯¹ä¸Šè¿°Boostingå’ŒBaggingå…¸å‹ç®—æ³•çš„æ€æƒ³ã€å®ç°æ–¹å¼å’Œä¼˜ç¼ºç‚¹è¿›è¡Œæ€»ç»“å¯¹æ¯”ã€‚&lt;/p&gt;

&lt;h2 id=&quot;randomforest&quot;&gt;RandomForest&lt;/h2&gt;

&lt;p&gt;RFæ˜¯baggingçš„æ‰©å±•ï¼Œä»¥CARTä¸ºåŸºå­¦ä¹ å™¨ï¼Œå­¦ä¹ è¿‡ç¨‹ä¸ºï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;éšæœºé€‰æ‹©æ ·æœ¬ï¼ˆæœ‰æ”¾å›æŠ½æ ·ï¼‰&lt;/p&gt;

    &lt;p&gt;éšæœºé€‰æ‹©æ ·æœ¬æ˜¯baggingçš„ç‰¹ç‚¹&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;éšæœºé€‰æ‹©ç‰¹å¾&lt;/strong&gt;&lt;/p&gt;

    &lt;p&gt;ä»…é€‰æ‹©$\sqrt{n}$ä¸ªç‰¹å¾è¿›è¡Œå†³ç­–æ ‘çš„ç”Ÿæˆï¼ˆä¼šä¸€å®šç¨‹åº¦ä¸Šå¢å¤§åå·®ï¼‰ï¼Œå¤šæ£µå†³ç­–æ ‘ä¼šä½¿å¾—RFçš„æ–¹å·®é™ä½&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;æ„å»ºå†³ç­–æ ‘&lt;/p&gt;

    &lt;p&gt;æ„å»ºå†³ç­–æ ‘æ—¶ï¼Œæ¯æ£µå†³ç­–æ ‘éƒ½æœ€å¤§å¯èƒ½çš„è¿›è¡Œç”Ÿæˆè€Œä¸è¿›è¡Œå‰ªæã€‚&lt;/p&gt;

    &lt;p&gt;å¤šä¸ªå†³ç­–æ ‘æŠ•ç¥¨/å¹³å‡ï¼š&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;åˆ†ç±»ï¼šç®€å•æŠ•ç¥¨æ³•&lt;/li&gt;
      &lt;li&gt;å›å½’ï¼šç®€å•å¹³å‡&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ä¼˜ç‚¹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;æ¨¡å‹æ–¹å·®å°ï¼Œé¢„æµ‹å‡†ç¡®æ€§é«˜&lt;/li&gt;
  &lt;li&gt;æ ‘æ„å»ºå¯å¹¶è¡ŒåŒ–ï¼Œæ— éœ€å‰ªæï¼Œå¤§æ•°æ®é›†ã€ç‰¹å¾æ•°é‡å¤§æ—¶ä¾ç„¶é€‚ç”¨&lt;/li&gt;
  &lt;li&gt;æ— éœ€ç‰¹å¾é€‰æ‹©ï¼Œå¯ä»¥ç»™å‡ºç‰¹å¾é‡è¦æ€§&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç¼ºç‚¹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å®¹æ˜“è¿‡æ‹Ÿåˆ&lt;/li&gt;
  &lt;li&gt;å–å€¼åˆ’åˆ†è¾ƒå¤šçš„å±æ€§å¯¹RFçš„å½±å“æ›´å¤§ï¼Œè¿™ç§å±æ€§æƒé‡å¹¶ä¸å¯é &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;RFçš„é‡è¦ç‰¹æ€§æ˜¯&lt;strong&gt;ä¸ç”¨å¯¹å…¶è¿›è¡Œäº¤å‰éªŒè¯&lt;/strong&gt;æˆ–è€…ä½¿ç”¨ä¸€ä¸ªç‹¬ç«‹çš„æµ‹è¯•é›†è·å¾—æ— åä¼°è®¡ï¼ŒRFåœ¨ç”Ÿæˆçš„è¿‡ç¨‹ä¸­å¯ä»¥å¯¹è¯¯å·®è¿›è¡Œæ— åä¼°è®¡ï¼Œç”±äºæ¯ä¸ªåŸºå­¦ä¹ å™¨ä»…ä½¿ç”¨äº†è®­ç»ƒé›†ä¸­çº¦&lt;strong&gt;63.2%&lt;/strong&gt;çš„æ ·æœ¬ï¼Œå‰©ä¸‹çº¦&lt;strong&gt;36.8%&lt;/strong&gt;çš„æ ·æœ¬å¯ç”¨åšéªŒè¯é›†æ¥å¯¹æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›è¿›è¡Œè¢‹å¤–ä¼°è®¡ã€‚&lt;/p&gt;

&lt;h2 id=&quot;adaboost&quot;&gt;Adaboost&lt;/h2&gt;

&lt;p&gt;Adaboostçš„å­¦ä¹ è¿‡ç¨‹ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;åˆå§‹åŒ–æ ·æœ¬æƒé‡ï¼ˆ$N$ä¸ªæ ·æœ¬ï¼šæ¯ä¸ªæ ·æœ¬æƒé‡$\frac{1}{N}$ï¼‰ï¼ŒæŠ½æ ·å¾—åˆ°ä¸€æ‰¹æ ·æœ¬ï¼Œè®­ç»ƒç¬¬ä¸€ä¸ªåŸºåˆ†ç±»å™¨&lt;/li&gt;
  &lt;li&gt;è®¡ç®—ä¸Šä¸€ä¸ªåŸºåˆ†ç±»å™¨çš„é”™è¯¯ç‡ï¼Œè®°ä¸º$\epsilon$ï¼Œé€šè¿‡å…¶è®¡ç®—å‡ºåŸºåˆ†ç±»å™¨çš„æƒé‡ï¼š$\alpha=\frac{1}{2}\ln\frac{1-\epsilon}{\epsilon}$&lt;/li&gt;
  &lt;li&gt;æ ¹æ®åŸºåˆ†ç±»å™¨çš„åˆ†ç±»ç»“æœè°ƒæ•´æ ·æœ¬çš„æƒé‡ï¼Œæ­£ç¡®åˆ†ç±»çš„æ ·æœ¬é™ä½æƒé‡ï¼Œé”™è¯¯åˆ†ç±»çš„å¢åŠ æƒé‡ã€‚ï¼ˆæƒé‡è¶Šå¤§ï¼Œè¡¨ç¤ºåˆ†ç±»éš¾åº¦è¶Šå¤§ï¼‰ï¼ˆé€šè¿‡æ­¤ç§æ–¹å¼ï¼Œä½¿å¾—åç»­çš„åŸºåˆ†ç±»å™¨æ›´å…³æ³¨åˆ†é”™çš„æ ·æœ¬ï¼‰&lt;/li&gt;
  &lt;li&gt;å¾ªç¯æ‰§è¡Œ2ï½3æ­¥ï¼Œç›´è‡³è¯¯å·®å°äºæŸä¸€ä¸ªé˜ˆå€¼æˆ–åˆ†ç±»å™¨ä¸ªæ•°è¾¾åˆ°ä¸Šé™&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ä¼˜ç‚¹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å¯¹å¼±åˆ†ç±»å™¨è¿›è¡Œçº§è”ï¼Œæé«˜æ¨¡å‹ç²¾åº¦&lt;/li&gt;
  &lt;li&gt;å¯ä»¥ä½¿ç”¨å¤šæ ·çš„åŸºåˆ†ç±»å™¨&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç¼ºç‚¹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;åŸºåˆ†ç±»å™¨æ•°é‡ä¸å¥½ç¡®å®šï¼ˆéœ€è¦é€šè¿‡äº¤å‰éªŒè¯ç¡®å®šï¼‰&lt;/li&gt;
  &lt;li&gt;å¯¹ä¸å¹³è¡¡æ•°æ®çš„åˆ†ç±»æ•ˆæœä¸ä½³&lt;/li&gt;
  &lt;li&gt;è®­ç»ƒæ¯”è¾ƒè€—æ—¶&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;gbdtgradient-boost-decision-tree&quot;&gt;GBDTï¼ˆGradient Boost Decision Treeï¼‰&lt;/h2&gt;

&lt;p&gt;ä¸€èˆ¬çš„boostingç®—æ³•å…³æ³¨æ¯ä¸€è½®è¿­ä»£ä¸­çš„æ­£/è¯¯æ ·æœ¬çš„æƒé‡ï¼Œè€ŒGBDTçš„æ¯ä¸€æ¬¡è¿­ä»£éƒ½æ˜¯ä¸ºäº†å‡å°‘ä¸Šä¸€æ¬¡è¿­ä»£çš„&lt;strong&gt;æ®‹å·®&lt;/strong&gt;ï¼ˆé€šè¿‡åœ¨æ®‹å·®å‡å°çš„æ¢¯åº¦æ–¹å‘ä¸Šå»ºç«‹æ¨¡å‹ï¼‰ï¼Œå³åˆ©ç”¨æŸå¤±å‡½æ•°çš„è´Ÿæ¢¯åº¦æ–¹å‘åœ¨å½“å‰æ¨¡å‹çš„å€¼ä½œä¸ºæ®‹å·®çš„è¿‘ä¼¼å€¼ï¼Œè¿›è€Œæ‹Ÿåˆä¸€æ£µCART&lt;strong&gt;å›å½’æ ‘&lt;/strong&gt;ï¼ŒGBDTä¼šç´¯åŠ æ‰€æœ‰ï¼ˆå›å½’ï¼‰æ ‘çš„ç»“æœã€‚&lt;/p&gt;

&lt;p&gt;GBDTçš„æ‰§è¡Œæµç¨‹ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ä½¿ç”¨è®­ç»ƒæ ·æœ¬è®­ç»ƒç¬¬ä¸€ä¸ªå¼±åˆ†ç±»å™¨ï¼Œå¹¶å°†æ¨¡å‹ç»“æœä¸çœŸå®ç»“æœè¿›è¡Œæ¯”è¾ƒï¼Œå¾—åˆ°æ¨¡å‹çš„æ®‹å·®&lt;/li&gt;
  &lt;li&gt;ä½¿ç”¨ä¸Šä¸€æ­¥éª¤ä¸­å¾—åˆ°çš„æ®‹å·®è®­ç»ƒä¸‹ä¸€ä¸ªåˆ†ç±»å™¨ï¼Œå†æ¬¡æ¯”è¾ƒç»“æœï¼Œè®¡ç®—æ®‹å·®&lt;/li&gt;
  &lt;li&gt;å¾ªç¯æ‰§è¡Œ1ï½2æ­¥ï¼Œç›´è‡³æ®‹å·®å°äºæŸä¸€ä¸ªé˜ˆå€¼æˆ–åˆ†ç±»å™¨ä¸ªæ•°è¾¾åˆ°ä¸Šé™&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ä¼˜ç‚¹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å¯ä»¥å¤„ç†å„ç§ç±»å‹çš„æ•°æ®&lt;/li&gt;
  &lt;li&gt;è°ƒå‚æ—¶é—´è¾ƒå°‘çš„æƒ…å†µä¸‹èƒ½å¤Ÿè·å¾—è¾ƒé«˜çš„å‡†ç¡®åº¦ã€æ³›åŒ–èƒ½åŠ›å¼º&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç¼ºç‚¹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;é«˜ç»´ç¨€ç–æ•°æ®é›†ä¸Šçš„è¡¨ç°ä¸å¦‚æ”¯æŒå‘é‡æœºå’Œç¥ç»ç½‘ç»œã€æ–‡æœ¬ç‰¹å¾çš„å¤„ç†èƒ½åŠ›å¼±äºæ•°å€¼ç‰¹å¾&lt;/li&gt;
  &lt;li&gt;åŸºäºboostingæ€æƒ³ï¼Œéœ€è¦ä¸²è¡Œè®­ç»ƒï¼Œåªèƒ½åœ¨å†³ç­–æ ‘å†…éƒ¨è¿›è¡Œä¸€äº›å±€éƒ¨çš„å¹¶è¡ŒåŒ–æ‰‹æ®µ&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;xgboost&quot;&gt;XGBoost&lt;/h2&gt;

&lt;p&gt;XGBooståŸºäºGBDTï¼Œå¯ä»¥å¤„ç†åˆ†ç±»ä»»åŠ¡ï¼Œä¹Ÿå¯ä»¥å¤„ç†å›å½’ä»»åŠ¡ã€‚ä¸GBDTçš„æœ€å¤§åŒºåˆ«æ˜¯ï¼ŒXGBoostå¯¹ç›®æ ‡å‡½æ•°è¿›è¡ŒäºŒé˜¶æ³°å‹’å±•å¼€ï¼Œä»è€Œæ±‚å‡ºä¸‹ä¸€æ­¥éœ€è¦æ‹Ÿåˆçš„æ ‘çš„å¶å­ç»“ç‚¹çš„æƒé‡ã€‚&lt;/p&gt;

&lt;p&gt;XGBoostä¸GBDTçš„åŒºåˆ«ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;GBDTæ˜¯æœºå™¨å­¦ä¹ ç®—æ³•ï¼Œè€ŒXGBoostæ˜¯GBDTçš„ä¸€ç§å®ç°&lt;/li&gt;
  &lt;li&gt;åœ¨ä½¿ç”¨CARTä½œä¸ºåŸºåˆ†ç±»å™¨æ—¶ï¼ŒXGBåŠ å…¥äº†æ­£åˆ™é¡¹ï¼ˆæ ‘çš„å¶å­ç»“ç‚¹ä¸ªæ•°ã€æ¯ä¸ªå¶å­ç»“ç‚¹ä¸Šè¾“å‡ºçš„åˆ†æ•°çš„L2èŒƒæ•°çš„å¹³æ–¹å’Œï¼‰æ¥æ§åˆ¶æ¨¡å‹çš„å¤æ‚åº¦ï¼Œé˜²æ­¢è¿‡æ‹Ÿåˆ&lt;/li&gt;
  &lt;li&gt;GBDTè®­ç»ƒæ—¶ä»…ä½¿ç”¨äº†ä»£ä»·å‡½æ•°çš„ä¸€é˜¶å¯¼æ•°ï¼ŒXGBä½¿ç”¨äº†ä¸€é˜¶å’ŒäºŒé˜¶å¯¼æ•°ï¼ˆxgboostæ”¯æŒè‡ªå®šä¹‰ä»£ä»·å‡½æ•°ï¼ˆäºŒé˜¶å¯å¯¼å³å¯ï¼‰ï¼‰&lt;/li&gt;
  &lt;li&gt;åœ¨XGBä¸­æœ‰ä¸€ä¸ªShrinkageæ“ä½œï¼Œå¯¹åº”åˆ°XGBå®ç°ä¸­çš„etaå‚æ•°ï¼Œåœ¨è¿›è¡Œä¸€è½®è¿­ä»£åï¼Œå°†å¶å­ç»“ç‚¹ä¸Šçš„æƒé‡ä¹˜ä»¥è¯¥ç³»æ•°ï¼Œæ¥å‰Šå¼±å½“å‰åŸºåˆ†ç±»å™¨çš„å½±å“ï¼Œå¢å¤§åç»­çš„å­¦ä¹ ç©ºé—´ï¼ˆå®é™…æ“ä½œä¸­ï¼Œetaè®¾ç½®çš„å°ä¸€ç‚¹ï¼Œè¿­ä»£æ¬¡æ•°å¯ä»¥ç¨å¾®è®¾ç½®å¤§ä¸€äº›ï¼‰&lt;/li&gt;
  &lt;li&gt;XGBä½¿ç”¨åˆ—æŠ½æ ·æŠ€æœ¯ï¼ˆcolumn samplingï¼‰ï¼Œèƒ½å¤Ÿåœ¨å‡å°‘è®¡ç®—çš„åŒæ—¶ï¼Œå‡å¼±è¿‡æ‹Ÿåˆå€¾å‘&lt;/li&gt;
  &lt;li&gt;GBDTå¯¹ç¼ºå¤±å€¼æ²¡æœ‰å¤„ç†ï¼ŒXGBèƒ½å¤Ÿè‡ªåŠ¨å­¦ä¹ ç¼ºå¤±å€¼çš„å¤„ç†æ–¹æ³•&lt;/li&gt;
  &lt;li&gt;XGBæ”¯æŒå†³ç­–æ ‘æ„å»ºçº§åˆ«çš„å¹¶è¡ŒåŒ–ï¼Œåœ¨å†³ç­–æ ‘å­¦ä¹ è¿‡ç¨‹ä¸­ï¼Œç¡®å®šæœ€ä¼˜åˆ†å‰²ç‚¹æ—¶ï¼Œéœ€è¦å¯¹ç‰¹å¾çš„å–å€¼è¿›è¡Œæ’åºï¼ŒXGBåœ¨è®­ç»ƒä¹‹å‰å¯¹æ•°æ®ä½œäº†é¢„æ’åºå¹¶ä¿å­˜ä¸ºblockç»“æ„ï¼Œåœ¨åç»­çš„è®­ç»ƒè¿‡ç¨‹ä¸­å¤ç”¨æ­¤ç»“æ„ï¼Œå¦å¤–ï¼Œåœ¨è¿›è¡Œç»“ç‚¹åˆ†è£‚æ—¶ï¼Œè®¡ç®—å„ä¸ªç‰¹å¾çš„å¢ç›Šä¹Ÿå¯ä»¥ä½¿ç”¨å¤šçº¿ç¨‹å¹¶è¡Œè¿›è¡Œ&lt;/li&gt;
  &lt;li&gt;GBDTä½¿ç”¨CARTä½œä¸ºåŸºåˆ†ç±»å™¨ï¼ŒXGBæ”¯æŒå¤šç§ç±»å‹çš„åŸºåˆ†ç±»å™¨&lt;/li&gt;
  &lt;li&gt;GBDTæ¯æ¬¡è¿­ä»£ä½¿ç”¨å…¨éƒ¨æ•°æ®ï¼ŒXGBä½¿ç”¨è‡ªåŠ©æ³•æŠ½æ ·æ•°æ®&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ä¼˜ç‚¹ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;è®¡ç®—æ•ˆç‡é«˜ï¼Œä½¿ç”¨äºŒé˜¶å¯¼æ•°&lt;/li&gt;
  &lt;li&gt;ç¼ºç‚¹ï¼šæ¯æ¬¡è¿­ä»£éœ€è¦éå†æ•´ä¸ªæ•°æ®é›†ï¼Œå†…å­˜å ç”¨å¤§&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;lightgbm&quot;&gt;LightGBM&lt;/h2&gt;

&lt;p&gt;LGBæ˜¯ä¸€ä¸ªå®ç°äº†GBDTç®—æ³•çš„é«˜æ•ˆçš„åˆ†å¸ƒå¼æ¡†æ¶ã€‚&lt;/p&gt;

&lt;p&gt;é™ä½è®­ç»ƒå¤æ‚åº¦å¯ä»¥ä»ä¸¤ä¸ªè§’åº¦å…¥æ‰‹ï¼ˆåœ¨å°½å¯èƒ½ä¿è¯ç²¾åº¦çš„å‰æä¸‹ï¼‰ï¼šå‡å°‘ç‰¹å¾ã€å‡å°‘æ•°æ®é‡ï¼Œåœ¨LightGBMä¸­ï¼Œå¯¹åº”çš„æ‰‹æ®µæ˜¯GOSSå’ŒEFBã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;GOSSï¼ˆGradient-based One-side Samplingï¼‰&lt;/p&gt;

    &lt;p&gt;è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªæ•°æ®å®ä¾‹æ‹¥æœ‰ä¸åŒçš„æ¢¯åº¦ï¼Œæ¢¯åº¦å¤§çš„å®ä¾‹å¯¹ä¿¡æ¯å¢ç›Šçš„å½±å“æ›´å¤§ï¼Œå› æ­¤ï¼Œåœ¨ä¸‹é‡‡æ ·æ—¶åº”å°½å¯èƒ½ä¿ç•™æ¢¯åº¦å¤§çš„æ ·æœ¬ï¼ˆé€šè¿‡é˜ˆå€¼æˆ–ç™¾åˆ†æ¯”æ¥é™åˆ¶ï¼‰ï¼Œéšæœºå»æ‰æ¢¯åº¦å°çš„æ ·æœ¬ã€‚è¿™ä¸ªæŠ€æœ¯èƒ½å¤Ÿè·å¾—æ¯”éšæœºé‡‡æ ·æ›´ç²¾ç¡®çš„çš„ç»“æœã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;EFBï¼ˆExclusive Feature Bundlingï¼‰&lt;/p&gt;

    &lt;p&gt;åœ¨å®é™…åº”ç”¨ä¸­ï¼Œç‰¹å¾ä¹‹é—´å¯èƒ½å­˜åœ¨ç€äº’æ–¥çš„æƒ…å†µï¼ŒEFBå¯¹äº’æ–¥ç‰¹å¾è¿›è¡Œç»‘å®šï¼Œå°†ç»‘å®šé—®é¢˜çº¦æŸåˆ°å›¾ç€è‰²é—®é¢˜ï¼Œé€šè¿‡è´ªå¿ƒç®—æ³•æ±‚è¿‘ä¼¼è§£ï¼Œé€šè¿‡æ­¤ç§æ–¹å¼å‡å°‘äº†ç‰¹å¾çš„æ•°é‡ã€‚&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;LightGBMä¸XGBoostçš„åŒºåˆ«ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;å†…å­˜æ–¹é¢ï¼šåœ¨è®¡ç®—åˆ†ç±»ç‰¹å¾çš„å¢ç›Šæ—¶ï¼ŒXGBä½¿ç”¨é¢„æ’åºæ³•ï¼ˆpre-sortedï¼‰å¤„ç†èŠ‚ç‚¹åˆ†ç±»ï¼ˆæ¯”è¾ƒç²¾ç¡®ï¼Œä½†æ—¶é—´å¼€é”€æ¯”è¾ƒå¤§ï¼‰ï¼›LGBä½¿ç”¨åŸºäºhistogramçš„å†³ç­–æ ‘ç®—æ³•ï¼ŒèŠ‚çœäº†å†…å­˜å ç”¨ï¼ˆï½$\frac{1}{8} \cdot$pre-sortedç®—æ³•ï¼‰&lt;/li&gt;
  &lt;li&gt;æ•ˆç‡æ–¹é¢ï¼šå†³ç­–æ ‘ç®—æ³•çš„ä¸»è¦æ“ä½œæœ‰ä¸¤ä¸ªï¼šåˆ†å‰²ç‚¹å¯»æ‰¾å’Œæ•°æ®åˆ†å‰²ï¼Œåœ¨ç¬¬ä¸€ä¸ªæ“ä½œä¸Šï¼Œpre-sortedå’Œhistogramç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯ä¸€æ ·çš„ï¼Œåœ¨æ•°æ®åˆ†å‰²æ“ä½œä¸Šï¼Œhistogramæ¯”pre-sortedè¦å¿«ï¼ˆhistogramä¸­ï¼Œæ‰€æœ‰ç‰¹å¾å…±äº«ä¸€ä¸ªç´¢å¼•ï¼Œè€Œpre-sortedä¸­ï¼Œæ¯ä¸ªç‰¹å¾å¯¹åº”ä¸€ä¸ªç´¢å¼•ï¼‰ï¼Œæ­¤å¤–ï¼Œhistogramè¿˜å‡å°‘äº†è®¡ç®—åˆ†å‰²ç‚¹å¢ç›Šçš„æ¬¡æ•°&lt;/li&gt;
  &lt;li&gt;é€šä¿¡æ–¹é¢ï¼šhistogramçš„é€šä¿¡ä»£ä»·è¿œå°äºpre-sortedï¼Œé€‚ç”¨äºåˆ†å¸ƒå¼è®¡ç®—&lt;/li&gt;
  &lt;li&gt;XGBçš„ç”Ÿæˆç­–ç•¥æ˜¯level-wiseï¼ˆä¸å®¹æ˜“è¿‡æ‹Ÿåˆï¼Œä½†æ•ˆç‡ä½ï¼Œåœ¨åˆ†è£‚æ—¶ï¼Œéƒ¨åˆ†å¢ç›Šå°çš„æ ‘ä¹Ÿè¿›è¡Œäº†å¢é•¿ï¼‰ï¼ŒLGBä½¿ç”¨leaf-wiseï¼ˆé«˜æ•ˆï¼Œä½†å®¹æ˜“ç”Ÿæˆæ·±åº¦è¿‡å¤§çš„æ ‘ï¼Œä»è€Œå¯¼è‡´è¿‡æ‹Ÿåˆï¼Œå› æ­¤éœ€è¦é™åˆ¶æœ€å¤§æ·±åº¦ï¼‰&lt;/li&gt;
  &lt;li&gt;è®­ç»ƒç²¾åº¦æ–¹é¢ï¼šhistogramç”±äºæ— æ³•æ‰¾åˆ°ç²¾ç¡®çš„åˆ†å‰²ç‚¹ï¼Œä¸pre-sortedç›¸æ¯”ï¼Œç›¸å½“äºé€šè¿‡ç‰ºç‰²ç²¾åº¦æ¥æ¢å–æ•ˆç‡&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;catboostcategory-boosting&quot;&gt;CatBoostï¼ˆCategory Boostingï¼‰&lt;/h2&gt;

&lt;p&gt;CatBoostæ˜¯ä»¥å¯¹ç§°å†³ç­–æ ‘ä¸ºåŸºå­¦ä¹ å™¨çš„GBDTæ¡†æ¶ï¼Œèƒ½å¤Ÿé«˜æ•ˆåœ°å¤„ç†ç±»åˆ«å‹ç‰¹å¾ï¼Œæ­¤å¤–ï¼ŒCatBoostè¿˜è§£å†³äº†æ¢¯åº¦åå·®ï¼ˆGraident Biasï¼‰å’Œé¢„æµ‹åç§»ï¼ˆPrediction Shiftï¼‰çš„é—®é¢˜ï¼Œèƒ½å¤Ÿå‡å¼±è¿‡æ‹Ÿåˆç°è±¡ï¼Œæé«˜é¢„æµ‹å‡†ç¡®æ€§ã€‚&lt;/p&gt;

&lt;p&gt;CatBoostçš„å­¦ä¹ ç®—æ³•åŸºäºGPUå®ç°ï¼Œæ‰“åˆ†ç®—æ³•åŸºäºCPUå®ç°ã€‚&lt;/p&gt;

&lt;p&gt;CatBoostç›¸å¯¹äºXGBå’ŒLGBçš„æ”¹è¿›ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;èƒ½å¤Ÿè‡ªåŠ¨é‡‡ç”¨ç‰¹æ®Šæ–¹å¼å¤„ç†ç±»åˆ«å‹ç‰¹å¾&lt;/li&gt;
  &lt;li&gt;å¯¹ç±»åˆ«ç‰¹å¾è¿›è¡Œç»„åˆï¼Œä¸°å¯Œäº†ç‰¹å¾ç§ç±»&lt;/li&gt;
  &lt;li&gt;åŸºæ¨¡å‹é‡‡ç”¨å¯¹ç§°æ ‘&lt;/li&gt;
  &lt;li&gt;ä½¿ç”¨æ’åºæå‡çš„æ–¹æ³•å¯¹æŠ—è®­ç»ƒé›†ä¸­çš„å™ªå£°ç‚¹ï¼Œä»è€Œé¿å…æ¢¯åº¦ä¼°è®¡çš„åå·®ï¼Œè§£å†³äº†é¢„æµ‹åç§»çš„é—®é¢˜&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;catboostå¦‚ä½•å¤„ç†ç±»åˆ«ç‰¹å¾categorical-features&quot;&gt;CatBoostå¦‚ä½•å¤„ç†ç±»åˆ«ç‰¹å¾ï¼ˆcategorical featuresï¼‰&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;å¯¹æ•°æ®åšä¸€äº›ç»Ÿè®¡ï¼Œè®¡ç®—æŸä¸ªcategoryå‡ºç°çš„é¢‘ç‡ï¼Œå†åŠ ä¸Šä¸€äº›è¶…å‚æ•°ï¼Œç”Ÿæˆæ–°çš„æ•°å€¼å‹ç‰¹å¾&lt;/li&gt;
  &lt;li&gt;å¯¹æ•°æ®è¿›è¡Œè‹¥å¹²ç§æ’åˆ—ï¼Œåœ¨æ¯ä¸€è½®å»ºæ ‘ä¹‹å‰ï¼Œéšæœºé€‰æ‹©ä¸€ç§æ•°æ®æ’åˆ—æ¥ç”Ÿæˆæ ‘&lt;/li&gt;
  &lt;li&gt;å¯¹categoryç‰¹å¾è¿›è¡Œç»„åˆï¼Œåœ¨ç»„åˆæ•°é‡è¿‡å¤§æ—¶ï¼ŒCatBoosté€šè¿‡è´ªå¿ƒç®—æ³•é€‰æ‹©æ¥é€‰æ‹©æœ€å¥½çš„ä¸€éƒ¨åˆ†ç»„åˆ&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ä¼˜ç‚¹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;æ€§èƒ½å¼ºï¼Œå¯ä»¥åŒ¹æ•Œä»»ä½•å…ˆè¿›çš„æœºå™¨å­¦ä¹ ç®—æ³•&lt;/li&gt;
  &lt;li&gt;é²æ£’æ€§é«˜ï¼Œå‡å°‘äº†è¶…å‚æ•°è°ƒæ•´çš„éœ€æ±‚ï¼Œé™ä½äº†è¿‡æ‹Ÿåˆçš„é£é™©ï¼Œæ¨¡å‹çš„æ³›ç”¨æ€§æ›´å¼º&lt;/li&gt;
  &lt;li&gt;å®ç”¨æ€§å¼ºï¼šä½“ç°åœ¨å¯ä»¥è‡ªåŠ¨å¤„ç†æ•°å€¼ç‰¹å¾å’Œç±»åˆ«ç‰¹å¾&lt;/li&gt;
  &lt;li&gt;å¯æ‰©å±•ï¼šæ”¯æŒè‡ªå®šä¹‰losså‡½æ•°&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç¼ºç‚¹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;å¯¹ç±»åˆ«ç‰¹å¾çš„å¤„ç†å¯¹æ—¶é—´å’Œç©ºé—´çš„éœ€æ±‚æ¯”è¾ƒå¤§&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;æ¨¡å‹éšæœºç§å­çš„è®¾å®šä¼šå½±å“æ¨¡å‹çš„é¢„æµ‹ç»“æœ&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;refs&quot;&gt;Refs.&lt;/h2&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://marian5211.github.io/2018/03/12/&quot;&gt;gbdt-xgboost-lightGBMæ¯”è¾ƒ&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/129810143&quot;&gt;é›†æˆç®—æ³•&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://arxiv.org/pdf/1603.02754.pdf&quot;&gt;XGBoost: A Scalable Tree Boosting System&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.msra.cn/zh-cn/news/features/lightgbm-20170105&quot;&gt;MSRA: LighGBMä»‹ç»&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/102540344&quot;&gt;æ·±å…¥ç†è§£CatBoost&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.audentia-gestion.fr/MICROSOFT/lightgbm.pdf&quot;&gt;LightGBM: A Highly Efficient Gradient Boosting Decision Tree&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://arxiv.org/pdf/1706.09516.pdf&quot;&gt;CatBoost: unbiased boosting with categorical features&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.kaggle.com/abhinand05/catboost-a-deeper-dive&quot;&gt;Catboost: A Deeper Dive&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/102570430&quot;&gt;Catboostå®Œå…¨æŒ‡å—&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

</description>
        <pubDate>Sat, 27 Feb 2021 17:21:09 +0800</pubDate>
        <link>http://localhost:4000//2021/02/%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0%E5%B0%8F%E7%BB%93</link>
        <guid isPermaLink="true">http://localhost:4000//2021/02/%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0%E5%B0%8F%E7%BB%93</guid>
        
        <category>é›†æˆå­¦ä¹ </category>
        
        <category>Machine Learning</category>
        
        
        <category>ç®—æ³•</category>
        
      </item>
    
      <item>
        <title>ä¼˜åŒ–ç®—æ³•</title>
        <description>&lt;p&gt;æ ¹æ®ä¼˜åŒ–ç›®æ ‡æ˜¯å¦å—æ¡ä»¶çº¦æŸï¼Œä¼˜åŒ–ç®—æ³•åˆ†ä¸ºæ— çº¦æŸä¼˜åŒ–ç®—æ³•å’Œå¸¦çº¦æŸä¼˜åŒ–ç®—æ³•ã€‚&lt;/p&gt;

&lt;p&gt;å¸¸è§çš„æ— çº¦æŸä¼˜åŒ–ç®—æ³•æœ‰ï¼šæ¢¯åº¦ä¸‹é™æ³•ï¼ˆæœ€é€Ÿä¸‹é™æ³•ï¼‰ã€ç‰›é¡¿æ³•ã€æ‹Ÿç‰›é¡¿æ³•ã€å…±è½­æ¢¯åº¦æ³•ã€å¯å‘å¼ç®—æ³•ï¼ˆé—ä¼ ç®—æ³•ã€æ¨¡æ‹Ÿé€€ç«ã€èšç¾¤ç®—æ³•ç­‰ï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;å¸¸è§çš„å¸¦çº¦æŸä¼˜åŒ–é—®é¢˜å¯ä»¥æŒ‰ç…§çº¦æŸæ¡ä»¶åˆ†ä¸ºä¸¤ç±»ï¼š&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;ç­‰å¼çº¦æŸä¼˜åŒ–é—®é¢˜&lt;/li&gt;
  &lt;li&gt;ä¸ç­‰å¼çº¦æŸä¼˜åŒ–é—®é¢˜&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å¯¹äºç¬¬ä¸€ç±»ï¼Œå¯ä»¥ä½¿ç”¨æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•ï¼Œè½¬å˜ä¸ºæ— çº¦æŸä¼˜åŒ–é—®é¢˜ï¼›
å¯¹äºç¬¬äºŒç±»ï¼Œå¯å¼•å…¥KKTæ¡ä»¶ï¼Œå°†ä¸ç­‰å¼çº¦æŸä¼˜åŒ–é—®é¢˜è½¬åŒ–ä¸ºç­‰å¼çº¦æŸä¼˜åŒ–é—®é¢˜ï¼Œç„¶åä½¿ç”¨ç­‰å¼çº¦æŸä¼˜åŒ–é—®é¢˜çš„æ±‚è§£æ–¹æ³•æ¥å¤„ç†ã€‚&lt;/p&gt;

&lt;p&gt;ä»¥ä¸‹ç®€å•ä»‹ç»æ— çº¦æŸä¼˜åŒ–ç®—æ³•ï¼šæ¢¯åº¦ä¸‹é™æ³•ã€ç‰›é¡¿æ³•ã€æ‹Ÿç‰›é¡¿æ³•å’Œå…±è½­æ¢¯åº¦æ³•ã€‚&lt;/p&gt;

&lt;h3 id=&quot;æ¢¯åº¦ä¸‹é™æ³•gradient-decent-gd&quot;&gt;æ¢¯åº¦ä¸‹é™æ³•ï¼ˆGradient Decent, GDï¼‰&lt;/h3&gt;

&lt;p&gt;æ¢¯åº¦ä¸‹é™æ³•åœ¨æ·±åº¦å­¦ä¹ ä¸­åº”ç”¨éå¸¸å¹¿æ³›ï¼Œæ¢¯åº¦ä¸‹é™ç®—æ³•çš„ä¼˜åŒ–æ€æƒ³æ˜¯ï¼Œä½¿ç”¨å½“å‰ç›®æ ‡å‡½æ•°çš„è´Ÿæ¢¯åº¦æ–¹å‘ä½œä¸ºæœç´¢æ–¹å‘ï¼Œç”±äºè¿™ä¸ªæ–¹å‘æ˜¯ç›®æ ‡å‡½æ•°ä¸‹é™æœ€å¿«çš„æ–¹å‘ï¼Œå› æ­¤æ¢¯åº¦ä¸‹é™æ³•åˆç§°ä¸ºæœ€é€Ÿä¸‹é™æ³•ã€‚åœ¨æ¢¯åº¦ä¸‹é™æ³•æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œè¶Šæ¥è¿‘ç›®æ ‡ç‚¹ï¼Œæ¢¯åº¦è¶Šå°ï¼Œæ¯æ¬¡æ›´æ–°çš„æ­¥é•¿å°±ä¼šè¶Šå°ã€‚
å¯¹äºç›®æ ‡å‡½æ•°ä¸ºå‡¸çš„æƒ…å†µï¼ŒGDç®—æ³•æ€»èƒ½æ‰¾åˆ°æœ€ä¼˜è§£ï¼Œä½†åœ¨éå‡¸æƒ…å†µä¸‹ï¼Œåˆ™ä¸èƒ½ä¿è¯ã€‚
æ¢¯åº¦ä¸‹é™æ³•å®ç°ç®€å•ï¼Œåœ¨å¤§é‡æ ·æœ¬ä¸Šæ‰§è¡Œé€Ÿåº¦å¿«ã€‚å…¶ç¼ºç‚¹åœ¨äºï¼Œéœ€è¦æ‰‹å·¥è°ƒæ•´è¶…å‚æ•°ï¼Œå¦‚å­¦ä¹ ç‡ã€ç»ˆæ­¢æ¡ä»¶ç­‰ï¼›å¦å¤–ï¼Œæ¢¯åº¦ä¸‹é™æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªåºåˆ—ç®—æ³•ï¼Œæ— æ³•å¾ˆå¥½åœ°æ”¯æŒå¹¶è¡Œè®¡ç®—ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¸¸ä½¿ç”¨æ‰¹æ¢¯åº¦ä¸‹é™æ³•ï¼ˆBatch Gradient Decentï¼ŒBGDï¼‰å’Œå°æ‰¹é‡æ¢¯åº¦ä¸‹é™æ³•ï¼ˆmini-Batch Gradient Decentï¼‰ï¼ŒåŠéšæœºæ¢¯åº¦ä¸‹é™æ³•ï¼ˆStochastic Gradient Decentï¼ŒSGDï¼‰ï¼ŒBGDã€mini-BGDã€SGDçš„åŒºåˆ«åœ¨äºï¼ŒBGDä¸€æ¬¡è¿­ä»£ä½¿ç”¨æ‰€æœ‰çš„è®­ç»ƒæ•°æ®è®¡ç®—æ¢¯åº¦æ–¹å‘ï¼Œå¯¹äºæ•°æ®é‡è¾ƒå¤§çš„æƒ…å†µï¼Œæ‰§è¡Œé€Ÿåº¦è¾ƒæ…¢ï¼Œmini-BGDå’ŒSGDåˆ™åˆ†åˆ«ä½¿ç”¨ä¸€å°æ‰¹æ ·æœ¬å’Œå•ä¸ªæ ·æœ¬å¯¹å‚æ•°è¿›è¡Œæ›´æ–°ï¼ŒSGDæ¯æ¬¡è¿­ä»£çš„ç›®æ ‡æ˜¯æœ€å°åŒ–å•ä¸ªæ ·æœ¬çš„æŸå¤±ï¼Œé€šè¿‡å¢åŠ è¿­ä»£æ¬¡æ•°ï¼Œæ¥æ¢å–æ‰§è¡Œæ•ˆç‡çš„æå‡ï¼ŒåŒæ—¶ï¼Œåœ¨å¤§é‡æ•°æ®çš„å‰æä¸‹ï¼Œå…¶ä¼˜åŒ–æ–¹å‘ä¹Ÿè¶‹äºæœ€ä¼˜è§£ã€‚mini-BGDåˆ™æ˜¯BGDå’ŒSGDçš„æŠ˜è¡·é€‰æ‹©ã€‚&lt;/p&gt;

&lt;h3 id=&quot;ç‰›é¡¿æ³•newtons-method&quot;&gt;ç‰›é¡¿æ³•ï¼ˆNewtonâ€™s Methodï¼‰&lt;/h3&gt;

&lt;p&gt;ç‰›é¡¿æ³•åœ¨æœºå™¨å­¦ä¹ é¢†åŸŸçš„åº”ç”¨ä¹Ÿæ¯”è¾ƒå¤šï¼Œå…¶åŸºæœ¬æ€æƒ³æ˜¯ï¼Œåˆ©ç”¨å‚æ•°å½“å‰ä½ç½®çš„ä¸€é˜¶å¯¼æ•°ï¼ˆæ¢¯åº¦ï¼‰å’ŒäºŒé˜¶å¯¼æ•°ï¼ˆHessiançŸ©é˜µï¼‰å¯¹ç›®æ ‡å‡½æ•°è¿›è¡ŒäºŒæ¬¡è¿‘ä¼¼ï¼Œç„¶åå°†äºŒæ¬¡æ¨¡å‹çš„æå°ç‚¹ä½œä¸ºæ–°çš„è¿­ä»£ç‚¹ï¼Œé‡å¤ä¸Šè¿°è¿‡ç¨‹ï¼Œç›´è‡³æå°å€¼æ»¡è¶³ç²¾åº¦è¦æ±‚ã€‚ç‰›é¡¿æ³•è¿è¡Œé€Ÿåº¦å¾ˆå¿«ï¼Œè€Œä¸”å¯ä»¥é«˜åº¦é€¼è¿‘æœ€ä¼˜è§£ã€‚&lt;/p&gt;

&lt;p&gt;è®°ä¼˜åŒ–ç›®æ ‡å‡½æ•°ä¸º$f(x)$ï¼Œç‰›é¡¿æ³•åœ¨ä¸€ç»´æƒ…å½¢ä¸­çš„è¡¨è¿°å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;å¯¹$f(x)$è¿›è¡ŒäºŒé˜¶å±•å¼€ï¼Œå¿½ç•¥é«˜é˜¶ä½™é¡¹ï¼ˆä¸ºäº†æ–¹ä¾¿è¡¨è¿°ï¼Œä»¥ä¸‹æ³°å‹’å±•å¼€å…¬å¼ä¸­ï¼Œä½¿ç”¨ç­‰å·ï¼Œä¸‹åŒï¼‰ï¼Œæœ‰ï¼š&lt;/p&gt;

\[f(x) = f(x_{k})+\nabla f(x_{k})^T(x-x_{k})+\frac{1}{2} (x-x_{k})^T \nabla^2 f(x_{k})(x-x_{k})\]

&lt;p&gt;ä¸Šå¼æ±‚$x$æ±‚å¯¼ï¼Œå¹¶ä»¤å…¶ä¸º0ï¼Œå¯å¾—ï¼š&lt;/p&gt;

\[\nabla f(x)=\nabla f(x_{k})+\nabla^{2} f(x_{k})(x-x_{k})=0\]

&lt;p&gt;å³ï¼š&lt;/p&gt;

\[x = x_k - \frac{\nabla f(x_{k})}{\nabla^{2} f(x_{k})}\]

&lt;p&gt;å…¶ä¸­ï¼Œ$\nabla^{2} f(x_{k})$ä¸ºHassiané˜µï¼Œå¯ç®€è®°ä¸ºHï¼Œ&lt;/p&gt;

\[H(x)=\left[\frac{\partial^{2} f}{\partial x_{i} \partial x_{j}}\right]_{n \times n}\]

&lt;p&gt;ç‰›é¡¿æ³•çš„æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;è®¾å®šç»ˆæ­¢è¯¯å·®$0 \leq \epsilon \ll 1$ï¼Œè®¾ç½®åˆå§‹ç‚¹$x_0 \in \mathrm{R}^n$ï¼Œ$k=0$&lt;/li&gt;
  &lt;li&gt;è®¡ç®—$g_k=\nabla f(x_{k})$ï¼Œè‹¥$\mid\mid g_k \mid\mid \leq \epsilon$ï¼Œç®—æ³•ç»ˆæ­¢ï¼Œè¾“å‡º$x^* =x_k$&lt;/li&gt;
  &lt;li&gt;è®¡ç®—$H_k=\nabla^{2} f(x_{k})$ï¼Œè®¡ç®—æœç´¢æ–¹å‘$d_k=-H_k^{-1}g_k$ï¼Œè¿™ä¸ªæœç´¢æ–¹å‘åˆç§°ä¸ºâ€œç‰›é¡¿æ–¹å‘â€œ&lt;/li&gt;
  &lt;li&gt;ä»¤$x_{k+1}=x_k+\lambda d_k$ï¼Œ$k=k+1$ï¼Œè½¬è‡³2&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;åœ¨ç¬¬å››æ­¥ä¸­ï¼Œéœ€è¦è®¾ç½®ä¸€ä¸ªæ¥è¿‘0çš„å‚æ•°$\lambda$ï¼Œéœ€è¦è¿™ä¸ªå‚æ•°æ¥ä¿è¯$x_{k+1}$åœ¨$x_k$çš„é‚»åŸŸå†…ï¼Œä»¥ç¡®ä¿æˆ‘ä»¬å¯ä»¥åœ¨æ³°å‹’å±•å¼€æ—¶èƒ½å¤Ÿå¿½ç•¥é«˜é˜¶é¡¹ã€‚$\lambda$çš„é€‰å–å¯ä»¥ä½¿ç”¨ç›´çº¿æœç´¢æ³•ï¼ˆline searchï¼‰ï¼Œå³åœ¨ä¸€å®šçš„åŒºé—´èŒƒå›´å†…è®¾å®š$\lambda$çš„å€¼ï¼Œé€‰æ‹©å‡½æ•°å€¼ä¸‹é™æœ€å¿«çš„å€¼ä½œä¸ºæœ€ä¼˜$\lambda$ã€‚&lt;/p&gt;

&lt;p&gt;ä»å‡ ä½•çš„è§’åº¦ï¼Œç‰›é¡¿æ³•ä½¿ç”¨ä¸€ä¸ªäºŒæ¬¡æ›²é¢æ¥æ‹Ÿåˆå½“å‰æ‰€å¤„ä½ç½®çš„å±€éƒ¨æ›²é¢ï¼Œè€Œæ¢¯åº¦ä¸‹é™åˆ™æ˜¯ç”¨ä¸€ä¸ªå¹³é¢æ¥æ‹Ÿåˆï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œç‰›é¡¿æ³•çš„ä¸‹é™è·¯å¾„æ›´ç¬¦åˆå®é™…çš„æœ€ä¼˜ä¸‹é™è·¯å¾„ï¼Œä¸”æ”¶æ•›é€Ÿåº¦æ›´å¿«ï¼ˆå…¶å…·æœ‰äºŒé˜¶æ”¶æ•›ç‰¹æ€§ï¼‰ï¼Œä¸è¶³ä¹‹å¤„åœ¨äºï¼Œç‰›é¡¿æ³•æ¯ä¸€æ¬¡è¿­ä»£å‡éœ€è¦è®¡ç®—ä¸€æ¬¡ç›®æ ‡å‡½æ•°çš„äºŒé˜¶å¯¼æ•°ï¼ˆå¯¹åº”é«˜ç»´æƒ…å†µçš„HessiançŸ©é˜µï¼‰ï¼Œè®¡ç®—è¿‡ç¨‹æ¯”è¾ƒå¤æ‚ã€‚&lt;/p&gt;

&lt;p&gt;å½“ç„¶ï¼Œç‰›é¡¿æ³•ä¹Ÿé¢ä¸´ä¸€äº›é—®é¢˜ï¼Œä¸»è¦æ˜¯ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ç‰›é¡¿æ³•ä¸æ¢¯åº¦ä¸‹é™ç±»ä¼¼ï¼Œä¹Ÿåœ¨å¯»æ‰¾æ¢¯åº¦ä¸º0çš„ç‚¹ï¼Œæ‰€ä»¥ä¹Ÿä¼šé¢ä¸´éç‚¹å’Œå±€éƒ¨æå°å€¼çš„é—®é¢˜&lt;/li&gt;
  &lt;li&gt;Hessianæ±‚é€†çš„ä»£ä»·å¾ˆé«˜&lt;/li&gt;
  &lt;li&gt;åœ¨æŸäº›æƒ…å†µä¸‹Hessiané˜µå¯èƒ½ä¸å¯é€†&lt;/li&gt;
  &lt;li&gt;æ¯æ¬¡è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œç‰›é¡¿æ³•ä¸èƒ½ä¿è¯æ”¶æ•›åˆ°æœ€ä¼˜è§£ï¼Œå¯ä»¥ä½¿ç”¨ç›´çº¿æœç´¢æ³•æˆ–å¯ä¿¡åŸŸæœç´¢æ¥åŠ¨æ€è°ƒæ•´ç‰›é¡¿æ–¹å‘çš„æ­¥é•¿ï¼Œè¿™é‡Œå¯ä»¥è¡ç”Ÿå‡ºå¯ä¿¡åŸŸç‰›é¡¿æ³•ï¼ˆTrust Region Newton Methodsï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;æ‹Ÿç‰›é¡¿æ³•quasi-newton-methods&quot;&gt;æ‹Ÿç‰›é¡¿æ³•ï¼ˆQuasi-Newton Methodsï¼‰&lt;/h3&gt;

&lt;p&gt;åœ¨ç‰›é¡¿æ³•ä¸­æåˆ°ï¼Œè¿­ä»£è¿‡ç¨‹ä¸­åœ¨æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„æ—¶ï¼Œéœ€è¦è®¡ç®—HessiançŸ©é˜µçš„é€†çŸ©é˜µï¼ŒHessiané€†çŸ©é˜µæ±‚è§£æ¯”è¾ƒè€—æ—¶ï¼Œä¸”æœ‰äº›æƒ…å†µä¸‹HessiançŸ©é˜µæ˜¯ä¸å¯é€†çš„ï¼Œä¸ºæ­¤ï¼Œæå‡ºäº†ä¸€äº›æ”¹è¿›ç®—æ³•ï¼Œå…¸å‹çš„æ˜¯æ‹Ÿç‰›é¡¿æ³•ï¼Œå…¶ä¸»è¦æ€æƒ³æ˜¯ï¼Œä¸ç›´æ¥æ±‚è§£$H$çŸ©é˜µåŠå…¶é€†çŸ©é˜µï¼Œè€Œæ˜¯é€šè¿‡å…¶ä»–æ‰‹æ®µè·å¾—å®ƒä»¬ã€‚å…·ä½“åœ°ï¼Œæ„é€ ä¸€ä¸ªæ­£å®šçŸ©é˜µæ¥æ›¿ä»£$H$çŸ©é˜µï¼ˆæˆ–å…¶é€†çŸ©é˜µï¼‰ï¼Œå°†è¿™ä¸ªæ›¿ä»£çŸ©é˜µç”¨äºç‰›é¡¿æ³•çš„æ±‚è§£ä¸­ã€‚&lt;/p&gt;

&lt;p&gt;ä»¿ç…§ç‰›é¡¿æ³•ä¸­çš„å¤„ç†æ–¹å¼ï¼Œå°†$f(x)$åœ¨$x_{k+1}$å¤„å±•å¼€å¹¶å¿½ç•¥é«˜é˜¶é¡¹ï¼Œæœ‰ï¼š&lt;/p&gt;

\[f(x)= f(x_{k+1})+\nabla f(x_{k+1})^T(x-x_{k+1})+\frac{1}{2} (x-x_{k+1})^T \nabla^2 f(x_{k})(x-x_{k+1})\]

&lt;p&gt;å¯¹ç­‰å·ä¸¤ä¾§æ±‚æ¢¯åº¦ï¼Œæœ‰ï¼š&lt;/p&gt;

\[\nabla f(x) = \nabla f(x_{k+1})+\nabla^{2} f(x_{k+1})(x-x_{k+1})\]

&lt;p&gt;ä»¤$x=x_k$ï¼Œæœ‰ï¼š&lt;/p&gt;

\[\nabla f(x_{k+1})-\nabla f(x_k) = \nabla^{2} f(x_{k+1})(x_{k+1} - x_k)\]

&lt;p&gt;æ²¿ç”¨ä¸Šè¿°ç‰›é¡¿æ³•ä¸­çš„è®°å·ï¼Œä¸Šå¼ç®€å†™ä¸ºï¼š&lt;/p&gt;

\[g_{k+1}-g_{k}=H_{k+1}(x_{k+1}-x_{k})\]

&lt;p&gt;ä»¤$x_{k+1}-x_{k}=s_k$ï¼Œ$g_{k+1}-g_{k}=y_k$ï¼Œåˆ™æœ‰ï¼š&lt;/p&gt;

&lt;p&gt;$y_k=H_{k+1}s_k$ï¼Œå³$s_k=H_{k+1}^{-1}y_k$&lt;/p&gt;

&lt;p&gt;ä¸Šè¿°æ¡ä»¶ç§°ä¸ºæ‹Ÿç‰›é¡¿æ¡ä»¶ï¼Œåœ¨æ‹Ÿç‰›é¡¿æ–¹æ³•ä¸­æ„é€ å‡ºçš„HessiançŸ©é˜µéœ€è¦æ»¡è¶³ä¸Šè¿°æ¡ä»¶ã€‚&lt;/p&gt;

&lt;p&gt;å…¸å‹çš„æ‹Ÿç‰›é¡¿æ–¹æ³•æœ‰DFPç®—æ³•ï¼ˆDavidon-Fletcher-Powellï¼‰ã€BFGSç®—æ³•ï¼ˆBroyden-Fletcher-Goldfarb-Shanno Algorithmï¼‰ã€Broydenç±»ç®—æ³•ï¼ˆBroydenâ€™s algorithmï¼‰ã€L-BFGSç®—æ³•ï¼ˆLimited-memory BFGSï¼‰ã€SR1ç®—æ³•ï¼ˆSymmetric rank-oneï¼‰ç­‰ï¼Œä¸‹æ–‡ä¸»è¦ä»‹ç»DFPç®—æ³•ã€BFGSç®—æ³•ã€Broydenç±»ç®—æ³•ã€‚&lt;/p&gt;

&lt;h4 id=&quot;dfpç®—æ³•&quot;&gt;DFPç®—æ³•&lt;/h4&gt;

&lt;p&gt;DFPç®—æ³•ä½¿ç”¨$G_k$ä½œä¸º$H_k^{-1}$çš„è¿‘ä¼¼ï¼Œå¹¶å‡è®¾$G_k$çš„è¿­ä»£è¿‡ç¨‹åŒ…å«ä¸¤ä¸ªé™„åŠ é¡¹ï¼š&lt;/p&gt;

\[G_{k+1}=G_{k}+P_{k}+Q_{k}\]

&lt;p&gt;å…¶ä¸­$P_k$å’Œ$Q_k$ä¸ºå¾…å®šçŸ©é˜µï¼Œæœ‰ï¼š&lt;/p&gt;

\[G_{k+1} y_{k}=G_{k} y_{k}+P_{k} y_{k}+Q_{k} y_{k}\]

&lt;p&gt;ä¸ºäº†ä½¿$G_{k+1}$æ»¡è¶³æ‹Ÿç‰›é¡¿æ¡ä»¶ï¼Œå¯ä»¥è®©$P_k$å’Œ$Q_k$æ»¡è¶³ï¼š&lt;/p&gt;

\[P_{k} y_{k}=\delta_{k},Q_{k}=-\frac{G_{k} y_{k} y_{k}^{T} G_{k}}{y_{k}^{T} G_{k} y_{k}}\]

&lt;p&gt;å¸¦å…¥$G_{k+1}$çš„è¿­ä»£å…¬å¼å¯å¾—ï¼š&lt;/p&gt;

\[G_{k+1}=G_{k}+\frac{\delta_{k} \delta_{k}^{T}}{\delta_{k}^{T} y_{k}}-\frac{G_{k} y_{k} y_{k}^{T} G_{k}}{y_{k}^{T} G_{k} y_{k}}\]

&lt;p&gt;å¦‚æœ$G_0$æ˜¯æ­£å®šçš„ï¼Œåˆ™å¯ä»¥è¯æ˜ï¼Œè¿­ä»£è¿‡ç¨‹ä¸­çš„$G_k$éƒ½æ˜¯æ­£å®šçš„ã€‚&lt;/p&gt;

&lt;p&gt;DFPç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ç»™å®šåˆå€¼$x_0$ï¼Œç»ˆæ­¢è¯¯å·®$\epsilon$ï¼›å–$G_0$ä¸ºæ­£å®šçŸ©é˜µï¼Œä»¤$k=0$&lt;/li&gt;
  &lt;li&gt;è®¡ç®—$g_k=g(x_0)$ï¼Œå¦‚æœ$\Vert g_k \Vert \lt \epsilon$åˆ™ç»ˆæ­¢è¿­ä»£ï¼Œè¿‘ä¼¼è§£$x^* =x_k$ï¼›å¦åˆ™æ‰§è¡Œä¸‹ä¸€æ­¥&lt;/li&gt;
  &lt;li&gt;è®¡ç®—$p_k=-G_kg_k$&lt;/li&gt;
  &lt;li&gt;æ‰§è¡Œä¸€ç»´æœç´¢ï¼Œæ±‚$\lambda$ä½¿å¾—ï¼š
\(f(x^{(k)}+\lambda_{k} p_{k})=\min_\limits{\lambda \geq 0} f(x^{(k)}+\lambda p_{k})\)&lt;/li&gt;
  &lt;li&gt;$x_{k+1}=x_k+\lambda p_k$&lt;/li&gt;
  &lt;li&gt;è®¡ç®—$g_{k+1}=g(x_{k+1})$ï¼Œå¦‚æœ$\Vert g_k \Vert \lt \epsilon$åˆ™ç»ˆæ­¢è¿­ä»£ï¼Œè¿‘ä¼¼è§£$x^*=x_k$ï¼›å¦åˆ™ï¼Œè®¡ç®—$G_{k+1}=G_{k}+\frac{\delta_{k} \delta_{k}^{T}}{\delta_{k}^{T} y_{k}}-\frac{G_{k} y_{k} y_{k}^{T} G_{k}}{y_{k}^{T} G_{k} y_{k}}$&lt;/li&gt;
  &lt;li&gt;$k=k+1$ï¼Œæ‰§è¡Œç¬¬3æ­¥&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&quot;bfgsç®—æ³•&quot;&gt;BFGSç®—æ³•&lt;/h4&gt;

&lt;p&gt;BFGSç®—æ³•çš„æ€æƒ³æ˜¯æ„é€ HessiançŸ©é˜µ$H_k$çš„è¿‘ä¼¼çŸ©é˜µ$B_k$ï¼Œå¹¶é€šè¿‡è¿­ä»£æ¥æ›´æ–°è¿™ä¸ªçŸ©é˜µï¼š&lt;/p&gt;

\[B_{k+1}=B_k+\Delta B_k\]

&lt;p&gt;è¿‘ä¼¼çŸ©é˜µçš„åˆå€¼$B_0$ä¸ºå•ä½é˜µ$I$ï¼Œæ¯æ¬¡è¿­ä»£éœ€è¦ä¿®æ­£$\Delta B_k $ï¼Œè¿­ä»£å…¬å¼ä¸ºï¼š&lt;/p&gt;

\[\Delta B_k=\alpha uu^T+ \beta vv^T\]

&lt;p&gt;å…¶ä¸­ï¼Œ$u=y_k$ï¼Œ$v=B_ks_k$ï¼Œ$\alpha=\frac{1}{y_k^T s_k}$ï¼Œ$\beta=-\frac{1}{s_k^TB_k s_k}$&lt;/p&gt;

&lt;p&gt;ä»£å…¥$\Delta B_k$å¾—ï¼š&lt;/p&gt;

\[\Delta B_{k}=\frac{y_{k}{y_{k}^T}}{y_{k}^{T} s_{k}}-\frac{B_{k} s_{k}s_{k}^{T} B_{k}}{s_{k}^{T} B_{k} s_{k}}\]

&lt;p&gt;ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ç»™å®šåˆå€¼$x_0$ï¼Œç»ˆæ­¢è¯¯å·®$\epsilon$ï¼Œä»¤$B_0=I$ï¼Œ$k=0$&lt;/li&gt;
  &lt;li&gt;è®¡ç®—æœç´¢æ–¹å‘$d_k=-B_k^{-1}g_k$&lt;/li&gt;
  &lt;li&gt;è®¡ç®—æœç´¢æ­¥é•¿$\lambda_k$ï¼Œä»¤$s_k=\lambda_kd_k$ï¼Œ$x_{k+1}=x_k+s_k$&lt;/li&gt;
  &lt;li&gt;å¦‚æœ$\Vert g_{k+1}\Vert \lt \epsilon$ï¼Œåˆ™ç»ˆæ­¢è¿­ä»£&lt;/li&gt;
  &lt;li&gt;è®¡ç®—$y_k=g_{k+1}-g_k$&lt;/li&gt;
  &lt;li&gt;è®¡ç®—$B_{k+1} = B_k + \frac{y_{k}{y_{k}^T}}{y_{k}^{T} s_{k}}-\frac{B_{k} s_{k}s_{k}^{T} B_{k}}{s_{k}^{T} B_{k} s_{k}}$&lt;/li&gt;
  &lt;li&gt;ä»¤$k=k+1$ï¼Œè·³è½¬æ­¥éª¤2&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&quot;broydenç±»ç®—æ³•&quot;&gt;Broydenç±»ç®—æ³•&lt;/h4&gt;

&lt;p&gt;å‰ç½®ï¼šSherman-Morrisonå…¬å¼ï¼š&lt;/p&gt;

&lt;p&gt;å‡è®¾$A$ä¸º$n$é˜¶å¯é€†çŸ©é˜µï¼Œ$u,v$æ˜¯$n$ç»´å‘é‡ï¼Œ$t$ä¸ºå¸¸é‡ï¼Œä¸”$A+uv^T$å¯é€†ï¼Œåˆ™ï¼š&lt;/p&gt;

\[\left(A+\frac{u v^{T}}{t}\right)^{-1} = A^{-1}- \frac{A^{-1} u v^{T} A^{-1}}{t+v^{T} A^{-1} u}\]

&lt;p&gt;å·²çŸ¥BFGSç®—æ³•çš„è¿­ä»£å…¬å¼å¦‚ä¸‹ï¼š&lt;/p&gt;

\[B_{k+1}=B_k + \frac{y_{k}{y_{k}^T}}{y_{k}^{T} s_{k}}-\frac{B_{k} s_{k}s_{k}^{T} B_{k}}{s_{k}^{T} B_{k} s_{k}}\]

&lt;p&gt;å¯¹ä¸Šå¼åº”ç”¨ä¸¤æ¬¡Sherman-Morrisonå…¬å¼$^8$ï¼Œæœ‰ï¼š&lt;/p&gt;

\[B_{k+1}^{-1}=\left(I-\frac{\delta_{k} y_{k}^{T}}{\delta_{k}^{T} y_{k}}\right) B_{k}^{-1}\left(I-\frac{\delta_{k} y_{k}^{T}}{\delta_{k}^{T} y_{k}}\right)^{T}+\frac{\delta_{k} \delta_{k}^{T}}{\delta_{k}^{T} y_{k}}\]

&lt;p&gt;è®°$G_k=B_k^{-1},G_{k+1}=B_{k+1}^{-1}$&lt;/p&gt;

&lt;p&gt;æœ‰ï¼š&lt;/p&gt;

\[G_{k+1}=\left(I-\frac{\delta_{k} y_{k}^{T}}{\delta_{k}^{T} y_{k}}\right) G_{k}\left(I-\frac{\delta_{k} y_{k}^{T}}{\delta_{k}^{T} y_{k}}\right)^{T}+\frac{\delta_{k} \delta_{k}^{T}}{\delta_{k}^{T} y_{k}}\]

&lt;p&gt;ç§°ä¸Šå¼ä¸ºBFGSç®—æ³•å…³äº$G_k$çš„è¿­ä»£å…¬å¼ï¼Œç”±è¯¥å…¬å¼å¾—åˆ°çš„$G_{k+1}$è®°ä¸º$G^{BFGS}$ï¼›&lt;/p&gt;

&lt;p&gt;åŒç†ï¼Œä¹Ÿå¯ä»¥å¾—åˆ°DFPç®—æ³•å…³äº$G_k$çš„è¿­ä»£å…¬å¼ï¼Œç”±è¯¥å…¬å¼å¾—åˆ°çš„$G_{k+1}$è®°ä¸º$G^{DFP}$ï¼›&lt;/p&gt;

&lt;p&gt;Broydenç±»ç®—æ³•å°†äºŒè€…è¿›è¡Œçº¿æ€§ç»„åˆï¼š&lt;/p&gt;

\[G_{k+1}=\alpha G^{D F P}+(1-\alpha) G^{B F G S}\]

&lt;p&gt;å…¶ä¸­$0\le \alpha \le 1$ï¼Œç”±äº$G^{BFGS}$å’Œ$G^{DFP}$å‡æ»¡è¶³æ‹Ÿç‰›é¡¿æ¡ä»¶ï¼ŒäºŒè€…çš„çº¿æ€§ç»„åˆä¹Ÿæ»¡è¶³æ‹Ÿç‰›é¡¿æ¡ä»¶ï¼Œä¸”$G_{k+1}$ä¸ºæ­£å®šçŸ©é˜µï¼Œåº”ç”¨è¿™ç±»è¿­ä»£å…¬å¼çš„ç®—æ³•ç§°ä¸ºBroydenç±»ç®—æ³•ã€‚&lt;/p&gt;

&lt;h3 id=&quot;å…±è½­æ¢¯åº¦æ³•&quot;&gt;å…±è½­æ¢¯åº¦æ³•&lt;/h3&gt;

&lt;p&gt;å…±è½­æ¢¯åº¦æ³•æ˜¯å…±è½­æ–¹å‘æ³•çš„ä¸€ç§ï¼Œå¯ä»¥ç”¨äºæ±‚è§£æ— çº¦æŸå‡¸äºŒæ¬¡è§„åˆ’é—®é¢˜ï¼š$\min_\limits{x} f(x)= \frac{1}{2}x^TQx+q^Tx$ï¼Œå…¶ä¸­$Q\in\mathbb{R}^{n\times n}$ä¸ºå¯¹ç§°æ­£å®šçŸ©é˜µï¼Œ$q\in \mathbb{R}^n$ï¼Œ$x\in \mathbb{R}^n$ã€‚&lt;/p&gt;

&lt;h4 id=&quot;q-conjugate&quot;&gt;Q-conjugate&lt;/h4&gt;

&lt;p&gt;ç»™å®šæ­£å®šçŸ©é˜µ$Q$ï¼Œå®šä¹‰éé›¶å‘é‡$x,y$å…³äºQçŸ©é˜µQ-conjugateï¼Œå½“ä¸”ä»…å½“$x^TQy=0$æˆç«‹ï¼Œä¸”$x,y$æ˜¯çº¿æ€§æ— å…³çš„ï¼Œ&lt;/p&gt;

&lt;p&gt;å¦‚æœèƒ½å¤Ÿå¯»æ‰¾åˆ°$n$ä¸ªQ-conjugateå‘é‡$d_i,d_2,â€¦,d_n$ï¼Œåˆ™è¿™ç»„å‘é‡ç»„æˆ$\mathbb{R^n}$ä¸­çš„ä¸€ç»„åŸºï¼Œç©ºé—´å†…ä»»æ„å‘é‡å‡å¯ç”±è¿™ç»„å‘é‡è¡¨ç¤ºã€‚å…±è½­æ¢¯åº¦æ³•é€šè¿‡å¯»æ‰¾è¿™æ ·ä¸€ç»„Q-conjugateçš„åŸºï¼Œå°†ç›®æ ‡å‡½æ•°åˆ†ä¸ºè®¸å¤šæ–¹å‘ï¼Œå¹¶åœ¨è¿™äº›æ–¹å‘ä¸Šåˆ†åˆ«æ±‚å‡ºæå€¼ï¼Œæ‰€æœ‰æ–¹å‘ä¸Šçš„æå€¼çš„å’Œä½œä¸ºæ•´ä½“ç›®æ ‡å‡½æ•°çš„æå€¼ã€‚&lt;/p&gt;

&lt;p&gt;ç»™å®šç›®æ ‡å‡½æ•°$f(x)$ï¼Œå¯»æ‰¾ä¸€ç»„æ–¹å‘å‘é‡$d_1,d_2,â€¦,d_n \in \mathbb{R}^n$ï¼Œä¾æ¬¡æŒ‰ç…§è¿™ç»„æ–¹å‘å‘é‡ä¸­çš„æ–¹å‘å¯¹ç‚¹$x_i\in \mathbb{R}^n$è¿›è¡Œæ›´æ–°ï¼Œå¯¹æ¯ä¸€ä¸ªæ–¹å‘$d_i \in \mathbb{R}^n$ï¼Œå¯»æ‰¾åˆé€‚çš„æ­¥é•¿$\lambda_i$ï¼Œä½¿å¾—$f(x)$åœ¨è¯¥æ–¹å‘ä¸Šå–å¾—æœ€å°å€¼ï¼Œåœ¨ä¸Šè¿°è¿‡ç¨‹ä¸­ï¼Œè¦æ±‚åœ¨åœ¨æ–¹å‘å‘é‡$d_i$ä¸Šè¿›è¡Œæ›´æ–°æ—¶ï¼Œä¸ä¼šå½±å“æ–¹å‘$d_j$ä¸Šçš„æ›´æ–°ç»“æœï¼Œå…¶ä¸­$j\lt i$ï¼Œä¹Ÿå³ï¼Œ$x_{k+1}$ä½¿$f(x)$åœ¨æ–¹å‘$d_k$ä¸Šå–å¾—æœ€å°å€¼ï¼Œä¸”èƒ½å¤Ÿä½¿å¾—$f(x)$åœ¨$d_j,0\le j\lt k$ä¸Šä¿æŒæœ€å°å€¼ã€‚ç”±äºè¿™ç»„æ–¹å‘ä¸¤ä¸¤å…±è½­ï¼Œå› æ­¤è¿™ç§æ–¹æ³•ç§°ä¸ºå…±è½­æ¢¯åº¦æ³•ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœå­˜åœ¨æ»¡è¶³ä¸Šè¿°è¦æ±‚çš„ä¸€ç»„æ–¹å‘ï¼Œåˆ™å¯ä»¥ä¿è¯ç»è¿‡$n$æ¬¡è¿­ä»£åï¼Œæ‰¾åˆ°$f(x)$çš„å…¨å±€æå°å€¼ã€‚&lt;/p&gt;

&lt;p&gt;æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ä»»æ„è®¾ç½®åˆå§‹ç‚¹$x_0$ï¼Œåˆå§‹æ–¹å‘å‘é‡$d_0=\nabla f(x_0)$&lt;/li&gt;
  &lt;li&gt;åˆ¤æ–­$\nabla f(x_i)=0$ï¼Œå¦‚æœæ˜¯ï¼Œè¿”å›$x_i$ï¼Œå¦åˆ™ï¼Œæ‰§è¡Œ3&lt;/li&gt;
  &lt;li&gt;è¿›è¡Œç‚¹çš„æ›´æ–°$x_{i+1}=x_i + \lambda_i d_i$ï¼Œå…¶ä¸­ï¼Œ$\lambda_{i}=\frac{-d_{i}^{T} \nabla f\left(x_{i}\right)}{d_{i}^{T} Q d_{i}}$ï¼Œ$d_{i}=-\nabla f\left(x_{i}\right)+\gamma_{i-1} d_{i-1}$ï¼Œ$\gamma_{i-1}=\frac{d_{i-1}^{T} Q \nabla f\left(x_{i}\right)}{d_{i-1}^{T} Q d_{i-1}}$&lt;/li&gt;
  &lt;li&gt;å¾ªç¯æ‰§è¡Œ2ï½3ç›´è‡³æ‰¾åˆ°æœ€ä¼˜è§£&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;å‚è€ƒ&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.zhihu.com/question/38586401/answer/669303256&quot;&gt;å¦‚ä½•ç†è§£æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•ï¼Ÿ - æœ¨å°æ˜“çš„å›ç­” - çŸ¥ä¹&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://icml.cc/2011/papers/210_icmlpaper.pdf&quot;&gt;On Optimization Methods for Deep Learning&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://blog.csdn.net/sunflower_sara/article/details/81321886?utm_medium=distribute.pc_relevant.none-task-blog-title-10&amp;amp;spm=1001.2101.3001.4242&quot;&gt;æ·±åº¦å­¦ä¹ ä¸­çš„ä¼˜åŒ–å™¨&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Broydenâ€“Fletcherâ€“Goldfarbâ€“Shanno_algorithm&quot;&gt;Broydenâ€“Fletcherâ€“Goldfarbâ€“Shanno algorithm&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/144736223&quot;&gt;æ‹Ÿç‰›é¡¿æ³•&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/158206612&quot;&gt;é™åˆ¶ç©ºé—´çš„ä¼˜åŒ–ç®—æ³•ï¼šLBFGSï¼ŒLSR1&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://arxiv.org/pdf/1609.04747.pdf&quot;&gt;An overview of gradient descent optimization algorithms&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/37524275&quot;&gt;Broydenç±»ç®—æ³•ï¼šBFGSç®—æ³•çš„è¿­ä»£å…¬å¼æ¨å¯¼&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/37524275&quot;&gt;æ¢¯åº¦ä¸‹é™æ³•ã€ç‰›é¡¿æ³•å’Œæ‹Ÿç‰›é¡¿æ³•&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/28623599&quot;&gt;å…±è½­æ¢¯åº¦æ³•&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
</description>
        <pubDate>Wed, 25 Nov 2020 06:04:26 +0800</pubDate>
        <link>http://localhost:4000//2020/11/%E4%BC%98%E5%8C%96%E7%AE%97%E6%B3%95</link>
        <guid isPermaLink="true">http://localhost:4000//2020/11/%E4%BC%98%E5%8C%96%E7%AE%97%E6%B3%95</guid>
        
        <category>Optimization</category>
        
        <category>Machine Learning</category>
        
        
        <category>ML</category>
        
      </item>
    
      <item>
        <title>å­¦ä¹ ç‡å’Œbatch sizeè®¨è®º</title>
        <description>&lt;h2 id=&quot;1-å­¦ä¹ ç‡&quot;&gt;1. å­¦ä¹ ç‡&lt;/h2&gt;

&lt;p&gt;åœ¨æ¨¡å‹è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå­¦ä¹ ç‡æ˜¯ä¸€ä¸ªéå¸¸æ•æ„Ÿä¸”é‡è¦çš„å‚æ•°ï¼Œåœ¨ç¥ç»ç½‘ç»œçš„åå‘ä¼ æ’­ç®—æ³•ä¸­ï¼Œæ¢¯åº¦ä¸‹é™æ˜¯ä¸€ç§å¸¸ç”¨çš„å‚æ•°æ±‚è§£æ–¹æ³•ï¼Œå­¦ä¹ ç‡å½±å“ç€æ¢¯åº¦ä¸‹é™è¿‡ç¨‹ä¸­å‚æ•°æ›´æ–°çš„æ­¥é•¿ã€‚é€šå¸¸ï¼Œç¥ç»ç½‘ç»œçš„å‚æ•°ç©ºé—´å¾ˆå¤§ï¼Œæ¢¯åº¦ä¸‹é™çš„æ±‚è§£ç›®æ ‡æ˜¯æœ€å°åŒ–å®šä¹‰åœ¨å‚æ•°ç©ºé—´ä¸­çš„æŸå¤±å‡½æ•°$L$ï¼Œç”±äºå‚æ•°ç»´åº¦å¾ˆå¤§ï¼Œç›®æ ‡å‡½æ•°ä¸€èˆ¬åŒ…å«ç€è®¸å¤šå±€éƒ¨æœ€å°å€¼ç‚¹ï¼ˆç°æœ‰çš„ç ”ç©¶è¯æ˜ï¼Œå±€éƒ¨æå°å€¼å·²ç»ä¸æ˜¯å½±å“ç¥ç»ç½‘ç»œæ•ˆæœçš„æœ€å¤§éšœç¢äº†ï¼Œä¹Ÿå³ï¼Œå³ä½¿æˆ‘ä»¬æ‰¾ä¸åˆ°å…¨å±€æœ€å°å€¼ï¼Œä¸€ä¸ªå¥½çš„ä¼˜åŒ–ç®—æ³•ä¸€èˆ¬æ€»èƒ½æ‰¾åˆ°ä¸€ä¸ªâ€œè¶³å¤Ÿå¥½â€çš„å±€éƒ¨æå°å€¼ï¼‰ã€‚å­¦ä¹ ç‡çš„å½±å“ä½“ç°åœ¨ï¼Œå¦‚æœå­¦ä¹ ç‡è¿‡å°ï¼Œåˆ™å‚æ•°å¤§å°æ›´æ–°çš„é€Ÿåº¦ä¼šå¾ˆæ…¢ï¼Œå¦‚æœåœ¨è®­ç»ƒå¼€å§‹å‰ï¼Œå‚æ•°æ²¡æœ‰è¢«å¾ˆå¥½åœ°åˆå§‹åŒ–ï¼Œå°çš„å­¦ä¹ ç‡å¾ˆæœ‰å¯èƒ½ä½¿ç›®æ ‡å‡½æ•°é™·å…¥ä¸€ä¸ªå¹¶ä¸è¶³å¤Ÿå¥½çš„å±€éƒ¨æå°å€¼ç‚¹è€Œæ— æ³•è·³å‡ºï¼›ç›¸åï¼Œå¦‚æœå­¦ä¹ ç‡è®¾ç½®å¾ˆå¤§ï¼Œä¸€æ–¹é¢å‚æ•°æ›´æ–°çš„å¹…åº¦å¾ˆå¤§ï¼Œå¯¹åº”çš„ç›®æ ‡å‡½æ•°å¾ˆæœ‰å¯èƒ½åœ¨å‚æ•°ç©ºé—´ä¸­åå¤è·³åŠ¨ï¼Œå³ä½¿åœ¨è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œæ¨¡å‹å¯»æ‰¾åˆ°äº†ä¸€ä¸ªè¶³å¤Ÿå¥½çš„å‚æ•°ç»„åˆï¼Œè¾ƒå¤§çš„æ›´æ–°å¹…åº¦ä¹Ÿä¼šå¯¼è‡´æœ‰å¯èƒ½åœ¨ä¸‹æ¬¡è¿­ä»£ä¸­è·³å‡ºï¼Œå¯¼è‡´è®­ç»ƒè¿‡ç¨‹çš„ä¸ç¨³å®šï¼Œè®­ç»ƒä¸­è¡¨ç°ä¸ºè®­ç»ƒé›†æŸå¤±å‡½æ•°æ³¢åŠ¨æ˜æ˜¾ï¼Œæ”¶æ•›å›°éš¾ã€‚&lt;/p&gt;

&lt;p&gt;é’ˆå¯¹å­¦ä¹ ç‡çš„ä¼˜åŒ–æœ‰ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;åŸºç¡€å­¦ä¹ ç‡çš„è®¾å®š&lt;/p&gt;

    &lt;p&gt;ä¸€èˆ¬ä½¿ç”¨ä¸€ä¸ªåŒºé—´å†…çš„å­¦ä¹ ç‡ï¼Œåœ¨ä¸€ä¸ªepochä¸­ï¼Œå­¦ä¹ ç‡ç”±æœ€å°é€æ¸å¢åŠ åˆ°æœ€å¤§ï¼Œè§‚å¯ŸæŸå¤±å‡½æ•°çš„å˜åŒ–æƒ…å†µï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è¦å¯»æ‰¾çš„åˆç†çš„å­¦ä¹ ç‡åŒºé—´å†…çš„æŸå¤±å‡½æ•°åº”å…·æœ‰è¾ƒé«˜çš„ä¸‹é™é€Ÿç‡ã€‚
&lt;img src=&quot;http://shihanmax.top/20201028203345_YZu2rk_lr_finder.jpeg&quot; alt=&quot;lr&quot; style=&quot;zoom:67%;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;è®­ç»ƒè¿‡ç¨‹ä¸­çš„å­¦ä¹ ç‡è°ƒæ•´&lt;/p&gt;

    &lt;p&gt;ä¸€èˆ¬çš„è°ƒæ•´æ–¹å¼æœ‰ï¼š&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;åˆæœŸå­¦ä¹ ç‡warmupï¼šè®­ç»ƒåˆæœŸï¼Œå­¦ä¹ ç‡æœ‰ä¸€ä¸ªæ¯”è¾ƒå°çš„å€¼é€æ¸å¢åŠ åˆ°åŸºç¡€å­¦ä¹ ç‡ï¼›&lt;/li&gt;
      &lt;li&gt;å­¦ä¹ ç‡è¡°å‡ï¼šè®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå­¦ä¹ ç‡ä»¥æŸç§è¡°å‡æ›²çº¿å½¢å¼é€æ¸å‡å°‘ï¼›&lt;/li&gt;
      &lt;li&gt;å¾ªç¯å­¦ä¹ ç‡ï¼ˆCyclical learning ratesï¼‰ï¼šéšç€è®­ç»ƒè¿‡ç¨‹è¿›è¡Œï¼Œå­¦ä¹ ç‡ä»¥å¾ªç¯çš„æ–¹å¼ï¼Œé€æ¸å¢åŠ è‡³åŸºç¡€å­¦ä¹ ç‡ï¼Œç„¶åé€æ¸è¡°å‡åˆ°ä¸€ä¸ªè¾ƒå°å€¼ï¼Œè¿™ä¸ªè¿‡ç¨‹å¾ªç¯æ‰§è¡Œï¼Œç›´è‡³è®­ç»ƒç»“æŸï¼Œè¿‡ç¨‹ä¸­ï¼ŒåŸºç¡€å­¦ä¹ ç‡æœ¬èº«å¯èƒ½ä¹Ÿä¼šä»¥æŸç§æ–¹å¼é€æ¸è¡°å‡ã€‚&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;img src=&quot;http://shihanmax.top/20201028204513_BsaS8K_Screen-Shot-2018-02-25-at-8.44.49-PM.jpeg&quot; alt=&quot;cyclical lr&quot; style=&quot;zoom: 67%;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ä¸è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå­¦ä¹ ç‡ä¸€ç›´ä¸‹é™ç›¸æ¯”ï¼Œå­¦ä¹ ç‡åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å¢åŠ çš„ä¸€ä¸ªç†è®ºå‡è®¾æ˜¯ï¼Œâ€œçŸ­æœŸå†…ï¼Œå¢åŠ å­¦ä¹ ç‡ä¼šå¯¼è‡´æŸå¤±å¢åŠ ï¼Œä½†é•¿æœŸæ¥çœ‹ï¼Œæ¨¡å‹ä¼šæ”¶æ•›åˆ°ä¸€ä¸ªæ›´ä¼˜çš„è§£â€ã€‚æ”¯æ’‘è¿™ä¸€å‡è®¾çš„ä¸¤ä¸ªåç›´è§‰æ€§çš„æ¨æ–­æ˜¯ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;ä»è®­ç»ƒç›®æ ‡æ¥çœ‹ï¼Œæˆ‘ä»¬å¸Œæœ›è®­ç»ƒçš„åˆ°çš„å‚æ•°è¶³å¤Ÿé²æ£’ï¼Œä¹Ÿå³è¾“å…¥æˆ–å‚æ•°å¾®å°çš„æ³¢åŠ¨ä¸åº”è¯¥å¯¼è‡´ç›®æ ‡å‡½æ•°/æŸå¤±å‡½æ•°å‘ç”Ÿå¤§å¹…åº¦çš„å˜åŒ–ï¼Œè¿™ç§å˜åŒ–å°¤å…¶å¯èƒ½å‘ç”Ÿåœ¨æ¯”è¾ƒç‹­å°çš„æå°å€¼å¤„ï¼ˆsharp minima lead to poor generalizationï¼Œåæ–‡è®¨è®ºbatch sizeçš„å½±å“æ—¶ä¼šæåˆ°ï¼‰ï¼Œè®­ç»ƒè¿‡ç¨‹ä¸­å¢åŠ å­¦ä¹ ç‡ï¼Œèƒ½å¤Ÿæœ‰æ›´å¤§çš„å¯èƒ½ä½¿å‚æ•°ä»è¿™ç§ä¸ç†æƒ³çš„æå°å€¼å‡ºè·³å‡ºï¼›&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;åŒæ ·çš„ï¼Œç›®æ ‡å‡½æ•°è¡¨é¢å¯èƒ½å­˜åœ¨éå¸¸å¤šçš„éç‚¹ï¼ˆåœ¨æŸäº›å‚æ•°ç»´åº¦ä¸Šï¼Œç›®æ ‡å‡½æ•°å–æå°å€¼ï¼ŒåŒæ—¶ï¼Œåœ¨å…¶ä»–å‚æ•°ç»´åº¦ä¸Šåˆ™å–æœ€å¤§å€¼ï¼‰ï¼Œè®­ç»ƒè¿‡ç¨‹ä¸­å¢åŠ å­¦ä¹ ç‡æœ‰åŠ©äºæ›´å¿«åœ°è„±ç¦»éç‚¹ï¼Œèµ·åˆ°åŠ å¿«æ”¶æ•›çš„ä½œç”¨ã€‚&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;è®­ç»ƒç¥ç»ç½‘ç»œåŸºæœ¬ç­‰ä»·äºå¯¹ä¸€ä¸ªé«˜ç»´éå‡¸å‡½æ•°æ±‚æœ€å€¼çš„é—®é¢˜ï¼Œè¿™ä¸ªé—®é¢˜ç†è®ºä¸Šéå¸¸å›°éš¾ï¼Œä½†å®è·µä¸­æœ‰æ—¶åˆæ¯”è¾ƒç®€å•ï¼šåœ¨ä¸€äº›ç®€å•çš„ä»»åŠ¡ä¸Šï¼ŒåŸºäºæ¢¯åº¦ä¸‹é™ç®—æ³•çš„ä¼˜åŒ–æ–¹æ³•æ€»èƒ½å¯»æ‰¾åˆ°å…¨å±€æœ€ä¼˜è§£ã€‚ä½†è¿™å¹¶ä¸æ€»èƒ½å®ç°ï¼Œç¥ç»ç½‘ç»œçš„å¯è®­ç»ƒæ€§å—åˆ°ç½‘ç»œç»“æ„è®¾è®¡ã€ä¼˜åŒ–å™¨çš„é€‰æ‹©ã€å‚æ•°çš„åˆå§‹åŒ–æ•ˆæœã€è®­ç»ƒæ•°æ®åˆ†å¸ƒå’Œå…¶å®ƒä¸€äº›å› ç´ çš„å…±åŒå½±å“ï¼Œé’ˆå¯¹è¿™äº›å› ç´ ï¼Œå®è·µä¸­æ²¡æœ‰ä¸€å¥—é€šç”¨çš„å‡†åˆ™æ¥æŒ‡å¯¼ã€‚æŸäº›ç‰¹å®šçš„ç½‘ç»œç»“æ„èƒ½å¤Ÿä½¿å¾—è®­ç»ƒè¿‡ç¨‹æ›´ä¸ºå®¹æ˜“ï¼ˆå¦‚skip connectionsç­‰ï¼‰ï¼Œè¿™ç¯‡æ–‡ç« &lt;a href=&quot;https://arxiv.org/pdf/1712.09913.pdf&quot;&gt;Visualizing the Loss Landscape of Neural Nets &lt;/a&gt;é€šè¿‡å¯è§†åŒ–çš„æ‰‹æ®µåˆ†æäº†ç¥ç»ç½‘ç»œæŸå¤±å‡½æ•°çš„ç»“æ„ï¼Œæ¦‚æ‹¬æ€§åˆ†æäº†è¿™äº›ç»“æ„å¯¹äºè®­ç»ƒçš„å½±å“ï¼Œä»¥åŠå‚æ•°å¯¹è®­ç»ƒè¿‡ç¨‹çš„å½±å“ã€‚ä½œè€…å‘ç°ï¼Œéšç€ç½‘ç»œæ·±åº¦çš„å¢åŠ ï¼ŒæŸå¤±å‡½æ•°çš„éå‡¸æ€§åŠ å‰§ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://shihanmax.top/20201029204158_fSpDaA_%E6%88%AA%E5%B1%8F2020-10-29%2020.41.50.jpeg&quot; alt=&quot;depth&quot; /&gt;&lt;/p&gt;

&lt;p&gt;å¹¶é€šè¿‡å®éªŒå‘ç°ï¼Œå¦‚æœåœ¨ç½‘ç»œä¸­åŠ å…¥ä¸€äº›çŸ­è·¯è¿æ¥ï¼Œåˆ™æŸå¤±å‡½æ•°è¡¨é¢åˆ™å€¾å‘äºå˜å¾—å…‰æ»‘ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://shihanmax.top/20201029204023_N5naCq_%E6%88%AA%E5%B1%8F2020-10-29%2020.40.15.jpeg&quot; alt=&quot;skip-connections&quot; /&gt;&lt;/p&gt;

&lt;p&gt;è¿™ç¯‡æ–‡ç« &lt;a href=&quot;https://icml.cc/Conferences/2018/Schedule?showEvent=2780&quot;&gt;Essentially No Barriers in Neural Network Energy Landscape&lt;/a&gt; è¯æ˜äº†ï¼Œåœ¨è¾ƒå¤§çš„ç¥ç»ç½‘ç»œä¸­ï¼Œå…¨å±€æœ€ä¼˜è§£å¾€å¾€ä¸æ˜¯ä¸€ä¸ªç‚¹ï¼Œè€Œæ˜¯ä¸€ä¸ªè¿é€šçš„æµå½¢ï¼ˆmanifoldï¼‰ï¼Œä¸€ä¸ªæ›´ä¸€èˆ¬åŒ–çš„è¯´æ³•ï¼šå¦‚æœç›®æ ‡å‡½æ•°å­˜åœ¨ä¸¤ä¸ªå±€éƒ¨æœ€ä¼˜è§£ï¼Œåˆ™ä¸€å®šå¯ä»¥é€šè¿‡ä¸€æ¡å¹³å¦çš„è·¯å¾„ï¼ˆflat pathï¼‰ï¼Œä½¿å¾—è¿™ä¸¤ç‚¹è¿é€šã€‚&lt;/p&gt;

&lt;h2 id=&quot;2-batch-size&quot;&gt;2. batch size&lt;/h2&gt;

&lt;p&gt;åœ¨ç¥ç»ç½‘ç»œè®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå¦ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„è¶…å‚æ•°æ˜¯batch sizeï¼Œä¸ºäº†ä½¿æ¯æ¬¡è¿­ä»£çš„è®¡ç®—é‡æ˜¯å¯æ‰¿å—çš„ï¼Œæˆ‘ä»¬å°†æ‰€æœ‰çš„è®­ç»ƒæ•°æ®åˆ’åˆ†ä¸ºè®¸å¤šä¸ªmini-batchï¼ŒåŒæ—¶ä¸ºäº†æ›´å……åˆ†åœ°åˆ©ç”¨å¹¶è¡ŒåŒ–çš„ä¼˜åŠ¿ï¼Œåº”åœ¨è®¾å¤‡å…è®¸çš„èŒƒå›´å†…å°½é‡å¤§åœ°è®¾ç½®batch sizeï¼Œäººä»¬åœ¨å®è·µä¸­å‘ç°ï¼Œå¢å¤§batch sizeåï¼Œæ¨¡å‹åœ¨æµ‹è¯•é›†ä¸Šçš„è¡¨ç°å¾€å¾€ä¼šå˜å·®ï¼Œåœ¨&lt;a href=&quot;https://arxiv.org/pdf/1609.04836.pdf&quot;&gt;ON LARGE-BATCH TRAINING FOR DEEP LEARNING: GENERALIZATION GAP AND SHARP MINIMA &lt;/a&gt;çš„å®éªŒä¸­ï¼Œç”±batch sizeå˜åŒ–å¸¦æ¥çš„æ€§èƒ½å·®è·ç”šè‡³èƒ½å¤Ÿè¾¾åˆ°5%ã€‚é’ˆå¯¹æ­¤ç°è±¡ï¼Œå¯èƒ½çš„è§£é‡Šå¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;batch sizeå¢å¤§æ—¶ï¼Œæ¨¡å‹å€¾å‘äºè¿‡æ‹Ÿåˆ&lt;/li&gt;
  &lt;li&gt;batch sizeå¢å¤§æ—¶ï¼Œä¼˜åŒ–è¿‡ç¨‹ä¸­æ›´æœ‰å¯èƒ½é‡åˆ°éç‚¹&lt;/li&gt;
  &lt;li&gt;ä¸å°batch sizeè®­ç»ƒå‡ºçš„æ¨¡å‹ç›¸æ¯”ï¼Œå¤§batch sizeæ¨¡å‹åœ¨ä¼˜åŒ–è¿‡ç¨‹ä¸­ç¼ºä¹æ¢ç´¢æ€§ï¼Œä»¥è‡´å€¾å‘æ”¶æ•›äºè·åˆå§‹å‚æ•°è¾ƒè¿‘çš„å±€éƒ¨æœ€ä¼˜è§£&lt;/li&gt;
  &lt;li&gt;batch sizeå˜åŒ–æ—¶ï¼Œæ¨¡å‹æ”¶æ•›åˆ°çš„æœ€ä¼˜è§£å…·æœ‰ä¸åŒçš„æ³›åŒ–ç‰¹æ€§&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä½œè€…é€šè¿‡ç»Ÿè®¡æ€§å®éªŒè¯æ˜äº†åä¸¤ä¸ªæ¨è®ºçš„åˆç†æ€§ï¼šå¢å¤§batch sizeæ—¶ï¼Œæ¨¡å‹å€¾å‘äºæ”¶æ•›åˆ°å°–é”çš„å±€éƒ¨æœ€å°å€¼å¤„ï¼Œè¯¥å¤„è¡¨ç°ä¸ºçŸ©é˜µ$\nabla ^2 f$çš„æ­£ç‰¹å¾å€¼æ›´å¤§ï¼›ç›¸ååœ°ï¼Œå¯¹äºè¾ƒä¸ºå¹³å¦çš„å±€éƒ¨æœ€å°å€¼å¤„å¯¹åº”çš„$\nabla ^2 f$çš„ç‰¹å¾å€¼åˆ™ä¼šå°å¾—å¤šã€‚ ä½œè€…å¼ºè°ƒï¼Œç”±äºbatch sizeå˜åŒ–é€ æˆçš„æ³›åŒ–èƒ½åŠ›å·®åˆ«ï¼ˆgeneralization gapï¼‰å¹¶ä¸æ˜¯ç”±è¿‡æ‹Ÿåˆå¼•èµ·çš„ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://shihanmax.top/20201103203609_IyHglP_%E6%88%AA%E5%B1%8F2020-11-03%2020.36.02.jpeg&quot; alt=&quot;flat&amp;amp;sharp local minima &quot; style=&quot;zoom:80%;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;åœ¨å¤§å‹ç½‘ç»œä¸­ï¼Œè®¡ç®—$\nabla ^2 f$çš„ç‰¹å¾å€¼æ¥è¡¨å¾æå€¼ç‚¹å¤„çš„å°–é”ç¨‹åº¦çš„ä»£ä»·ååˆ†é«˜æ˜‚ï¼Œå› æ­¤ä½œè€…æå‡ºäº†ä¸€ç§æ›¿ä»£æ–¹æ¡ˆç”¨äºè¡¨å¾ç›®æ ‡å‡½æ•°ä»»ä¸€ç‚¹å¤„çš„å°–é”ç¨‹åº¦ï¼Œå¹¶é€šè¿‡å®éªŒå¯¹æ¯”äº†batch sizeå˜åŒ–æ—¶ï¼Œç›®æ ‡å‡½æ•°å°–é”ç¨‹åº¦çš„å˜åŒ–æƒ…å†µï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://shihanmax.top/20201103204854_WbTFyO_%E6%88%AA%E5%B1%8F2020-11-03%2020.48.44.jpeg&quot; alt=&quot;sharpness-bs &quot; style=&quot;zoom:80%;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ä¸ºäº†å°è¯•è§£å†³å¤§batch sizeé‡åˆ°çš„é—®é¢˜ï¼Œä½œè€…å°è¯•äº†æ•°æ®æ‰©å¢ã€ä½¿ç”¨æ›´åŠ é²æ£’çš„ä¼˜åŒ–å™¨ç­‰æªæ–½ï¼Œä½†å®éªŒè¯æ˜ï¼Œåœ¨è¾ƒå¤§çš„batch sizeä¸‹ï¼Œè¿™äº›æ–¹æ³•ä»å€¾å‘äºæ”¶æ•›åˆ°sharp minimizersä¸Šï¼Œå¦ä¸€ç§ä½¿å¾—å¤§batch sizeå¯è¡Œçš„æ–¹æ¡ˆæ˜¯ï¼Œä½¿ç”¨å°batch sizeå…ˆè¿›è¡Œwarmupï¼Œç„¶åå†å°†å…¶è°ƒæ•´åˆ°é¢„è®¾çš„batch sizeã€‚&lt;/p&gt;

&lt;p&gt;å¦å¤–å‡ ä¸ªæœ‰æ„æ€çš„é—®é¢˜ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;æˆ‘ä»¬å¯ä»¥è¯æ˜å¤§çš„batch sizeæ€»æ˜¯ä¼šå¯¼è‡´æ·±åº¦ç¥ç»ç½‘ç»œæ”¶æ•›åˆ°æ›´å°–é”çš„å±€éƒ¨æœ€å°å€¼å—ï¼Ÿ&lt;/li&gt;
  &lt;li&gt;åœ¨ç¥ç»ç½‘ç»œä¸­ï¼Œå°–é”ç¨‹åº¦ä¸åŒçš„å±€éƒ¨æœ€å°å€¼çš„å¯†åº¦åˆ†å¸ƒæƒ…å†µæ—¶æ€æ ·çš„ï¼Ÿ&lt;/li&gt;
  &lt;li&gt;æˆ‘ä»¬å¯ä»¥è®¾è®¡å‡ºé€‚åˆå¤§batch sizeçš„ç¥ç»ç½‘ç»œç»“æ„å—ï¼Ÿ&lt;/li&gt;
  &lt;li&gt;æ˜¯å¦èƒ½å¤Ÿå¯»æ‰¾åˆ°ä¸€ç§è‰¯å¥½çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œä½¿å¾—å¤§batch sizeå¯ä»¥åº”ç”¨åœ¨æ™®é€šçš„ç¥ç»ç½‘ç»œä¸Šï¼Ÿ&lt;/li&gt;
  &lt;li&gt;æ˜¯å¦èƒ½å¤Ÿé€šè¿‡ç®—æ³•æˆ–è€…æ­£åˆ™åŒ–æ‰‹æ®µï¼Œä½¿å¾—èƒ½å¤Ÿé¿å¼€sharp minimizersï¼Ÿ&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Refs.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://towardsdatascience.com/recent-advances-for-a-better-understanding-of-deep-learning-part-i-5ce34d1cc914&quot;&gt;Recent Advances for a Better Understanding of Deep Learning âˆ’ Part I&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.jeremyjordan.me/nn-learning-rate/&quot;&gt;Setting the learning rate of your neural network&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://arxiv.org/pdf/1712.09913.pdf&quot;&gt;Visualizing the Loss Landscape of Neural Nets&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://icml.cc/Conferences/2018/Schedule?showEvent=2780&quot;&gt;Essentially No Barriers in Neural Network Energy Landscape&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://arxiv.org/pdf/1609.04836.pdf&quot;&gt;ON LARGE-BATCH TRAINING FOR DEEP LEARNING: GENERALIZATION GAP AND SHARP MINIMA &lt;/a&gt;&lt;/p&gt;

</description>
        <pubDate>Fri, 06 Nov 2020 06:02:23 +0800</pubDate>
        <link>http://localhost:4000//2020/11/%E5%AD%A6%E4%B9%A0%E7%8E%87%E5%92%8Cbatch-size%E8%AE%A8%E8%AE%BA</link>
        <guid isPermaLink="true">http://localhost:4000//2020/11/%E5%AD%A6%E4%B9%A0%E7%8E%87%E5%92%8Cbatch-size%E8%AE%A8%E8%AE%BA</guid>
        
        <category>Machine Learning</category>
        
        <category>Optimization</category>
        
        
        <category>NLP</category>
        
      </item>
    
      <item>
        <title>On Sentence Embedding</title>
        <description>&lt;p&gt;This article will briefly introduce some papers on document representation.&lt;/p&gt;

&lt;h2 id=&quot;1-a-simple-but-tough-to-beat-baseline-for-sentence-embeddings&quot;&gt;1. A SIMPLE BUT TOUGH-TO-BEAT BASELINE FOR SENTENCE EMBEDDINGS&lt;/h2&gt;

&lt;h3 id=&quot;model&quot;&gt;model&lt;/h3&gt;

&lt;p&gt;This article proposed a method for acquiring sentence embedding called SIF. The method is very simple: for the document collection, first, for each document, the word vector is weighted and averaged with the word frequency as the weight, now we have the representations of each document. Letâ€™s say the number of documents is $D$ and the dimension of the word vector is $E$. Then we get the document set representation matrix $M: D\times E$. Then, perform SVD on the matrix $M$, subtracting its projection in the principal component direction, as the final sentence representation.&lt;/p&gt;

&lt;h3 id=&quot;mathematical-formulation&quot;&gt;mathematical formulation&lt;/h3&gt;

\[v_{s} \leftarrow \frac{1}{|s|} \sum_{w \in s} \frac{a}{a+p(w)} v_{w}\]

\[v_{s} \leftarrow v_{s}-u u^{\top} v_{s}\]

&lt;p&gt;todo: theoretical analysis&lt;/p&gt;

&lt;h2 id=&quot;2-a-structured-self-attentive-sentence-embedding&quot;&gt;2. A STRUCTURED SELF-ATTENTIVE SENTENCE EMBEDDING&lt;/h2&gt;

&lt;p&gt;At present, the research on paragraph/sentence representation is not rich enough comparing with word embeddings. Research on sentence representation is usually divided into two categories:&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;Sentence-level semantic models trained through unsupervised methods, such as SkipThought, paragraphVector, Recursive auto-encoders, Sequential Denoising Autoencoders (SDAE) FastSent, etc.&lt;/li&gt;
  &lt;li&gt;Obtained through supervised training in specific downstream tasks, involving models such as recurrent networks, recursive networks, and convolutional networks;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;This paper proposes a self-attention mechanism for sentences to replace the max/avg pooling operation over tokens at each time step after a traditional RNN layer, and at the same time, it can extract different levels of sentence semantic information.&lt;/p&gt;

&lt;h3 id=&quot;the-proposed-model&quot;&gt;the proposed model&lt;/h3&gt;

&lt;p&gt;The sentence representation model proposed in this article is divided into two parts:&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;Bidirectional LSTM layer&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Self-attention layer&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;For sentence: $S=(w_1, w_2, â€¦, w_n)$, where $w_i$ represents the $d$-dimensional word embedding of the $i$-th word. $S$ can be expressed as a matrix $S_{n \times d}$ without any relationship along the rows.&lt;/p&gt;

&lt;p&gt;Then input $S$ into the bidirectional LSTM:&lt;/p&gt;

\[\begin{aligned} \overrightarrow{h_{t}} &amp;amp;=\overrightarrow{L S T M}\left(w_{t}, \overrightarrow{h_{t-1}}\right) \\ \overleftarrow{h_{t}} &amp;amp;=\overleftarrow{L S T M}\left(w_{t}, \overleftarrow{h_{t+1}}\right) \end{aligned}\]

&lt;p&gt;After concat the output of each time step toward the forward and backward directions, the representation matrix $H_{n \times 2u}=(h_1, h_2, â€¦, h_n)$ is obtained, where $u$ is the hidden dimension of LSTM.
Because it is planned to encode the variable-length sequence into a fixed-size representation vector, it is necessary to aggregate the representation vector of each token of the variable-length sequence, attention mechanism is used to calculate the weight of each token. The weight vector calculation method is as follows:&lt;/p&gt;

\[\mathbf{a}=\operatorname{softmax}\left(\mathbf{w}_{\mathbf{s} 2} \tanh \left(W_{s 1} H^{T}\right)\right)\]

&lt;p&gt;$W_{s1}:d_a \times 2u$ï¼Œ$w_{s2}: 1 \times d_a$ï¼Œ$d_a$ is a hyper-parameter.&lt;/p&gt;

&lt;p&gt;At this time, $\mathbf{a}$ is a vector of $1\times n$, which represents the weight of each token in the weighted average process. Perform weighted average for each token in the representation matrix $H$ to get the sentence representation $m$ of $1 \times d$.&lt;/p&gt;

&lt;p&gt;For longer sentences or sentences that contain different descriptions or contexts, sometimes we want to express the sentence from different point of views. In order to achieve this, the author replace the vector $w_ {s2}: 1 \times d_a$ with a matrix $W_{s2}: r\times d_a$, which do the same thing like multi-head attention. Note that at this time softmax should be executed line by line.&lt;/p&gt;

&lt;p&gt;Finally we got the attention score matrix $A: r\times n$, and do the dot product with the representation matrix $H$ to get the final representation matrix $M$ of the sentence:&lt;/p&gt;

\[M=AH\]

&lt;h3 id=&quot;penalty-term&quot;&gt;penalty term&lt;/h3&gt;

&lt;p&gt;In order to avoid the loss of diversity of multi-head attention, a penalty item needs to be added to the matrix $A$. The author found in the experiment that using KL divergence to measure the diversity between weights is not stable (a large number of items are close to 0 in $A$ after softmax, This leads to numerical instability in the calculation of KL divergence). In addition, it is obvious that KL divergence cannot be achieved if we want each row vector to focus on a single characteristic as much as possible. The author used the following penalties:&lt;/p&gt;

\[P=\left\|\left(A A^{T}-I\right)\right\|_{F}^{2}\]

&lt;p&gt;This penalty item will be minimized together with loss of downstream tasks during traing.&lt;/p&gt;

&lt;h3 id=&quot;summary&quot;&gt;summary&lt;/h3&gt;

&lt;p&gt;The advantage of the method proposed in this paper is that it can force the attention to be calculated from different angles during the training process, and it can overcome the problem of long-distance dependence to a certain extent. The disadvantage is that this method is relatively dependent on downstream tasks, and can only be trained in a supervised manner, and has limited compatibility between different tasks.&lt;/p&gt;

&lt;h2 id=&quot;3-distributed-representations-of-sentences-and-documents&quot;&gt;3. Distributed Representations of Sentences and Documents&lt;/h2&gt;

&lt;p&gt;The shortcomings of the current method of obtaining sentence embedding:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;bag-of-words model
    &lt;ul&gt;
      &lt;li&gt;lost order info&lt;/li&gt;
      &lt;li&gt;less semantic&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;bag-of-n-grams&lt;/li&gt;
  &lt;li&gt;data sparsity&lt;/li&gt;
  &lt;li&gt;high-dimensionality&lt;/li&gt;
  &lt;li&gt;less semantic&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This paper proposes an unsupervised sentence embedding training method for variable length text: Paragraph Vector.&lt;/p&gt;

&lt;p&gt;There are two training methods for Paragraph Vector:&lt;/p&gt;

&lt;h3 id=&quot;1-a-distributed-memory-model&quot;&gt;1. A distributed memory model&lt;/h3&gt;

&lt;p&gt;For corpus C, suppose it contains $N$ paragraphs, and the embedding dimension of each paragraph is $p$; the corpus contains $M$ words, and the embedding dimension of each word is $q$; The number of parameters the model needs to learn is $N \times p + M \times q$, each paragraph is mapped to a paragraph id (that is, we can treat paragraphs in the corpus as special words).&lt;/p&gt;

&lt;p&gt;During the training, for a paragraph, we select a sliding window W. The text in the window is called context, which is the basic unit of training. The context in the same paragraph shares the paragraph embedding, and the words in the entire corpus share words embedding. For context C, use its paragraph vector to concatenate the word embedding of each word in C to predict what the next word of this context is.&lt;/p&gt;

&lt;p&gt;At prediction time, for the set of paragraphs to be predicted ${P}_{n}$, first, add it to corpus C (that is, add $n$ rows to the paragraph matrix),  then continue to execute the training process on new corpus until convergence, with word embedding fixed.&lt;/p&gt;

&lt;p&gt;In this training method, the paragraph vector plays a memory role of the topic and other information of the paragraph, so it is called PV-DM (Distributed Memory Paragraph Vectors).&lt;/p&gt;

&lt;h3 id=&quot;2-distributed-bag-of-words&quot;&gt;2. Distributed bag of words&lt;/h3&gt;
&lt;p&gt;Another method of PV training is as follows, which is similar to training the skip-gram model in Word2vec. In the training process, a window W is sampled from the paragraph P, and given the paragraph vector of the paragraph to which the window belongs, predict the random sampling word w from the window. This method named PV-DBOW because it ignores the order of words.&lt;/p&gt;

&lt;p&gt;Experimental results show that combining the sentence vectors obtained by these two methods can get more stable and better results.&lt;/p&gt;

&lt;h3 id=&quot;futher-observations&quot;&gt;futher observations&lt;/h3&gt;
&lt;ol&gt;
  &lt;li&gt;The effect of PV-DM is better than PV-DBOW&lt;/li&gt;
  &lt;li&gt;In PV-DM, concat paragraph vectors and word embedding could achive better result&lt;/li&gt;
  &lt;li&gt;The selection of window size requires cross-validation&lt;/li&gt;
  &lt;li&gt;The time cost to obtain the paragraph vector is high, but this problem can be alleviated by parallel computing.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Refs.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://openreview.net/pdf?id=SyK00v5xx&quot;&gt;1. A SIMPLE BUT TOUGH-TO-BEAT BASELINE FOR SENTENCE EMBEDDINGS&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/PrincetonML/SIF/blob/master/src/SIF_embedding.py&quot;&gt;2. Implementation of SIF&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://arxiv.org/pdf/1703.03130&quot;&gt;3. A STRUCTURED SELF-ATTENTIVE SENTENCE EMBEDDING &lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://cn.arxiv.org/pdf/1405.4053.pdf&quot;&gt;4. Distributed Representations of Sentences and Documents&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Fri, 25 Sep 2020 07:34:18 +0800</pubDate>
        <link>http://localhost:4000//2020/09/On-Sentence-Embedding</link>
        <guid isPermaLink="true">http://localhost:4000//2020/09/On-Sentence-Embedding</guid>
        
        <category>Deep Learning</category>
        
        <category>Embedding</category>
        
        
        <category>NLP</category>
        
      </item>
    
      <item>
        <title>å¤šæ¨¡æ€å­¦ä¹ </title>
        <description>&lt;p&gt;å¤šæ¨¡æ€å­¦ä¹ æ—¨åœ¨æ­å»ºèƒ½å¤Ÿå¤„ç†å¤šç§æ¨¡æ€ä¿¡æ¯çš„æ¨¡å‹ï¼Œæ–‡ç« &lt;a href=&quot;https://arxiv.org/pdf/1705.09406.pdf&quot;&gt;Multimodal Machine Learning: A Survey and Taxonomy &lt;/a&gt; ä»è¡¨ç¤ºï¼ˆRepresentationï¼‰ã€ç¿»è¯‘ï¼ˆTranslateï¼‰ã€å¯¹é½ï¼ˆAlignmentï¼‰ã€èåˆï¼ˆFusionï¼‰ã€ååŒå­¦ä¹ ï¼ˆCo-learningï¼‰ç­‰å‡ ä¸ªæ–¹é¢å¯¹å¤šæ¨¡æ€å­¦ä¹ è¿›è¡Œç»¼è¿°ã€‚é‡ç‚¹å…³æ³¨è¯­è¨€ã€å›¾åƒå’Œå£°éŸ³ä¸‰ç§æ¨¡æ€ã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;è¡¨ç¤ºï¼ˆrepresentationï¼‰ï¼šå„ç§æ¨¡æ€æ˜¯å¼‚è´¨çš„ï¼ˆå¦‚æ–‡æœ¬é€šå¸¸åŸºäºç¬¦å·è¡¨ç¤ºï¼Œè€Œå£°å­¦å’Œè§†è§‰ä¿¡æ¯å¾€å¾€é€šè¿‡ä¿¡å·è¡¨ç¤ºï¼‰ï¼Œæ„é€ ä½¿å¾—ä¸åŒæ¨¡æ€ä¿¡æ¯èƒ½å¤Ÿäº’ç›¸èåˆã€æ‘’å¼ƒå†—ä½™ä¿¡æ¯çš„ä¿¡æ¯è¡¨è¾¾æ–¹å¼æ˜¯è‡³å…³é‡è¦çš„ã€‚&lt;/li&gt;
  &lt;li&gt;ç¿»è¯‘ï¼ˆtranslationï¼‰ï¼šå¤šç§æ¨¡æ€ä¹‹é—´çš„å¯¹åº”å…³ç³»å¼€æ”¾æ€§ã€ä¸»è§‚æ€§è¾ƒå¼ºï¼Œæ¨¡æ€é—´çš„æ˜ å°„å¸¸å¸¸ä¸æ­¢ä¸€ç§æ–¹å¼ï¼Œæ€è€ƒï¼šç”¨ä¸€æ®µè¯æè¿°ä¸€å¼ å›¾ç‰‡ï¼Œæœ‰å‡ ç§æ–¹å¼ï¼Ÿ&lt;/li&gt;
  &lt;li&gt;å¯¹é½ï¼ˆalignmentï¼‰ï¼šæ¨¡æ€é—´çš„ä¿¡æ¯éœ€è¦è¿›è¡Œå¯¹å…¶ï¼Œç”¨ä»¥ç¡®å®šä¸åŒæ¨¡æ€å†…çš„å…ƒç´ çš„ç›´æ¥å…³ç³»&lt;/li&gt;
  &lt;li&gt;èåˆï¼ˆfusionï¼‰ï¼šåœ¨å®é™…è¿ç”¨ä¸­ï¼Œåº”å¯»æ‰¾åˆç†çš„å¤šæ¨¡æ€ä¿¡æ¯èåˆæ–¹å¼ï¼Œä»¥æœ€å¤§åŒ–å¤šæ¨¡æ€å…±åŒé¢„æµ‹æ—¶çš„æ•ˆç‡å’Œå‡†ç¡®ç‡&lt;/li&gt;
  &lt;li&gt;ååŒå­¦ä¹ ï¼ˆco-learningï¼‰ï¼šåœ¨æŸä¸€ç§æ¨¡æ€èµ„æºæœ‰é™æ—¶ï¼Œé€šè¿‡èµ„æºä¸°å¯Œçš„å¦ä¸€ç§æ¨¡æ€è¾…åŠ©è®­ç»ƒï¼Œä»¥è¾¾åˆ°å¤šä¸ªæ¨¡æ€çš„æ¨¡å—ååŒè®­ç»ƒçš„ç›®çš„ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;å›é¡¾å¤šæ¨¡æ€æ¨¡å‹çš„åº”ç”¨å†å²&quot;&gt;å›é¡¾å¤šæ¨¡æ€æ¨¡å‹çš„åº”ç”¨å†å²&lt;/h2&gt;

&lt;ol&gt;
  &lt;li&gt;AVSRï¼šï¼ˆAudio-visual speech recognitionï¼‰ï¼šåŸæœ¬æ„åœ¨é€šè¿‡è§†è§‰ä¿¡æ¯æé«˜è¯­è¨€è¯†åˆ«å‡†ç¡®ç‡ï¼Œå®éªŒå‘ç°è§†è§‰ä¿¡æ¯åœ¨è¯­éŸ³ä¿¡æ¯åŒ…å«å™ªå£°è¾ƒå¤šæ—¶å˜å¾—é‡è¦ï¼Œè¿™ä¸€è¯•éªŒè¡¨æ˜è§†è§‰ä¿¡æ¯å’Œè¯­éŸ³ä¿¡æ¯è¿™ä¸¤ç§æ¨¡æ€ä¹‹é—´æœ‰ä¸€å®šçš„ä¿¡æ¯äº¤äº’ï¼›&lt;/li&gt;
  &lt;li&gt;å¤šåª’ä½“ä¿¡æ¯æ£€ç´¢ï¼šäº’è”ç½‘ä¸Šå„ç§æ¨¡æ€ä¿¡æ¯å¢é•¿è¶‹åŠ¿è¿…çŒ›ï¼Œéœ€è¦å¼€å‘èƒ½å¤Ÿç›´æ¥è¿›è¡Œå¤šæ¨¡æ€ä¿¡æ¯æ£€ç´¢çš„æ¨¡å‹ï¼Œæ¥é€æ¸å–ä»£å•çº¯çš„åŸºäºå…³é”®è¯çš„ä¿¡æ¯æ£€ç´¢æ–¹å¼ã€‚ä¸€ä¸ªä¼˜ç§€çš„æ•°æ®é›†ï¼šMEDï¼ˆmultimedia event detectionï¼‰ï¼›&lt;/li&gt;
  &lt;li&gt;äººç±»å¤šæ¨¡æ€äº¤äº’ç†è§£ï¼š21ä¸–çºªåˆé€æ¸å…´èµ·ï¼Œæ•°æ®é›†æœ‰ï¼šAMI Meeting Corpus ã€SEMAINE corpusï¼Œæ¯”èµ›ï¼šAVEC challengeï¼›&lt;/li&gt;
  &lt;li&gt;æœ€è¿‘å…´èµ·äº†è¯­è¨€å’Œè§†è§‰ä¸¤ç§æ¨¡æ€èåˆçš„ä»»åŠ¡ï¼Œå¦‚image captioningï¼ˆå›¾åƒæè¿°ï¼‰ï¼Œè¿™ä¸€ä»»åŠ¡çš„éš¾ç‚¹åœ¨äºæ¨¡å‹çš„è¯„ä»·ï¼ŒVQAä»»åŠ¡é€šè¿‡å›¾ç‰‡æé—®çš„æ–¹å¼å°è¯•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;representations&quot;&gt;representations&lt;/h2&gt;

&lt;p&gt;å¤šæ¨¡æ€è¡¨è¾¾é¢ä¸´ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼šå¦‚ä½•èåˆå¤šç§æ¨¡æ€çš„ç‰¹å¾ï¼Ÿå¦‚ä½•å¤„ç†ä¸åŒå±‚çº§çš„å™ªå£°ï¼Ÿå¦‚ä½•å¤„ç†ç¼ºå¤±çš„æ¨¡æ€ï¼ŸBengioè®¤ä¸ºï¼Œä¸€ä¸ªå¥½çš„è¡¨ç¤ºï¼Œåº”å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼šå¹³æ»‘æ€§ï¼ˆsmoothnessï¼‰ï¼Œæ—¶ç©ºä¸€è‡´æ€§ï¼ˆtemporal and spatial coherenceï¼‰ï¼Œç¨€ç–æ€§ï¼ˆsparsityï¼‰ï¼Œèšé›†æ€§ï¼ˆnatural clustering amongst othersï¼‰ï¼›è‡³äºå¤šæ¨¡æ€è¡¨è¾¾ï¼ŒSrivastava and Salakhutdinovæå‡ºï¼Œè¡¨ç¤ºç©ºé—´ä¸­çš„ç›¸ä¼¼è¡¨è¾¾åº”èƒ½å¤Ÿåæ˜ ä¸åŒæ¨¡æ€æ‰€åŒ…å«çš„æ¦‚å¿µçš„ç›¸ä¼¼ç¨‹åº¦ï¼›å¤šæ¨¡æ€çš„è¡¨å¾åº”æ˜¯æ˜“äºè·å–çš„ï¼Œå³ä¾¿æŸäº›æ¨¡æ€æ•°æ®ç¼ºå¤±ï¼Œå¹¶ä¸”ï¼Œå…¶ä½™æ¨¡æ€æ•°æ®åº”èƒ½å¤Ÿâ€œæ¨ç†â€å‡ºç¼ºå¤±æ¨¡æ€çš„è¡¨è¾¾ã€‚&lt;/p&gt;

&lt;p&gt;è‡³3&lt;/p&gt;

&lt;h2 id=&quot;è®ºæ–‡ç¬”è®°&quot;&gt;è®ºæ–‡ç¬”è®°&lt;/h2&gt;
&lt;p&gt;å¤šæ¨¡æ€å­¦ä¹ æ˜¯æ·±åº¦å­¦ä¹ é¢†åŸŸä¸­ä¸€ä¸ªæ¯”è¾ƒçƒ­é—¨çš„æ–¹å‘ï¼Œæœ¬æ–‡è®°å½•ä¸€ä¸‹è¿™ä¸ªæ–¹å‘çš„ç›¸å…³è®ºæ–‡ï¼Œæ–¹ä¾¿å‚è€ƒã€‚&lt;/p&gt;

&lt;h3 id=&quot;1-one-model-to-learn-them-all&quot;&gt;1. one model to learn them all&lt;/h3&gt;

&lt;p&gt;æœ¬æ–‡æå‡ºäº†ä¸€ä¸ªå¤šæ¨¡æ€æ¨¡å‹ï¼Œå°†8ä¸ªä»»åŠ¡èåˆåœ¨ä¸€ä¸ªæ¨¡å‹ä¸­ï¼Œå…·ä½“åŒ…å«ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Parsing&lt;/li&gt;
  &lt;li&gt;Speech recognization&lt;/li&gt;
  &lt;li&gt;ImageNet classification&lt;/li&gt;
  &lt;li&gt;Image caption&lt;/li&gt;
  &lt;li&gt;Translation&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æ¨¡å‹åœ¨å„ä¸ªä»»åŠ¡ä¸Šéƒ½å–å¾—äº†ä¸é”™çš„æ•ˆæœï¼Œéƒ¨åˆ†è¶…è¿‡äº†ä¸€äº›æ–°æ¨¡å‹ï¼ˆè™½ç„¶è¿˜æ²¡æœ‰è¾¾åˆ°sotaæ°´å¹³ï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;ä½œè€…è®¤ä¸ºï¼Œæœ¬æ–‡æœ‰ä¸¤ä¸ªä¸»è¦è´¡çŒ®ï¼ˆå¯¹å¤šæ¨¡æ€ç½‘ç»œè‡³å…³é‡è¦çš„ä¸¤ç‚¹ï¼‰ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ä¿¡æ¯é€šè¿‡å„ä¸ªæ¨¡æ€ç›¸å…³çš„å°å‹ç½‘ç»œè½¬æ¢åˆ°ä¸€ä¸ªé€šç”¨çš„ä¸­é—´å½¢æ€ï¼Œå†ç”±è¯¥ä¸­é—´å½¢æ€é€šè¿‡ä¸åŒçš„æ¨¡æ€ç½‘ç»œè½¬åŒ–ä¸ºè¾“å‡º
    &lt;ul&gt;
      &lt;li&gt;ä¸­é—´è¡¨ç¤ºå±‚çš„å°ºåº¦æ˜¯å¯å˜çš„&lt;/li&gt;
      &lt;li&gt;åŒä¸€é¢†åŸŸä¸‹ï¼Œä¸åŒä»»åŠ¡å…±äº«æ¨¡æ€ç½‘ç»œ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;å„ç§ä»»åŠ¡å¯¹å„ä¸ªå­è®¡ç®—æ¨¡å—çš„é‡è¦æ€§ä¾èµ–ç¨‹åº¦ä¸åŒï¼ˆå¦‚ï¼Œattentionæœºåˆ¶åœ¨ç¿»è¯‘ä»»åŠ¡ä¸­çš„é‡è¦ç¨‹åº¦é«˜äºå…¶åœ¨image captionä»»åŠ¡ä¸­çš„å½±å“ï¼‰&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&quot;æ¨¡å‹ç»“æ„&quot;&gt;æ¨¡å‹ç»“æ„&lt;/h4&gt;

&lt;p&gt;æ¨¡å‹çš„æ•´ä½“ç»“æ„åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;encoder&lt;/li&gt;
  &lt;li&gt;I/O Mixer&lt;/li&gt;
  &lt;li&gt;AR decoder&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;åœ¨encoderå’Œdecoderä¸­ï¼Œä¸»è¦åŒ…å«ä»¥ä¸‹è®¡ç®—ç»„ä»¶ï¼ˆcomputational blocksï¼‰ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;conv&lt;/p&gt;

    &lt;p&gt;å±€éƒ¨ç‰¹å¾æ•è·ï¼Œä½¿ç”¨depthwise separable conv&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;attention layer&lt;/p&gt;

    &lt;p&gt;å…³æ³¨é‡è¦çš„ç‰¹å¾&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ç¨€ç–é—¨é™æ¨¡å—é›†æˆï¼ˆSparsely-gated mixture-of-expertsï¼‰&lt;/p&gt;

    &lt;p&gt;åœ¨ä¿è¯è®¡ç®—å¤æ‚åº¦çš„å‰æä¸‹ï¼Œå¢å¤§æ¨¡å‹å®¹é‡ï¼Œç”±ä¸€ç³»åˆ—å‰é¦ˆç½‘ç»œå’Œå¯è®­ç»ƒçš„é—¨é™ç½‘ç»œæ„æˆï¼Œè´Ÿè´£ä»å„ä¸ªè¾“å…¥ä¸­é€‰æ‹©ç¨€ç–çš„ç»„åˆ&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ä¸ºäº†é€‚åº”å„ä¸ªä»»åŠ¡çš„å½¢æ€ï¼Œæœ¬æ–‡æå‡ºäº†ä¸€äº›ä»»åŠ¡ç›¸å…³çš„å­ç½‘ç»œï¼ˆæ¨¡æ€ç½‘ç»œï¼ŒModality-netsï¼‰ï¼Œä¸»è¦åŒ…æ‹¬ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;è¯­è¨€æ¨¡æ€ç½‘ç»œ&lt;/li&gt;
  &lt;li&gt;å›¾åƒæ¨¡æ€ç½‘ç»œ&lt;/li&gt;
  &lt;li&gt;ç±»åˆ«æ¨¡æ€ç½‘ç»œï¼ˆCategorical modality netï¼‰&lt;/li&gt;
  &lt;li&gt;è¯­éŸ³æ¨¡æ€ç½‘ç»œ&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&quot;å®éªŒéƒ¨åˆ†&quot;&gt;å®éªŒéƒ¨åˆ†&lt;/h4&gt;

&lt;p&gt;å®éªŒéƒ¨åˆ†ï¼Œæœ¬æ–‡å›ç­”äº†ä¸‰ä¸ªé—®é¢˜ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;æœ¬æ–‡æå‡ºçš„MultiModelåœ¨8ä¸ªå­ä»»åŠ¡ä¸Šï¼Œç¦»sotaè¿˜æœ‰å¤šè¿œï¼Ÿ&lt;/p&gt;

    &lt;p&gt;çœ‹è®ºæ–‡ç»“æœï¼Œåº”è¯¥è¿˜æ˜¯æœ‰ä¸€æ®µè·ç¦»ï¼Œä½œè€…è¡¨ç¤ºç”±äºæ²¡æœ‰ä»”ç»†è°ƒå‚ï¼Œå½“å‰å¤šæ¨¡æ€æ¨¡å‹çš„ç»“æœè¿˜æ— æ³•è¶…è¶Šç»è¿‡ç»†è‡´è°ƒå‚çš„ä¼ ç»Ÿæ¨¡å‹ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;åŒæ—¶è®­ç»ƒ8ä¸ªå­ä»»åŠ¡ï¼Œä¸åˆ†åˆ«è®­ç»ƒæœ‰ä»€ä¹ˆå·®åˆ«ï¼Ÿ&lt;/p&gt;

    &lt;p&gt;åœ¨è®­ç»ƒå¤šæ¨¡æ€æ¨¡å‹çš„åŒæ—¶ ï¼Œä½œè€…åœ¨åŒç­‰æ¡ä»¶ä¸‹åŒæ—¶è®­ç»ƒäº†ç‹¬ç«‹çš„æ¨¡å‹ï¼Œå®éªŒç»“æœè¡¨æ˜å¤šæ¨¡æ€è”åˆè®­ç»ƒæ—¶çš„ç»“æœä¸ç‹¬ç«‹è®­ç»ƒå„ä¸ªä»»åŠ¡ç›¸ä¼¼ï¼Œåœ¨ä¸ªåˆ«ä»»åŠ¡ä¸Šç”šè‡³æœ‰ä¸€äº›æå‡ï¼Œè®­ç»ƒæ•°æ®è¶Šå°‘çš„ä»»åŠ¡ï¼Œæå‡é€šå¸¸ä¼šè¶Šæ˜æ˜¾ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ä¸åŒçš„è®¡ç®—ç»„ä»¶ï¼ˆcomputational blocksï¼‰åœ¨å­ä»»åŠ¡ä¸Šçš„å½±å“å¦‚ä½•ï¼Ÿ&lt;/p&gt;

    &lt;p&gt;è¿™äº›ç»„ä»¶çš„å­˜åœ¨ï¼Œè‡³å°‘ä¸ä¼šå¸¦æ¥å­ä»»åŠ¡æ€§èƒ½çš„ä¸‹é™ã€‚&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;å¤šæ¨¡æ€ç½‘ç»œè®¾è®¡çš„è¦ç‚¹åœ¨äºï¼Œä»»åŠ¡é—´èƒ½å¤Ÿå…±äº«çš„å‚æ•°å°½é‡è¦åœ¨æ¨¡æ€é—´å…±äº«ï¼Œè¿™æœ‰åŠ©äºä¸åŒæ¨¡æ€ä¹‹é—´è¡¨ç¤ºç©ºé—´çš„ç»Ÿä¸€ï¼ŒåŒæ—¶ä¹Ÿèƒ½é™ä½task-specificçš„å‚æ•°é‡ï¼Œæ§åˆ¶æ¨¡å‹çš„å°ºå¯¸ã€‚&lt;/p&gt;

&lt;p&gt;Refs.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;http://arxiv.org/abs/1610.02357&quot;&gt;Depthwise separable conv&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://arxiv.org/abs/1701.06538&quot;&gt;Outrageously large neural networks: The sparsely-gated mixture-of-experts layer&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://arxiv.org/pdf/1706.05137.pdf&quot;&gt;One model to learn them all&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

</description>
        <pubDate>Wed, 23 Sep 2020 06:35:01 +0800</pubDate>
        <link>http://localhost:4000//2020/09/Multi-Modal-Learning</link>
        <guid isPermaLink="true">http://localhost:4000//2020/09/Multi-Modal-Learning</guid>
        
        <category>Multi-modal Learning</category>
        
        <category>Deep Learning</category>
        
        
        <category>NLP</category>
        
      </item>
    
      <item>
        <title>MLE &amp; MAP</title>
        <description>&lt;p&gt;ç»å¤§éƒ¨åˆ†æœºå™¨å­¦ä¹ çš„ä¼˜åŒ–è¿‡ç¨‹æœ€ç»ˆéƒ½ä¼šè½¬åŒ–ä¸ºæ±‚ç›®æ ‡å‡½æ•°æœ€å€¼çš„è¿‡ç¨‹ï¼ŒMLEï¼ˆMaximum Likelihood Estimationï¼Œæœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼‰å’ŒMAPï¼ˆMaximum A Posterioriï¼Œæœ€å¤§åéªŒä¼°è®¡ï¼‰æ˜¯ä¸¤ç§ç”Ÿæˆç›®æ ‡å‡½æ•°çš„æ€æƒ³ã€‚ä¸‹æ–‡å°è¯•è®¨è®ºMLEå’ŒMAPçš„åŒºåˆ«å’Œè”ç³»ã€‚&lt;/p&gt;

&lt;p&gt;MLEä»…é€šè¿‡è§‚æµ‹æ ·æœ¬å¯¹å‚æ•°è¿›è¡Œä¼°è®¡ï¼ŒMLEçš„ç›®æ ‡å‡½æ•°ä¸º$\arg\max P(D\mid \theta)$ï¼Œè€ŒMAPä¸ä»…é€šè¿‡è§‚æµ‹çš„æ ·æœ¬ï¼ŒåŒæ—¶ä¹Ÿé€šè¿‡å…ˆéªŒï¼ˆprioriï¼‰è¿›è¡Œå‚æ•°çš„ä¼°è®¡ï¼Œå…¶ç›®æ ‡å‡½æ•°ä¸º$\arg \max P(\theta \mid D)$ã€‚&lt;/p&gt;

&lt;h1 id=&quot;æœ€ä¼˜åŒ–map&quot;&gt;æœ€ä¼˜åŒ–MAP&lt;/h1&gt;

\[\begin{aligned} \arg\max P(\theta \mid D) &amp;amp;= \arg\max P(D\mid\theta) \cdot P(\theta)\\ &amp;amp;=\arg\max \log P(D\mid \theta) + \log P(\theta) \end{aligned}\]

&lt;p&gt;ç”±ä¸Šå¼å¯ä»¥çœ‹å‡ºï¼ŒMAPçš„ç›®æ ‡å‡½æ•°çš„ç¬¬ä¸€é¡¹ä¸ºMLEçš„ç›®æ ‡å‡½æ•°ï¼Œç¬¬äºŒé¡¹$\log(\theta)$ç›¸å½“äºä¼˜åŒ–MAPçš„è¿‡ç¨‹ä¸­ï¼Œå¯¹MLEç›®æ ‡å‡½æ•°æ–½åŠ çš„æ­£åˆ™åŒ–é¡¹ï¼Œä¸‹æ–‡å°†è¯æ˜ï¼Œéšç€$\theta$åˆ†å¸ƒçš„ä¸åŒï¼Œæ­£åˆ™åŒ–é¡¹çš„ç±»å‹ä¹Ÿä¸åŒã€‚&lt;/p&gt;

&lt;p&gt;ä¸‹æ–‡ä»¥Logistic Regressionä¸ºä¾‹ï¼š&lt;/p&gt;

\[\begin{aligned} objective\ of\ MAP &amp;amp;= \arg\max P(\theta \mid D) \\ &amp;amp;=\arg\max P(D\mid \theta) \cdot P(\theta) \\ &amp;amp;=\arg\max \log P(D\mid \theta) + \log P(\theta) \\&amp;amp;=\arg\max \sum_\limits{i=1}^n \log P(y_i\mid x_i;\theta) + \log P(\theta)  \end{aligned}\]

&lt;h1 id=&quot;ä»é«˜æ–¯å…ˆéªŒåˆ°l_2æ­£åˆ™&quot;&gt;ä»é«˜æ–¯å…ˆéªŒåˆ°$L_2$æ­£åˆ™&lt;/h1&gt;

&lt;p&gt;å‡è®¾å‚æ•°$\theta$æœä»é«˜æ–¯åˆ†å¸ƒï¼š&lt;/p&gt;

\[\begin{aligned}logP(\theta)&amp;amp;=log(\frac{1}{\sqrt{2\pi}\sigma}exp(-\frac{\theta^2}{2\sigma^2})) \\&amp;amp;=-log(\sqrt{2\pi}\sigma) - \frac{\theta^2}{2\sigma^2}  \end{aligned}\]

&lt;p&gt;åˆ™MAPçš„ç›®æ ‡å‡½æ•°å¯å†™ä½œï¼š&lt;/p&gt;

\[\begin{aligned} objective\ of\ MAP &amp;amp;=\arg\max \sum_\limits{i=1}^n \log P(y_i\mid x_i;\theta) -log(\sqrt{2\pi}\sigma) - \frac{\theta^2}{2\sigma^2} \\&amp;amp;=\arg\max \sum_\limits{i=1}^n \log P(y_i\mid x_i;\theta)-\frac{1}{2\sigma^2}\Vert \theta \Vert_2^2 \end{aligned}\]

&lt;p&gt;å³ï¼šå½“å‚æ•°æœä»é«˜æ–¯åˆ†å¸ƒæ—¶ï¼ŒMAPç›®æ ‡å‡½æ•°ä¸­çš„$\log P(\theta	)$é¡¹ç›¸å½“äºå¯¹MLEç›®æ ‡å‡½æ•°æ–½åŠ çš„$L_2$æ­£åˆ™ã€‚&lt;/p&gt;

&lt;h1 id=&quot;ä»æ‹‰æ™®æ‹‰æ–¯å…ˆéªŒåˆ°l_1æ­£åˆ™&quot;&gt;ä»æ‹‰æ™®æ‹‰æ–¯å…ˆéªŒåˆ°$L_1$æ­£åˆ™&lt;/h1&gt;

&lt;p&gt;å‡è®¾å‚æ•°$\theta \sim Laplace(\mu,b),\mu=0$ï¼Œåˆ™ï¼š$P(\theta)=\frac{1}{2b}exp(-\frac{\vert\theta\vert}{b})$&lt;/p&gt;

\[\begin{aligned} \log P(\theta)&amp;amp;=\log(\frac{1}{2b}exp(-\frac{\vert\theta\vert}{b})) \\&amp;amp;=log(\frac{1}{2b})-\frac{\vert\theta\vert}{b}\end{aligned}\]

&lt;p&gt;MAPçš„ç›®æ ‡å‡½æ•°å¯å†™ä½œï¼š&lt;/p&gt;

\[\begin{aligned} objective\ of\ MAP &amp;amp;=\arg\max \sum_\limits{i=1}^n \log P(y_i\mid x_i;\theta)  -\frac{1}{b}\Vert\theta\Vert_1  \end{aligned}\]

&lt;p&gt;å³ï¼šå½“å‚æ•°æœä»æ‹‰æ™®æ‹‰æ–¯åˆ†å¸ƒæ—¶ï¼ŒMAPç›®æ ‡å‡½æ•°ä¸­çš„$\log P(\theta	)$é¡¹ç›¸å½“äºå¯¹MLEç›®æ ‡å‡½æ•°æ–½åŠ çš„$L_1$æ­£åˆ™ã€‚&lt;/p&gt;

&lt;p&gt;ä¸Šè¿°æ¨å¯¼ä»¥LRä¸ºä¾‹éªŒè¯äº†â€œAdding Priori is Equivalent to Regularizationâ€çš„ç»“è®ºï¼Œäº‹å®ä¸Šï¼Œåœ¨MLEçš„æ¡†æ¶ä¸‹ï¼Œä¸Šè¿°ç»“è®ºå¯æ¨å¹¿è‡³ä»»ä½•æ¨¡å‹ã€‚&lt;/p&gt;

&lt;h1 id=&quot;map-approaches-to-mle-solution&quot;&gt;MAP approaches to MLE solution&lt;/h1&gt;

&lt;p&gt;å›é¡¾MAPçš„ç›®æ ‡å‡½æ•°ï¼š&lt;/p&gt;

\[\begin{aligned} objective\ of\ MAP =\arg\max \sum_\limits{i=1}^n \log P(y_i\mid x_i;\theta) + \log P(\theta)  \end{aligned}\]

&lt;p&gt;ç›®æ ‡å‡½æ•°çš„ç¬¬ä¸€éƒ¨åˆ†æ˜¯ä¸€ä¸ªæ¦‚ç‡åŠ é¡¹ï¼Œç¬¬äºŒé¡¹ä»…ä¸æ¨¡å‹çš„å‚æ•°æœ‰å…³ï¼Œå½“æ ·æœ¬æ•°é‡è¶‹äºæ— é™å¤§ï¼Œå³$n \to \infty$æ—¶ï¼Œæ­£åˆ™åŒ–é¡¹çš„å½±å“å‡å¼±è‡³æ— ï¼Œæ­¤æ—¶MAPé€€åŒ–ä¸ºMLEã€‚&lt;/p&gt;

&lt;h1 id=&quot;ref&quot;&gt;Ref.&lt;/h1&gt;

&lt;p&gt;&lt;a href=&quot;http://www.cs.cmu.edu/~aarti/Class/10701_Spring14/slides/MLE_MAP_Part1.pdf&quot;&gt;1. CMU-10701:2. MLE, MAP, Bayes classification&lt;/a&gt;&lt;/p&gt;

</description>
        <pubDate>Sun, 16 Aug 2020 17:35:03 +0800</pubDate>
        <link>http://localhost:4000//2020/08/MAP&MLE</link>
        <guid isPermaLink="true">http://localhost:4000//2020/08/MAP&MLE</guid>
        
        <category>Machine Learning</category>
        
        
        <category>NLP</category>
        
      </item>
    
      <item>
        <title>Derivation of EM</title>
        <description>&lt;p&gt;éšå˜é‡æ¨¡å‹ï¼ˆLatent Variable Modelsï¼‰æŒ‡æ¨¡å‹ä¸­åŒ…å«ä¸å¯è§‚æµ‹çš„éšå«å˜é‡$z$ï¼Œéšå˜é‡æ¨¡å‹çš„æ±‚è§£æ ¹æ®$z$çš„å·²çŸ¥ä¸å¦åˆ†ä¸ºä¸¤ç±»ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;complete case&lt;/li&gt;
  &lt;li&gt;incomplete case&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;complete caseæ˜¯æŒ‡æ±‚è§£è¿‡ç¨‹ä¸­ï¼Œ$(x,z)$å‡å·²çŸ¥ï¼Œæ­¤ç±»æ¨¡å‹æ±‚è§£å¯ä»¥ä½¿ç”¨MLEç­‰æ–¹æ³•è¿›è¡Œæ±‚è§£ï¼›incomplete caseä¸­ï¼Œéšå˜é‡$z$æ˜¯æœªçŸ¥çš„ï¼Œæ±‚è§£è¯¥ç±»æ¨¡å‹éœ€è¦ä½¿ç”¨EMç®—æ³•ã€‚&lt;/p&gt;

&lt;p&gt;ä¸‹æ–‡å¯¹EMç®—æ³•è¿›è¡Œç®€å•çš„æ¨å¯¼ï¼Œå‡è®¾å› å˜é‡æ¨¡å‹ç›¸å…³çš„å‚æ•°å’Œå˜é‡åˆ†åˆ«ä¸ºï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;$\theta$ï¼šmodel parameters&lt;/li&gt;
  &lt;li&gt;$x$ï¼šobserved variable&lt;/li&gt;
  &lt;li&gt;$z$ï¼šlatent variable&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Objective: $L(\theta)= \ln p(x\mid \theta)$ï¼Œä¼˜åŒ–ç›®æ ‡ä¸ºï¼š$\arg \max L(\theta)=\arg \max \ln p(x\mid\theta)$&lt;/p&gt;

&lt;p&gt;è®°EMç®—æ³•ç»è¿‡$n$è½®è¿­ä»£åçš„å‚æ•°ä¸º$\theta_n$ï¼Œç›®æ ‡å‡½æ•°ä¹Ÿå¯ä»¥å†™æˆå¦‚ä¸‹çš„å½¢å¼ï¼Œå³åœ¨ç¬¬$n$æ¬¡è¿­ä»£çš„åŸºç¡€ä¸Šï¼Œæœ€å¤§åŒ–å½“å‰çš„ç›®æ ‡å‡½æ•°å’Œç¬¬$n$è½®ç›®æ ‡å‡½æ•°çš„å·®å€¼ï¼š&lt;/p&gt;

\[\begin{aligned} \arg \max _{\theta} L(\theta)-L\left(\theta_{n}\right) &amp;amp;=\ln p(x \mid \theta) -\ln p\left(x \mid \theta_{n}\right) \\ &amp;amp;=\ln \sum_{z} p(x, z \mid \theta)-\ln p\left(x \mid \theta_{n}\right) \\ &amp;amp;=\ln \sum_{z} p(x \mid z, \theta) \cdot p(z \mid \theta)-\ln p\left(x \mid \theta_{n}\right) \\ &amp;amp;=\ln \sum_{z} p\left(x \mid z, \theta\right) \cdot p(z \mid \theta) \cdot \frac{p\left(z \mid x, \theta_{n}\right)}{p\left(z \mid x, \theta_{n}\right)}-\ln p\left(x \mid \theta_{n}\right) \\ &amp;amp;=\ln \sum_{z} p\left(z \mid x, \theta_{n}\right) \cdot \frac{p(x \mid z, \theta) \cdot p(z \mid \theta)}{p\left(z \mid x, \theta_{n}\right)}-\ln p\left(x \mid \theta_{n}\right) \end{aligned}\]

&lt;p&gt;$\log\sum$é¡¹åœ¨æ±‚æ¢¯åº¦è¿‡ç¨‹ä¸­ä¸æ–¹ä¾¿è®¡ç®—ï¼Œè¿™é‡Œå¼•å…¥Jensenä¸ç­‰å¼ï¼š$\ln\sum_\limits{i=1}^{n}\lambda_i x_i \geqslant \sum_\limits{i=1}^{n}\lambda_i\ln x_i \quad s.t. \sum_\limits{i=1}^{n}\lambda_i=1$&lt;/p&gt;

&lt;p&gt;ç”±äº$\sum_\limits{z} p(z\mid x,\theta_n)=1$ï¼Œå¯å°†è¯¥é¡¹è§†ä¸ºJensenä¸ç­‰å¼ä¸­çš„$\lambda$ï¼Œå› æ­¤æœ‰ï¼š&lt;/p&gt;

&lt;p&gt;$\arg\max L(\theta)-L(\theta_n) \geqslant \sum_{z} p\left(z \mid x, \theta_{n}\right) \ln \frac{p\left(x \mid z, \theta\right) \cdot p(z \mid \theta)}{p\left(z \mid x, \theta_{n}\right)}-\ln p\left(x \mid \theta_{n}\right)$&lt;/p&gt;

&lt;p&gt;è‡³æ­¤ï¼Œå¾—åˆ°ï¼š&lt;/p&gt;

\[\begin{aligned} L(\theta)-L(\theta_n) &amp;amp; \geqslant \sum_{z} p\left(z \mid x, \theta_{n}\right) \ln \frac{p\left(x \mid z, \theta\right) \cdot p(z \mid \theta)}{p\left(z \mid x, \theta_{n}\right)}-\ln p\left(x \mid \theta_{n}\right) \\ &amp;amp;=\sum_{z} p\left(z \mid x, \theta_{n}\right) \ln \frac{p(x\mid z,\theta) \cdot p(z\mid \theta)}{p(x\mid x,\theta_n) \cdot p(x\mid \theta_n)} \\&amp;amp;=\Delta(\theta\mid\theta_n) \end{aligned}\]

&lt;p&gt;å³ï¼š$L(\theta)\geqslant L(\theta_n) +\Delta(\theta\mid\theta_n)$ï¼Œæ­¤æ—¶æœ€å¤§åŒ–$L(\theta)$ç­‰ä»·äºæœ€å¤§åŒ–$L(\theta)$çš„ä¸‹ç•Œï¼Œå› æ­¤ï¼Œä¸‹ä¸€è½®è¿­ä»£çš„æœ€ä¼˜$\theta_{n+1}$å¯ä»¥è¡¨ç¤ºä¸ºï¼š&lt;/p&gt;

\[\begin{aligned} \theta_{n+1} &amp;amp;=a r g \max _{\theta} L\left(\theta_{n}\right)+\Delta\left(\theta \mid \theta_{n}\right) \\ &amp;amp;=\arg \max _{\theta} \Delta\left(\theta \mid \theta_{n}\right) \\ &amp;amp;=\arg \max _{\theta} \sum_{z} p\left(z \mid x, \theta_{n}\right) \ln p(x \mid z, \theta) \cdot p(z \mid \theta) \\ &amp;amp;=\arg \max _{\theta} \sum_{z} p\left(z \mid x, \theta_{n}\right) \ln p(x, z \mid \theta) \\ &amp;amp;=\arg \max _{\theta} E_{z \mid x, \theta_{n}} p(x, z \mid \theta)\end{aligned}\]

&lt;p&gt;å…¶ä¸­ï¼Œ$E_{z \mid x, \theta_{n}} p(x, z \mid \theta)$ä¸º$(z\mid x,\theta,n)$çš„æœŸæœ›ï¼Œç”±äºè¯¥é¡¹ä¸­åŒ…å«äº†ä¸¤ä¸ªæœªçŸ¥å˜é‡$\theta,z$ï¼Œæœ€å¤§åŒ–è¿‡ç¨‹åˆ†ä¸ºä¸¤æ­¥è¿›è¡Œï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;E-stepï¼šæ ¹æ®å½“å‰çš„$\theta$è®¡ç®—å‡º$z$çš„æœŸæœ›ï¼ˆåœ¨åŒ…å«ä¸¤ä¸ªå¾…æ±‚è§£å˜é‡æ—¶ï¼ŒE-stepå›ºå®šå…¶ä¸­çš„$\theta$æ¥ç‹¬ç«‹æ±‚è§£$z$ï¼Œå› æ­¤EMç®—æ³•ä¸­çš„E-stepå¯ä»¥çœ‹ä½œæ˜¯coordinate decentçš„ä¸€ç§ç‰¹ä¾‹ã€‚ï¼‰&lt;/li&gt;
  &lt;li&gt;M-stepï¼š$maximize \ln p(x,z\mid \theta)$ï¼ˆå¯ä»¥è®¤ä¸ºæ­¤æ—¶çš„$z$æ˜¯å·²çŸ¥çš„ï¼Œè¿™ç§comlelte-caseå¯ä»¥ç›´æ¥ä½¿ç”¨MLEç­‰ä¼˜åŒ–æ–¹æ³•æ±‚è§£ã€‚ï¼‰&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è¿­ä»£æ‰§è¡Œä¸Šè¿°ä¸¤æ­¥ï¼Œç›´è‡³æ”¶æ•›ï¼Œä¾¿å¯ä»¥å¾—åˆ°æœ€ç»ˆéœ€è¦æ±‚è§£çš„å‚æ•°$\theta$ã€‚&lt;/p&gt;
</description>
        <pubDate>Mon, 10 Aug 2020 01:16:03 +0800</pubDate>
        <link>http://localhost:4000//2020/08/Derivation-of-EM</link>
        <guid isPermaLink="true">http://localhost:4000//2020/08/Derivation-of-EM</guid>
        
        <category>Machine Learning</category>
        
        
        <category>NLP</category>
        
      </item>
    
      <item>
        <title>æ­£åˆ™åŒ–</title>
        <description>&lt;p&gt;åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œæ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹å³æ˜¯åœ¨å¯»æ‰¾ä¸€ä¸ª&lt;strong&gt;è¶³å¤Ÿå¥½&lt;/strong&gt;çš„å‡½æ•°$F^{\star}$ï¼Œä½¿å¾—$F^{\star}$åœ¨è®­ç»ƒæ•°æ®å’Œæœªæ¥çš„æ–°æ•°æ®ä¸Šéƒ½å…·æœ‰è‰¯å¥½çš„æ¨ç†æ•ˆæœã€‚ä¸ºäº†ä»å€™é€‰å‡½æ•°ç©ºé—´${F}$é€‰æ‹©â€œå¥½â€çš„æ¨¡å‹ï¼Œäººä»¬å¼•å…¥æŸå¤±å‡½æ•°çš„æ¦‚å¿µã€‚ä¸€èˆ¬åœ°ï¼Œå¯¹äºæ ·æœ¬$(x, y)$å’Œæ¨¡å‹$F$ï¼Œå‡è®¾æ¨¡å‹å¯¹æ ·æœ¬çš„é¢„æµ‹å€¼ä¸º$\hat{y}$ï¼Œåˆ™æŸå¤±å‡½æ•°è¢«å®šä¹‰åœ¨$\mathbb{R}$çš„å‡½æ•°$l(y, \hat{y})$ï¼Œç”¨äºæè¿°é¢„æµ‹å€¼å’ŒçœŸå€¼çš„å·®è·ã€‚&lt;/p&gt;

&lt;p&gt;ä¸€èˆ¬åœ°ï¼ŒæŸå¤±å‡½æ•°æ˜¯ä¸€ä¸ªæœ‰ä¸‹ç¡®ç•Œçš„å‡½æ•°ï¼Œè¿™æ ·ï¼Œæœºå™¨å­¦ä¹ çš„ä¼˜åŒ–è¿‡ç¨‹å³è½¬åŒ–ä¸ºäº†åœ¨æ•°æ®é›†ä¸Šçš„æŸå¤±å‡½æ•°æœ€å°åŒ–é—®é¢˜ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼ŒæŸå¤±å‡½æ•°ä»…è€ƒè™‘äº†åœ¨è®­ç»ƒæ•°æ®ä¸Šçš„ç»éªŒé£é™©ï¼Œä»…è€ƒè™‘ç»éªŒé£é™©ï¼Œå¾ˆæœ‰å¯èƒ½å¯¼è‡´å‚æ•°ç©ºé—´è¿‡äºå¤æ‚ï¼Œé€ æˆæ¨¡å‹å¯¹è®­ç»ƒæ•°æ®è¿‡æ‹Ÿåˆã€‚&lt;/p&gt;

&lt;h2 id=&quot;æ¨¡å‹å¤æ‚åº¦&quot;&gt;æ¨¡å‹å¤æ‚åº¦&lt;/h2&gt;

&lt;p&gt;è¿‡æ‹Ÿåˆç°è±¡ã€æ³›åŒ–èƒ½åŠ›å’Œæ¨¡å‹å¤æ‚åº¦ä¸‰è€…ä¹‹é—´è”ç³»ç´§å¯†ï¼Œæ¨¡å‹å¤æ‚åº¦å–å†³äºï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;æ¨¡å‹æœ¬èº«çš„é€‰æ‹©&lt;/li&gt;
  &lt;li&gt;æ¨¡å‹å‚æ•°ä¸ªæ•°&lt;/li&gt;
  &lt;li&gt;æ¨¡å‹çš„å‚æ•°ç©ºé—´é€‰æ‹©ï¼ˆå½“æ¨¡å‹å’Œå‚æ•°ä¸ªæ•°éƒ½ç¡®å®šæ—¶ï¼Œä»å¯ä»¥ä½¿ç”¨ä¸€äº›æ‰‹æ®µï¼ˆå¦‚æ­£åˆ™åŒ–ï¼‰ï¼Œä»å‚æ•°ç©ºé—´ä¸­é€‰æ‹©è¾ƒä¼˜çš„å‚æ•°ï¼‰&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å½“æ¨¡å‹çš„å¤æ‚ç¨‹åº¦ç›¸å¯¹è®­ç»ƒæ•°æ®é‡è¿‡é«˜æ—¶ï¼Œå°±ä¼šå‘ç”Ÿè¿‡æ‹Ÿåˆç°è±¡ï¼Œå‡è½»è¿‡æ‹Ÿåˆç°è±¡çš„æªæ–½æœ‰ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ä½¿ç”¨æ›´ç®€å•çš„æ¨¡å‹&lt;/li&gt;
  &lt;li&gt;å‡å°‘å‚æ•°&lt;/li&gt;
  &lt;li&gt;åœ¨æœç´¢å‚æ•°ç©ºé—´æ—¶åŠ å…¥é™åˆ¶ï¼ˆå¦‚å¯¹å‚æ•°å¢åŠ æ­£åˆ™åŒ–ï¼‰&lt;/li&gt;
  &lt;li&gt;è·å–æ›´å¤šçš„æ ·æœ¬&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æœ¬æ–‡ä»…è®¨è®ºä½¿ç”¨æ­£åˆ™åŒ–æ‰‹æ®µå‡è½»è¿‡æ‹Ÿåˆçš„å½±å“ã€‚&lt;/p&gt;

&lt;h2 id=&quot;å¼•å…¥æ­£åˆ™åŒ–&quot;&gt;å¼•å…¥æ­£åˆ™åŒ–&lt;/h2&gt;

&lt;p&gt;ä¸ºäº†å‡è½»æ¨¡å‹çš„è¿‡æ‹Ÿåˆè¶‹åŠ¿ï¼Œæˆ‘ä»¬éœ€è¦å¯¹æŸå¤±å‡½æ•°ä¸­åŠ å…¥æè¿°æ¨¡å‹å¤æ‚ç¨‹åº¦çš„æ­£åˆ™é¡¹$\Omega(F)$ï¼Œä¼˜åŒ–è¿‡ç¨‹è½¬åŒ–ä¸ºï¼š&lt;/p&gt;

\[F^\star:=\mathop{\arg\min}_\limits{\theta} Obj(F)=\mathop{\arg\min}_\limits{\theta}(L(F)+\gamma\Omega(F)),\gamma&amp;gt;0\]

&lt;p&gt;ç›®æ ‡å‡½æ•°$Obj(\cdot)$æè¿°æ¨¡å‹çš„ç»“æ„é£é™©ï¼Œå…¶ä¸­$L(F)$è¡¨ç¤ºæ¨¡å‹åœ¨è®­ç»ƒæ•°æ®ä¸Šçš„æŸå¤±ï¼Œ$\Omega(F)$ä¸ºæ­£åˆ™åŒ–é¡¹ï¼Œ$\gamma$ç”¨äºæ§åˆ¶æ­£åˆ™åŒ–é¡¹çš„å¼ºåº¦ï¼Œä¸€èˆ¬ä½¿ç”¨$L_p$èŒƒæ•°ä½œä¸ºæ­£åˆ™é¡¹ï¼Œç”¨äºå¯¹å‚æ•°å…‰æ»‘åº¦å’Œå‚æ•°ç©ºé—´èŒƒæ•°ä¸Šç•Œè¿›è¡Œé™åˆ¶ï¼Œæå‡æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚&lt;/p&gt;

&lt;p&gt;å¸¸è§çš„ç”¨äºæ­£åˆ™åŒ–çš„$L_p$èŒƒæ•°æœ‰ä»¥ä¸‹å‡ ç§ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;$L_0: \Vert W \Vert_0=\sum\limits^{d}_{i=1}I(w_i\neq 0)$&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;$L_1: \Vert W \Vert_1=\sum\limits^{d}_{i=1}\vert w_i \vert$&lt;/li&gt;
  &lt;li&gt;$L_2: \Vert W \Vert_2=\sum\limits^{d}_{i=1} w_i^2$&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å¸¸ç”¨$L_1$å’Œ$L_2$æ­£åˆ™åŒ–æ¥é™åˆ¶æ¨¡å‹çš„å¤æ‚åº¦ã€‚&lt;/p&gt;

&lt;h2 id=&quot;l_1å’Œl_2æ­£åˆ™åŒ–&quot;&gt;$L_1$å’Œ$L_2$æ­£åˆ™åŒ–&lt;/h2&gt;

&lt;p&gt;ä»æ¦‚ç‡è§’åº¦è€ƒè™‘ï¼Œå¯¹æ¨¡å‹å‚æ•°æ–½åŠ çš„æ­£åˆ™åŒ–é¡¹å…¶å®å°±æ˜¯å¼•å…¥äº†å‚æ•°çš„å…ˆéªŒï¼Œ$L_1$æ­£åˆ™åŒ–å¯¹åº”Laplaceå…ˆéªŒï¼Œ$L_2$æ­£åˆ™å¯¹åº”é«˜æ–¯å…ˆéªŒã€‚è¿™ä¸¤ç§æ­£åˆ™åŒ–éƒ½å¯ä»¥ä½¿å‚æ•°å˜â€œå°â€ã€‚ä¸åŒä¹‹å¤„åœ¨äºï¼Œ$L_1$æ­£åˆ™åŒ–å¯ä»¥ä½¿å¾—å‚æ•°ç¨€ç–åŒ–ï¼Œå¯ä»¥ç”¨äºç‰¹å¾é€‰æ‹©ï¼›$L_2$æ­£åˆ™åŒ–å¯ä»¥ä½¿å¾—å‚æ•°å°ºåº¦å—åˆ°çº¦æŸï¼Œå‡è½»è¿‡æ‹Ÿåˆç°è±¡ã€‚æˆ‘ä»¬å¯ä»¥æ ¹æ®åœºæ™¯é€‰æ‹©åˆé€‚çš„æ­£åˆ™åŒ–é¡¹ï¼Œç”šè‡³å¯ä»¥åŒæ—¶ä½¿ç”¨äºŒè€…ï¼Œå¦‚stanfordæå‡ºçš„ElasticNetå°±åŒæ—¶åœ¨æ¨¡å‹ä¸­ä½¿ç”¨äº†$L_1$å’Œ$L_2$æ­£åˆ™åŒ–ï¼Œå‚è€ƒè¿™ç¯‡1.2wæ¬¡å¼•ç”¨çš„&lt;a href=&quot;https://web.stanford.edu/~hastie/TALKS/enet_talk.pdf&quot;&gt;slide&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;h2 id=&quot;l_2æ­£åˆ™åŒ–èƒ½å¤Ÿé€šè¿‡å‡å°å‚æ•°å°ºåº¦æ¥å‡å¼±æ¨¡å‹è¿‡æ‹Ÿåˆç°è±¡çš„åŸå› &quot;&gt;$L_2$æ­£åˆ™åŒ–èƒ½å¤Ÿé€šè¿‡å‡å°å‚æ•°å°ºåº¦æ¥å‡å¼±æ¨¡å‹è¿‡æ‹Ÿåˆç°è±¡çš„åŸå› &lt;/h2&gt;

&lt;p&gt;å¦‚æœå‚æ•°å°ºåº¦å¾ˆå¤§ï¼Œåˆ™å¯¹è¾“å…¥æ–½åŠ ä¸€ä¸ªå¾®å°çš„æ‰°åŠ¨å°±ä¼šå¼•èµ·ç›®æ ‡å‡½æ•°å‘ç”Ÿè¾ƒå¤§å¹…åº¦çš„å˜åŒ–ï¼Œä¹Ÿå³æ¨¡å‹å¯¹è¾“å…¥å™ªå£°çš„é²æ£’æ€§å˜å·®ï¼Œè¿‡æ‹Ÿåˆé£é™©å¢åŠ ã€‚&lt;/p&gt;

&lt;h2 id=&quot;l_1èƒ½å¤Ÿä½¿æ¨¡å‹å‚æ•°å˜å¾—ç¨€ç–çš„åŸå› &quot;&gt;$L_1$èƒ½å¤Ÿä½¿æ¨¡å‹å‚æ•°å˜å¾—ç¨€ç–çš„åŸå› &lt;/h2&gt;

&lt;p&gt;ä¸‹é¢ä»¥çº¿æ€§å›å½’ä¸ºä¾‹ï¼Œç®€å•åˆ†æ$L_1$æ­£åˆ™åŒ–ä¼šäº§ç”Ÿç¨€ç–è§£çš„åŸå› ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨çº¿æ€§å›å½’ä¸­ï¼Œå¦‚æœåŠ å…¥$L_2$æ­£åˆ™ï¼Œåˆ™ä¸€èˆ¬ç§°ä¸ºå²­å›å½’ï¼ˆRidge regressionï¼‰ï¼›å¦‚æœåŠ å…¥$L_1$æ­£åˆ™ï¼Œåˆ™ä¸€èˆ¬ç§°ä¸ºLassoå›å½’ã€‚å› æ­¤ï¼Œ$L_1$æ­£åˆ™æœ‰æ—¶å€™ä¹Ÿè¢«ç§°ä¸ºLassoæ­£åˆ™ã€‚&lt;/p&gt;

&lt;p&gt;Lassoå›å½’çš„ç›®æ ‡å‡½æ•°ä¸ºï¼š&lt;/p&gt;

\[L=\Vert XW-Y \Vert_F^2 + \lambda\Vert W \Vert_1\]

&lt;p&gt;ç”±äº$ \Vert W \Vert_1=\sum\limits^{d}_{i=1}\vert w_i \vert$æ˜¯ä¸€ä¸ªåŒ…å«å±€éƒ¨ä¸å¯å¯¼ç‚¹çš„å‡½æ•°ï¼Œå› æ­¤ï¼Œåœ¨ä¼˜åŒ–è¿‡ç¨‹ä¸­ï¼Œä¸èƒ½ä½¿ç”¨å¸¸è§„çš„ä¼˜åŒ–ç®—æ³•ï¼ˆå¦‚æ¢¯åº¦ä¸‹é™æ³•ï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;æœ‰å¾ˆå¤šç‰¹æ®Šçš„ä¼˜åŒ–ç®—æ³•å¯ä»¥è§£å†³è¿™ä¸€ç±»ä¼˜åŒ–é—®é¢˜ï¼Œå¦‚LARSã€Parallel CDã€ADMMã€Coordinate Descentç­‰ã€‚Coordinate descentå±äºSub-gradient descentèŒƒç•´ï¼Œä»¥ä¸‹ä»‹ç»ä½¿ç”¨å…¶è¿›è¡Œå‚æ•°æ±‚è§£ã€‚Coordinate descentçš„è¿è¡Œæµç¨‹å¯ä»¥ç®€åŒ–ä¸ºï¼š&lt;/p&gt;

&lt;p&gt;å¾ªç¯æ‰§è¡Œä»¥ä¸‹ç›´è‡³æ”¶æ•›ï¼š&lt;/p&gt;

&lt;p&gt;â€‹        é€‰æ‹©ä¸€ä¸ªå‚æ•°ç»´åº¦$i$&lt;/p&gt;

&lt;p&gt;â€‹        å›ºå®šå…¶ä½™ç»´åº¦çš„å‚æ•°&lt;/p&gt;

&lt;p&gt;â€‹        åœ¨ç¬¬$i$ç»´åº¦ä¸Šæ‰§è¡Œå‚æ•°æ›´æ–°ï¼š$w_i\leftarrow w_i-\frac{\partial L}{\partial w_i}(W)$&lt;/p&gt;

\[Obj:L=\sum_\limits{i=1}^{n}\left(\sum_\limits{j=1}^{d} w_{j} x_{ij}+b-y_{i}\right)^{2}+\sum_\limits{j=1}^{d}\vert w_{j} \vert\]

\[\begin{aligned} \frac{\partial L}{\partial w_{l}} &amp;amp;=2 \sum_{i=1}^{n}\left(\sum_{j=1}^{d} w_{j} x_{i j}+b-y_{i}\right) \cdot x_{i l}+\frac{\partial\left|w_{l}\right|}{\partial w_{l}} \\ &amp;amp;=2 \sum_{i=1}^{n}\left(\sum_{j=1 \atop j\neq l}^{d} w_{j} x_{i j}+b-y_{i}+w_{l} x_{i l}\right) \cdot x_{i l}+\frac{\partial \vert w_{l}\vert}{\partial w_{l}} \\ &amp;amp;=2 \sum_{i=1}^{n}\left(\sum_{j=1 \atop j \neq l}^{d} w_{j} x_{i j}+b-y_{i}\right) \cdot x_{i l}+2 \sum_{i=1}^{n} w_{l} x_{il}^{2}+\frac{\partial \vert w_{l} \vert }{\partial w_{l}} \\ &amp;amp;=2 \sum_{i=1}^{n}\left(\sum_{j=1 \atop j \neq l}^{d} w_{j} x_{i j}+b-y_{i}\right) \cdot x_{i l}+2 w_{l} \sum_{i=1}^{n} x_{i l}^{2}+\frac{\partial \vert w_{l} \vert}{\partial w_{l}}\end{aligned}\]

&lt;p&gt;è®¾å¸¸æ•°$2 \sum_\limits{i=1}^{n}\left(\sum_\limits{j=1 \atop j \neq l}^{d} w_{j} x_{i j}+b-y_{i}\right) \cdot x_{i l}$ä¸º$C_L$ï¼›è®¾$2\sum_\limits{i=1}^{n} x_{i l}^{2}$ä¸º$a_L$ï¼Œï¼ˆ$a_L \gt 0$ï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;åˆ™$\frac{\partial L}{\partial w_{l}}=C_{L}+w_{L} a_{l}+\lambda \cdot \frac{\partial \vert W_{l} \vert}{\partial l}$ï¼Œåˆ†æƒ…å†µè®¨è®ºï¼š&lt;/p&gt;

\[\frac{\partial L}{\partial w_{l}}=\left\{\begin{array} \\C_{L}+a_Lw_l+\lambda&amp;amp;,w_l&amp;gt;0   \\ [C_L-\lambda,C_L+\lambda]&amp;amp;,w_l=0 &amp;amp;\\ C_L+a_Lw_l-\lambda&amp;amp;,w_l&amp;gt;0                  \end{array}   \right.\]

&lt;p&gt;ä»¤$\frac{\partial L}{\partial w_{l}}=0$ï¼Œå¯å¾—ï¼š&lt;/p&gt;

\[\hat{w_l}=\left\{ \begin{array}\\ -C_L-\lambda &amp;amp;,if\ C_L\lt -\lambda\\ 0 &amp;amp;,if\ -\lambda \le C_L \le \lambda \\ \lambda-C_L &amp;amp;,if\ C_L\gt \lambda\end{array}\right.\]

&lt;p&gt;ç”±æ­¤å¯è§ï¼Œåœ¨æ›´æ–°ç¬¬$l$ç»´çš„æƒé‡æ—¶ï¼Œå½“$-\lambda \le C_L \le \lambda$æ—¶ï¼Œæƒé‡ä¼šè¢«å¼ºåˆ¶ç½®ä¸º0ï¼Œå¤„äºæ­¤èŒƒå›´çš„$C_L$å¯¼è‡´äº†å‚æ•°çš„ç¨€ç–åŒ–ã€‚&lt;/p&gt;

&lt;h2 id=&quot;æ­£åˆ™åŒ–åšäº†ä»€ä¹ˆ&quot;&gt;æ­£åˆ™åŒ–åšäº†ä»€ä¹ˆ&lt;/h2&gt;

&lt;p&gt;åœ¨å‚æ•°ä¼˜åŒ–è¿‡ç¨‹ä¸­åŠ å…¥æ­£åˆ™åŒ–ï¼Œå®é™…ä¸Šæ˜¯åœ¨ä¸€ä¸ªç¡®å®šçš„å‚æ•°ç©ºé—´ä¸­ï¼Œå¯¹å‚æ•°çš„å¯è¡Œç©ºé—´ï¼ˆfeasible regionï¼‰ä½œäº†è¿›ä¸€æ­¥çº¦æŸï¼Œå› æ­¤ï¼Œå‡è®¾$L$ä¸ºæ¨¡å‹åœ¨è®­ç»ƒæ ·æœ¬ä¸Šçš„æŸå¤±å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“è®ºï¼š&lt;/p&gt;

\[L(\hat{w}_{without\ reg}) \leq L(\hat{w}_{with\ reg})\]

&lt;p&gt;å³ï¼ŒåŠ å…¥æ­£åˆ™åŒ–åçš„å‚æ•°åœ¨è®­ç»ƒæ•°æ®ä¸Šçš„æŸå¤±ï¼Œä¸€å®šä¸å°äºæ— æ­£åˆ™åŒ–æ—¶çš„ã€‚&lt;/p&gt;

&lt;h2 id=&quot;æ­£åˆ™åŒ–çš„çµæ´»è¿ç”¨&quot;&gt;æ­£åˆ™åŒ–çš„çµæ´»è¿ç”¨&lt;/h2&gt;

&lt;p&gt;ä»¥ç®€åŒ–çš„å¤§è„‘ç¥ç»å…ƒæ¨¡å‹ä¸ºä¾‹ï¼Œå‡è®¾å¤§è„‘åˆ†ä¸ºè‹¥å¹²ä¸ªåŒºåŸŸï¼ˆregionï¼‰ï¼Œæ¯ä¸ªåŒºåŸŸå‡åŒ…å«ä¸€äº›ç¥ç»å…ƒï¼Œæ¯ä¸ªç¥ç»å…ƒå‡å…·æœ‰å¯¹åº”çš„å‚æ•°ï¼Œ$w_{ir_j}$è¡¨ç¤ºå¤§è„‘ç¬¬$i$ä¸ªç¥ç»å…ƒåŒºåŸŸçš„ç¬¬$j$ä¸ªç¥ç»å…ƒçš„æƒé‡ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://shihanmax.top/20201013230655_vEOXrf_%E6%88%AA%E5%B1%8F2020-10-13%2023.06.38.jpeg&quot; alt=&quot;neu&quot; style=&quot;zoom:50%;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;è®¾ç›®æ ‡å‡½æ•°ä¸º$f(W)$ï¼Œæˆ‘ä»¬æœŸæœ›é€šè¿‡æ­£åˆ™åŒ–æ‰‹æ®µï¼Œå°†ä»¥ä¸‹ä¸¤ä¸ªå‡è®¾è€ƒè™‘è¿›æ¥ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;æŸä¸€ä¸ªåŒºåŸŸå†…ï¼Œä»…æœ‰å°‘é‡ç¥ç»å…ƒè¢«æ¿€æ´»&lt;/li&gt;
  &lt;li&gt;åœ¨ç©ºé—´ä¸Šç›¸è¿‘çš„ç¥ç»å…ƒï¼Œä½œç”¨ç±»ä¼¼&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;åˆ™æˆ‘ä»¬å¯ä»¥æ„é€ å¦‚ä¸‹ä¼˜åŒ–ç›®æ ‡ï¼š&lt;/p&gt;

\[\mathop{minimize}: f(W)+\sum\limits_{i=1}^R \lambda_i\Vert w
_{i \cdot}\Vert_1+\sum\limits_{i=1}^{R}\sum\limits_{j=1}^{r_i}\lambda_2\Vert w_{ij}-w_{ij-1}\Vert_2\]

&lt;p&gt;åœ¨ä¸Šå¼ä¸­ï¼Œ$R$è¡¨ç¤ºç¥ç»å…ƒåŒºåŸŸä¸ªæ•°ï¼Œ$r_k$è¡¨ç¤ºç¬¬$k$ä¸ªåŒºåŸŸä¸­åŒ…å«çš„ç¥ç»å…ƒä¸ªæ•°ï¼Œæˆ‘ä»¬å¼•å…¥äº†ä¸¤ä¸ªæ­£åˆ™åŒ–é¡¹ï¼Œç¬¬ä¸€ä¸ªç”¨äºç¥ç»å…ƒåŒºåŸŸå†…çš„ç¨€ç–åŒ–ï¼Œç¬¬äºŒä¸ªç”¨äºçº¦æŸç›¸è¿‘ç¥ç»å…ƒåŒºåŸŸçš„ç›¸ä¼¼ç¨‹åº¦ã€‚&lt;/p&gt;

&lt;h2 id=&quot;ref&quot;&gt;Ref&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://www.greedyai.com&quot;&gt;Wenzhe Li, Greedy AI&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://web.stanford.edu/~hastie/TALKS/enet_talk.pdf&quot;&gt;Elastic Net&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://zh.wikipedia.org/wiki/æ­£åˆ™åŒ–_(æ•°å­¦)&quot;&gt;wikipedia: æ­£åˆ™åŒ–&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Matrix_norm&quot;&gt;wikipedia: matrix norm&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.cs.cmu.edu/~ggordon/10725-F12/slides/25-coord-desc.pdf&quot;&gt;CMU: Coordinate Descent&lt;/a&gt;&lt;/p&gt;

</description>
        <pubDate>Wed, 05 Aug 2020 05:34:18 +0800</pubDate>
        <link>http://localhost:4000//2020/08/%E6%AD%A3%E5%88%99%E5%8C%96</link>
        <guid isPermaLink="true">http://localhost:4000//2020/08/%E6%AD%A3%E5%88%99%E5%8C%96</guid>
        
        <category>Machine Learning</category>
        
        
        <category>NLP</category>
        
      </item>
    
      <item>
        <title>åºåˆ—æ ‡æ³¨å®è·µ</title>
        <description>&lt;p&gt;åºåˆ—æ ‡æ³¨é—®é¢˜æ˜¯ä¸€ç±»å…¸å‹çš„NLPé—®é¢˜ï¼Œå…·ä½“åº”ç”¨æœ‰ï¼šåˆ†è¯ã€è¯æ€§æ ‡æ³¨ã€å‘½åå®ä½“è¯†åˆ«ç­‰ã€‚&lt;/p&gt;

&lt;p&gt;åºåˆ—æ ‡æ³¨é—®é¢˜çš„å®šä¹‰æ˜¯ï¼šç»™å®šåºåˆ—$S$ï¼ŒæœŸæœ›é€šè¿‡æ¨¡å‹Må¾—åˆ°åºåˆ—ä¸­æ¯ä¸€ä¸ªtokenå¯¹åº”çš„æ ‡ç­¾åºåˆ—$Z$ï¼Œè¿™é‡Œå®šä¹‰ï¼Œ$S$ä¸­æ¯ä¸ªè¯tokençš„å¯èƒ½æƒ…å†µæœ‰$n_{word}$ä¸­ï¼Œæ ‡ç­¾åºåˆ—$Z$ä¸­çš„æ¯ä¸€ä¸ªæ ‡ç­¾tagçš„å¯èƒ½æƒ…å†µæœ‰$n_{tag}$ç§ã€‚&lt;/p&gt;

&lt;p&gt;æœ¬æ–‡ä»å™ªå£°ä¿¡é“æ¨¡å‹çš„è§’åº¦å¯¹åºåˆ—æ ‡æ³¨é—®é¢˜è¿›è¡Œå»ºæ¨¡ï¼Œå¹¶é€šè¿‡ç»´ç‰¹æ¯”ç®—æ³•ä¼˜åŒ–æœ€ä¼˜è·¯å¾„çš„æœç´¢ã€‚&lt;/p&gt;

&lt;!--more--&gt;

&lt;p&gt;å®šä¹‰ï¼š$S=w_1w_2w_3â€¦w_{N}$ï¼Œå¯¹åº”çš„ä»»ä¸€ç§æ ‡ç­¾åºåˆ—ä¸º$Z=z_1z_2z_3â€¦z_{N}$ï¼Œç›®æ ‡æ˜¯å¯»æ‰¾æœ€ä¼˜çš„æ ‡ç­¾åºåˆ—$\hat{Z}$ã€‚&lt;/p&gt;

\[\begin{equation}\begin{aligned}  \hat{Z}&amp;amp;=\mathop{argmax}_\limits{z}(P(Z\vert S)) \\&amp;amp;=\mathop{argmax}_\limits{z}(P(S\vert Z)\cdot P(Z)) \\&amp;amp;=\mathop{argmax}_\limits{z}(P(w_1w_2...w_N\vert z_1z_2...z_N) \cdot  P(z_1z_2...z_N))   \end{aligned}  \end{equation}\]

&lt;p&gt;ä¸Šå¼ä¸­ä¹˜ç§¯çš„ç¬¬ä¸€é¡¹ä¸ºTranslation modelï¼ˆTMï¼‰ã€ç¬¬äºŒé¡¹ä¸ºLanguage modelï¼ˆLMï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨TMä¸­å¼•å…¥ç‹¬ç«‹å‡è®¾ï¼Œåœ¨LMä¸­å¼•å…¥bi-gramå‡è®¾ï¼Œå¯å¾—ï¼š&lt;/p&gt;

\[\hat{Z}=\mathop{argmax}_\limits{z}( \prod_\limits{i=1}^{N}P(w_i\vert z_i)\cdot P(z_1)\cdot \prod_\limits{j=2}^N P(z_j\vert z_{j-1}))\]

&lt;p&gt;å¯¹æ¦‚ç‡è¿›è¡Œå¯¹æ•°åŒ–ï¼š&lt;/p&gt;

\[\hat{Z}=\mathop{argmax}_\limits{z}( \sum_\limits{i=1}^{N} logP(w_i\vert z_i)+ log P(z_1)+ \sum_\limits{j=2}^N logP(z_j\vert z_{j-1}))\]

&lt;p&gt;ç›¸åŠ çš„ä¸‰é¡¹ä¸­ï¼Œç¬¬ä¸€é¡¹ä¸ºç”±æ ‡ç­¾åˆ°è¯çš„æ¡ä»¶æ¦‚ç‡ï¼Œè®°ä¸º$A$ï¼›ç¬¬äºŒé¡¹ä¸ºæ ‡ç­¾å‡ºç°åœ¨å¥é¦–çš„æ¦‚ç‡ï¼Œè®°ä¸º$B$ï¼Œç¬¬ä¸‰é¡¹ä¸ºæ ‡ç­¾ä¹‹é—´çš„è½¬ç§»æ¦‚ç‡ï¼Œè®°ä¸º$\pi$ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨æœ‰æ ‡æ³¨çš„æ•°æ®é›†ä¸Šï¼Œä¸Šè¿°ä¸‰é¡¹çš„æ¦‚ç‡èƒ½å¤Ÿé€šè¿‡ç»Ÿè®¡å¾—åˆ°ã€‚&lt;/p&gt;

&lt;p&gt;å¯¹äºä¸€æ¡å¾…æ ‡æ³¨çš„æ–‡æœ¬$S_u$ï¼Œé•¿åº¦ä¸º$N$ï¼Œå…¶æ‰€æœ‰å¯èƒ½çš„æ ‡ç­¾åºåˆ—æœ‰$n_{tag}^N$ç§ï¼Œå¯¹æ‰€æœ‰æƒ…å†µå¯ä»¥è®¡ç®—æ¦‚ç‡$P(Z_i\vert S)$ï¼Œå–æ¦‚ç‡æœ€å¤§çš„æ ‡ç­¾åºåˆ—å³å¯ã€‚&lt;/p&gt;

&lt;p&gt;å®é™…åº”ç”¨ä¸­ï¼Œæšä¸¾æ‰€æœ‰ç§å¯èƒ½çš„æ•ˆç‡æ˜¯éå¸¸ä½çš„ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨æ›´é«˜æ•ˆçš„ç®—æ³•æ¥å¯¹è·¯å¾„è¿›è¡Œå‰ªæã€‚ç»´ç‰¹æ¯”ç®—æ³•æ˜¯ä¸€ç§åŠ¨æ€è§„åˆ’ç®—æ³•ï¼Œç”¨äºå¤šä¸ªæ­¥éª¤ä¸”æ¯ä¸ªæ­¥éª¤ä¸­æœ‰å¤šç§é€‰æ‹©çš„é—®é¢˜çš„æœ€ä¼˜è·¯å¾„é€‰æ‹©ã€‚ç»´ç‰¹æ¯”ç®—æ³•é€šè¿‡è®¡ç®—æ‰€æœ‰å‰åºæ­¥éª¤åˆ°å½“å‰æ­¥éª¤çš„æœ€å°ä»£ä»·ï¼ˆæˆ–æœ€å¤§æ”¶ç›Šï¼‰ï¼Œä»¥åŠå½“å‰æ­¥éª¤åšé€‰æ‹©æ—¶çš„ä»£ä»·ï¼ˆæ”¶ç›Šï¼‰æ¥è¿›è¡Œæ­¥éª¤çš„é€‰æ‹©ï¼Œæœ€åï¼Œé€šè¿‡å›æº¯æ³•æ¥é€‰æ‹©æœ€ä¼˜è·¯å¾„ã€‚&lt;/p&gt;

&lt;p&gt;ä¸‹é¢æ˜¯ä¸Šè¿°è¿‡ç¨‹åœ¨è¯æ€§æ ‡æ³¨ä»»åŠ¡ä¸Šçš„ä¸€ç§å®ç°ã€‚&lt;/p&gt;

&lt;p&gt;è®­ç»ƒæ•°æ®çš„æ ¼å¼ä¸ºï¼šæ¯è¡Œï¼šè¯/è¯æ€§&lt;/p&gt;

&lt;p&gt;å®ç°ï¼š&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;build_mapper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;&quot;&quot; build token mapper and tag mapper &quot;&quot;&quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tag2id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;id2tag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;word2id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;id2word&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;word_count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tag_count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;line&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;readlines&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;sp_line&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sp_line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;tag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sp_line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;/&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sp_line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sp_line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;tag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sp_line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;word2id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;word2id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;word_count&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;id2word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word_count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;

                &lt;span class=&quot;n&quot;&gt;word_count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tag&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tag2id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;tag2id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tag_count&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;id2tag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tag_count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tag&lt;/span&gt;

                &lt;span class=&quot;n&quot;&gt;tag_count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;n_word&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word2id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;n_tag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tag2id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;word size:{}&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;tag size:{}&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_tag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;word2id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id2word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tag2id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id2tag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_tag&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;build_params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word2id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tag2id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_tag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;&quot;&quot;
    build params of HMM: theta = (pi, A, B)
    - pi is a vector marks the probe of each tag to be the first tag
      of a sentence, size: [1, n_tag]
    - A is a matrix of condition probe of words given tags,size: [n_tag, n_word]
    - B is a matrix of transition probe between tags, size: [n_tag, n_tag]&quot;&quot;&quot;&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_tag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# probe of starting tag
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_tag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# condition probe p(word|tag)
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_tag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_tag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# transition probe p(tag_i|tag_j)
&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;at_start_of_sentence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;last_tag_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;line&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;readlines&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;word_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;word2id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;tag_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tag2id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;at_start_of_sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tag_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# starting prob
&lt;/span&gt;                &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tag_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;word_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# cond. prob
&lt;/span&gt;                &lt;span class=&quot;n&quot;&gt;at_start_of_sentence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;

            &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tag_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;word_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# cond. prob
&lt;/span&gt;                &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;last_tag_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tag_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# trans. probe
&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;.&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;at_start_of_sentence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;last_tag_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;last_tag_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tag_id&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# done counting, normalize...
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_tag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1e-8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;viterbi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;word2id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id2tag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;&quot;&quot;
    decode with viterbi
    :param sentence: sentence to decode
    :param pi: init probe of tag
    :param a: cond probe of words given tags
    :param b: trans probe between tags
    :return:
    &quot;&quot;&quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word2id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()]&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# words of sentence
&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;n_tag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tag2id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;dp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_tag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;path_record&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_tag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_tag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)])&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_tag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;dp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# dp
&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# æ¯ä¸ªå•è¯
&lt;/span&gt;        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_tag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# æ¯ä¸ªè¯æ€§
&lt;/span&gt;            &lt;span class=&quot;n&quot;&gt;dp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1e6&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_tag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;score&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;score&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;dp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;score&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;path_record&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# find best sequence
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;best_tag_sequence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;best_tag_sequence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;best_tag_sequence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;path_record&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;best_tag_sequence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;tag_sequence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id2tag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;best_tag_sequence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tag_sequence&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;train_data_path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;./resource/traindata.txt&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test_sentence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;The big question is whether the president will have the strength .&quot;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# 1. build mapper of words and tags
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word2id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id2word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tag2id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id2tag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_tag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;build_mapper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_data_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# 2. \theta = (\pi, A, B), build them
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;build_params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word2id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tag2id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_tag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_data_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# 3. find optimal path with viterbi
&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tag_sequence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;viterbi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;word2id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id2tag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tag_sequence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# ['DT', 'JJ', 'NN', 'VBZ', 'IN', 'DT', 'NN', 'MD', 'VB', 'DT', 'NN', '.']
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

</description>
        <pubDate>Mon, 11 May 2020 01:16:03 +0800</pubDate>
        <link>http://localhost:4000//2020/05/%E5%BA%8F%E5%88%97%E6%A0%87%E6%B3%A8%E5%AE%9E%E8%B7%B5</link>
        <guid isPermaLink="true">http://localhost:4000//2020/05/%E5%BA%8F%E5%88%97%E6%A0%87%E6%B3%A8%E5%AE%9E%E8%B7%B5</guid>
        
        <category>Sequence Labeling</category>
        
        <category>Machine Learning</category>
        
        
        <category>NLP</category>
        
      </item>
    
  </channel>
</rss>
